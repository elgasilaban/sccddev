/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

//>>built
require({cache:{"dijit/form/nls/validate":function(){define({root:({invalidMessage:"The value entered is not valid.",missingMessage:"This value is required.",rangeMessage:"This value is out of range."}),"zh":true,"zh-tw":true,"tr":true,"th":true,"sv":true,"sl":true,"sk":true,"ru":true,"ro":true,"pt":true,"pt-pt":true,"pl":true,"nl":true,"nb":true,"ko":true,"kk":true,"ja":true,"it":true,"hu":true,"hr":true,"he":true,"fr":true,"fi":true,"es":true,"el":true,"de":true,"da":true,"cs":true,"ca":true,"az":true,"ar":true});},"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\"\n\t\tdata-dojo-attach-event=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n","ibm/tivoli/fwm/mxmap/routing/itinerary/Step":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/_Widget,dijit/_Templated,ibm/tivoli/fwm/mxmap/routing/Router"],function(_1,_2,_3){_2.provide("ibm.tivoli.fwm.mxmap.routing.itinerary.Step");_2.require("ibm.tivoli.fwm.mxmap._Base");_2.require("dijit._Widget");_2.require("dijit._Templated");_2.require("ibm.tivoli.fwm.mxmap.routing.Router");_2.declare("ibm.tivoli.fwm.mxmap.routing.itinerary.Step",[_1._Widget,_1._Templated,ibm.tivoli.fwm.mxmap._Base],{templateString:_2.cache("ibm.tivoli.fwm.mxmap","templates/Step.html","<div  style=\"width:100%;border-top:1px solid #F0F0F0;margin-bottom:3px;\" data-dojo-attach-event=\"ondijitclick:_onClick,onmouseenter:_onHover,onmouseleave:_onUnhover\" >\n\n<div  style=\"padding:10px;\">\n<span data-dojo-attach-point=\"stepInfoNode\"></span><div data-dojo-attach-point=\"distanceInfoNode\" style=\"float:right;\"></div></div>\n</div>"),distanceUnit:0,distance:0,constructor:function(_4){_2.mixin(this,_4);},postCreate:function(){this.stepInfoNode.innerHTML="<b>"+this.position+".  </b>"+this.info;this.distanceInfoNode.innerHTML=ibm.tivoli.fwm.mxmap.routing.DistanceUnit.formatDistance(this.distance,this.distanceUnit);},_onClick:function(_5){this.map.getMapstraction().setCenter(this.location);this.closeDialog();},_onHover:function(_6){},_onUnhover:function(_7){}});});},"dijit/_base/scroll":function(){define("dijit/_base/scroll",["dojo/window",".."],function(_8,_9){_9.scrollIntoView=function(_a,_b){_8.scrollIntoView(_a,_b);};});},"dijit/_TemplatedMixin":function(){define("dijit/_TemplatedMixin",["dojo/_base/lang","dojo/touch","./_WidgetBase","dojo/string","dojo/cache","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/sniff","dojo/_base/unload","dojo/_base/window"],function(_c,_d,_e,_f,_10,_11,_12,_13,has,_14,win){var _15=_12("dijit._TemplatedMixin",null,{templateString:null,templatePath:null,_skipNodeCache:false,_earlyTemplatedStartup:false,constructor:function(){this._attachPoints=[];this._attachEvents=[];},_stringRepl:function(_16){var _17=this.declaredClass,_18=this;return _f.substitute(_16,this,function(_19,key){if(key.charAt(0)=="!"){_19=_c.getObject(key.substr(1),false,_18);}if(typeof _19=="undefined"){throw new Error(_17+" template:"+key);}if(_19==null){return "";}return key.charAt(0)=="!"?_19:_19.toString().replace(/"/g,"&quot;");},this);},buildRendering:function(){if(!this.templateString){this.templateString=_10(this.templatePath,{sanitize:true});}var _1a=_15.getCachedTemplate(this.templateString,this._skipNodeCache);var _1b;if(_c.isString(_1a)){_1b=_13.toDom(this._stringRepl(_1a));if(_1b.nodeType!=1){throw new Error("Invalid template: "+_1a);}}else{_1b=_1a.cloneNode(true);}this.domNode=_1b;this.inherited(arguments);this._attachTemplateNodes(_1b,function(n,p){return n.getAttribute(p);});this._beforeFillContent();this._fillContent(this.srcNodeRef);},_beforeFillContent:function(){},_fillContent:function(_1c){var _1d=this.containerNode;if(_1c&&_1d){while(_1c.hasChildNodes()){_1d.appendChild(_1c.firstChild);}}},_attachTemplateNodes:function(_1e,_1f){var _20=_c.isArray(_1e)?_1e:(_1e.all||_1e.getElementsByTagName("*"));var x=_c.isArray(_1e)?0:-1;for(;x<_20.length;x++){var _21=(x==-1)?_1e:_20[x];if(this.widgetsInTemplate&&(_1f(_21,"dojoType")||_1f(_21,"data-dojo-type"))){continue;}var _22=_1f(_21,"dojoAttachPoint")||_1f(_21,"data-dojo-attach-point");if(_22){var _23,_24=_22.split(/\s*,\s*/);while((_23=_24.shift())){if(_c.isArray(this[_23])){this[_23].push(_21);}else{this[_23]=_21;}this._attachPoints.push(_23);}}var _25=_1f(_21,"dojoAttachEvent")||_1f(_21,"data-dojo-attach-event");if(_25){var _26,_27=_25.split(/\s*,\s*/);var _28=_c.trim;while((_26=_27.shift())){if(_26){var _29=null;if(_26.indexOf(":")!=-1){var _2a=_26.split(":");_26=_28(_2a[0]);_29=_28(_2a[1]);}else{_26=_28(_26);}if(!_29){_29=_26;}this._attachEvents.push(this.connect(_21,_d[_26]||_26,_29));}}}}},destroyRendering:function(){_11.forEach(this._attachPoints,function(_2b){delete this[_2b];},this);this._attachPoints=[];_11.forEach(this._attachEvents,this.disconnect,this);this._attachEvents=[];this.inherited(arguments);}});_15._templateCache={};_15.getCachedTemplate=function(_2c,_2d){var _2e=_15._templateCache;var key=_2c;var _2f=_2e[key];if(_2f){try{if(!_2f.ownerDocument||_2f.ownerDocument==win.doc){return _2f;}}catch(e){}_13.destroy(_2f);}_2c=_f.trim(_2c);if(_2d||_2c.match(/\$\{([^\}]+)\}/g)){return (_2e[key]=_2c);}else{var _30=_13.toDom(_2c);if(_30.nodeType!=1){throw new Error("Invalid template: "+_2c);}return (_2e[key]=_30);}};if(has("ie")){_14.addOnWindowUnload(function(){var _31=_15._templateCache;for(var key in _31){var _32=_31[key];if(typeof _32=="object"){_13.destroy(_32);}delete _31[key];}});}_c.extend(_e,{dojoAttachEvent:"",dojoAttachPoint:""});return _15;});},"dijit/_Templated":function(){define("dijit/_Templated",["./_WidgetBase","./_TemplatedMixin","./_WidgetsInTemplateMixin","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/kernel"],function(_33,_34,_35,_36,_37,_38,_39){_38.extend(_33,{waiRole:"",waiState:""});return _37("dijit._Templated",[_34,_35],{widgetsInTemplate:false,constructor:function(){_39.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0");},_attachTemplateNodes:function(_3a,_3b){this.inherited(arguments);var _3c=_38.isArray(_3a)?_3a:(_3a.all||_3a.getElementsByTagName("*"));var x=_38.isArray(_3a)?0:-1;for(;x<_3c.length;x++){var _3d=(x==-1)?_3a:_3c[x];var _3e=_3b(_3d,"waiRole");if(_3e){_3d.setAttribute("role",_3e);}var _3f=_3b(_3d,"waiState");if(_3f){_36.forEach(_3f.split(/\s*,\s*/),function(_40){if(_40.indexOf("-")!=-1){var _41=_40.split("-");_3d.setAttribute("aria-"+_41[0],_41[1]);}});}}}});});},"dijit/_CssStateMixin":function(){define("dijit/_CssStateMixin",["dojo/touch","dojo/_base/array","dojo/_base/declare","dojo/dom-class","dojo/_base/lang","dojo/_base/window"],function(_42,_43,_44,_45,_46,win){return _44("dijit._CssStateMixin",[],{cssStateNodes:{},hovering:false,active:false,_applyAttributes:function(){this.inherited(arguments);_43.forEach(["onmouseenter","onmouseleave",_42.press],function(e){this.connect(this.domNode,e,"_cssMouseEvent");},this);_43.forEach(["disabled","readOnly","checked","selected","focused","state","hovering","active"],function(_47){this.watch(_47,_46.hitch(this,"_setStateClass"));},this);for(var ap in this.cssStateNodes){this._trackMouseState(this[ap],this.cssStateNodes[ap]);}this._setStateClass();},_cssMouseEvent:function(_48){if(!this.disabled){switch(_48.type){case "mouseenter":case "mouseover":this._set("hovering",true);this._set("active",this._mouseDown);break;case "mouseleave":case "mouseout":this._set("hovering",false);this._set("active",false);break;case "mousedown":case "touchpress":this._set("active",true);this._mouseDown=true;var _49=this.connect(win.body(),_42.release,function(){this._mouseDown=false;this._set("active",false);this.disconnect(_49);});break;}}},_setStateClass:function(){var _4a=this.baseClass.split(" ");function _4b(_4c){_4a=_4a.concat(_43.map(_4a,function(c){return c+_4c;}),"dijit"+_4c);};if(!this.isLeftToRight()){_4b("Rtl");}var _4d=this.checked=="mixed"?"Mixed":(this.checked?"Checked":"");if(this.checked){_4b(_4d);}if(this.state){_4b(this.state);}if(this.selected){_4b("Selected");}if(this.disabled){_4b("Disabled");}else{if(this.readOnly){_4b("ReadOnly");}else{if(this.active){_4b("Active");}else{if(this.hovering){_4b("Hover");}}}}if(this.focused){_4b("Focused");}var tn=this.stateNode||this.domNode,_4e={};_43.forEach(tn.className.split(" "),function(c){_4e[c]=true;});if("_stateClasses" in this){_43.forEach(this._stateClasses,function(c){delete _4e[c];});}_43.forEach(_4a,function(c){_4e[c]=true;});var _4f=[];for(var c in _4e){_4f.push(c);}tn.className=_4f.join(" ");this._stateClasses=_4a;},_trackMouseState:function(_50,_51){var _52=false,_53=false,_54=false;var _55=this,cn=_46.hitch(this,"connect",_50);function _56(){var _57=("disabled" in _55&&_55.disabled)||("readonly" in _55&&_55.readonly);_45.toggle(_50,_51+"Hover",_52&&!_53&&!_57);_45.toggle(_50,_51+"Active",_53&&!_57);_45.toggle(_50,_51+"Focused",_54&&!_57);};cn("onmouseenter",function(){_52=true;_56();});cn("onmouseleave",function(){_52=false;_53=false;_56();});cn(_42.press,function(){_53=true;_56();});cn(_42.release,function(){_53=false;_56();});cn("onfocus",function(){_54=true;_56();});cn("onblur",function(){_54=false;_56();});this.watch("disabled",_56);this.watch("readOnly",_56);}});});},"ibm/tivoli/fwm/mxmap/toolbar/ext/FullScreen":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/toolbar/ext/_ToggleTool,dijit/form/Button,ibm/tivoli/fwm/i18n"],function(_58,_59,_5a){_59.provide("ibm.tivoli.fwm.mxmap.toolbar.ext.FullScreen");_59.require("ibm.tivoli.fwm.mxmap.toolbar.ext._ToggleTool");_59.require("dijit.form.Button");_59.require("ibm.tivoli.fwm.i18n");_59.declare("ibm.tivoli.fwm.mxmap.toolbar.ext.FullScreen",ibm.tivoli.fwm.mxmap.toolbar.ext._ToggleTool,{_labelOn:"Set Full Screen On",_labelOff:"Set Full Screen Off",iconClass:"basicMapToolbarBtn fullScreenMapToolbarBtn",map:null,_isFullScreen:false,constructor:function(_5b){_59.mixin(this,_5b);this._isFullScreen=false;this._handlers=[];var _5c=ibm.tivoli.fwm.i18n.getMaxMsg("map","toolbarfullscreenon");var _5d=ibm.tivoli.fwm.i18n.getMaxMsg("map","toolbarfullscreenoff");this._labelOn=_5c||this._labelOn;this._labelOff=_5d||this._labelOff;this.addSubscription(_59.subscribe("mapFullScreenModeChanged_"+this.map.getId(),_59.hitch(this,this._updateFullScreenState)));},createToolbarButton:function(){this._button=new _58.form.Button({label:this._labelOn,showLabel:false,iconClass:this.iconClass,onClick:_59.hitch(this,function(){this.execute();})});return this._button;},executeOn:function(){this._doFullScreen();},executeOff:function(){this._restoreOriginalSize();},disable:function(){},_doFullScreen:function(){this._changeButtonState(true,this._labelOff);this.map.fullScreenOn();},_restoreOriginalSize:function(_5e){this._changeButtonState(false,this._labelOn);this.map.fullScreenOff();},_updateFullScreenState:function(_5f){if(_5f.modeOn==true){this.setActive(true);this._changeButtonState(true,this._labelOff);}else{this.setActive(false);this._changeButtonState(false,this._labelOn);}},_changeButtonState:function(_60,_61){this._button.set({label:_61});this._isFullScreen=_60;}});});},"url:dijit/form/templates/ComboButton.html":"<table class=\"dijit dijitReset dijitInline dijitLeft\"\n\tcellspacing='0' cellpadding='0' role=\"presentation\"\n\t><tbody role=\"presentation\"><tr role=\"presentation\"\n\t\t><td class=\"dijitReset dijitStretch dijitButtonNode\" data-dojo-attach-point=\"buttonNode\" data-dojo-attach-event=\"ondijitclick:_onClick,onkeypress:_onButtonKeyPress\"\n\t\t><div id=\"${id}_button\" class=\"dijitReset dijitButtonContents\"\n\t\t\tdata-dojo-attach-point=\"titleNode\"\n\t\t\trole=\"button\" aria-labelledby=\"${id}_label\"\n\t\t\t><div class=\"dijitReset dijitInline dijitIcon\" data-dojo-attach-point=\"iconNode\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitInline dijitButtonText\" id=\"${id}_label\" data-dojo-attach-point=\"containerNode\" role=\"presentation\"></div\n\t\t></div\n\t\t></td\n\t\t><td id=\"${id}_arrow\" class='dijitReset dijitRight dijitButtonNode dijitArrowButton'\n\t\t\tdata-dojo-attach-point=\"_popupStateNode,focusNode,_buttonNode\"\n\t\t\tdata-dojo-attach-event=\"onkeypress:_onArrowKeyPress\"\n\t\t\ttitle=\"${optionsTitle}\"\n\t\t\trole=\"button\" aria-haspopup=\"true\"\n\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" role=\"presentation\">&#9660;</div\n\t\t></td\n\t\t><td style=\"display:none !important;\"\n\t\t\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" data-dojo-attach-point=\"valueNode\"\n\t\t/></td></tr></tbody\n></table>\n","dijit/DialogUnderlay":function(){define("dijit/DialogUnderlay",["dojo/_base/declare","dojo/dom-attr","dojo/_base/window","dojo/window","./_Widget","./_TemplatedMixin","./BackgroundIframe"],function(_62,_63,win,_64,_65,_66,_67){return _62("dijit.DialogUnderlay",[_65,_66],{templateString:"<div class='dijitDialogUnderlayWrapper'><div class='dijitDialogUnderlay' data-dojo-attach-point='node'></div></div>",dialogId:"","class":"",_setDialogIdAttr:function(id){_63.set(this.node,"id",id+"_underlay");this._set("dialogId",id);},_setClassAttr:function(_68){this.node.className="dijitDialogUnderlay "+_68;this._set("class",_68);},postCreate:function(){win.body().appendChild(this.domNode);},layout:function(){var is=this.node.style,os=this.domNode.style;os.display="none";var _69=_64.getBox();os.top=_69.t+"px";os.left=_69.l+"px";is.width=_69.w+"px";is.height=_69.h+"px";os.display="block";},show:function(){this.domNode.style.display="block";this.layout();this.bgIframe=new _67(this.domNode);},hide:function(){this.bgIframe.destroy();delete this.bgIframe;this.domNode.style.display="none";}});});},"ibm/tivoli/fwm/mxmap/toolbar/ext/ItineraryTool":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/toolbar/ext/_ToolTemplate,dijit/form/Button,ibm/tivoli/fwm/mxmap/panels/MobileInfoPanelDialog,ibm/tivoli/fwm/mxmap/routing/itinerary/ItineraryManager"],function(_6a,_6b,_6c){_6b.provide("ibm.tivoli.fwm.mxmap.toolbar.ext.ItineraryTool");_6b.require("ibm.tivoli.fwm.mxmap.toolbar.ext._ToolTemplate");_6b.require("dijit.form.Button");_6b.require("ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog");_6b.require("ibm.tivoli.fwm.mxmap.routing.itinerary.ItineraryManager");_6b.declare("ibm.tivoli.fwm.mxmap.toolbar.ext.ItineraryTool",ibm.tivoli.fwm.mxmap.toolbar.ext._ToolTemplate,{label:"Show Itinerary",iconClass:"basicMapToolbarBtn itineraryMapToolbarBtn",map:null,_itineraryManager:null,_dialog:null,constructor:function(_6d){_6b.mixin(this,_6d);var _6e=ibm.tivoli.fwm.i18n.getMaxMsg("map","itinerarytool");this.label=_6e||this.label;this._dialog=null;this._itineraryManager=new ibm.tivoli.fwm.mxmap.routing.itinerary.ItineraryManager({map:this.map});this.addSubscription(_6b.subscribe("showItinerary_"+this.map.getId(),_6b.hitch(this,this.triggerShowItinerary)));},triggerShowItinerary:function(){this.execute();},execute:function(){if(this._dialog){this._dialog.close();this._dialog=null;}var _6f=this.map.getMultipleRoutesManager();if(_6f&&_6f.routes&&_6f.routes[0]){var _70=_6f.routes[0].itinerary;if(_70){this._itineraryManager.updateRouteItinerary(_70,_6f,_6f.routes[0]);}}this._itineraryManager.showPanel();},disable:function(){},destroy:function(){this.destroyRecursive();}});});},"ibm/tivoli/fwm/mxmap/routing/MultipleRoutesManager":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/routing/RouterFactory,ibm/tivoli/fwm/mxmap/routing/itinerary/Itinerary"],function(_71,_72,_73){_72.provide("ibm.tivoli.fwm.mxmap.routing.MultipleRoutesManager");_72.require("ibm.tivoli.fwm.mxmap._Base");_72.require("ibm.tivoli.fwm.mxmap.routing.RouterFactory");_72.require("ibm.tivoli.fwm.mxmap.routing.itinerary.Itinerary");_72.declare("ibm.tivoli.fwm.mxmap.routing.MultipleRoutesManager",ibm.tivoli.fwm.mxmap._Base,{routeConf:null,provider:null,map:null,routeUrl:null,routingData:null,routes:null,visible:true,constructor:function(_74){_72.mixin(this,_74);this.factory=new ibm.tivoli.fwm.mxmap.routing.RouterFactory({map:this.map,provider:this.provider});this.routeConf.routeUrl=this.routeUrl;this.routes=[];},createRoute:function(_75,_76,_77,_78,_79){var _7a={routecolor:_76.routecolor,routeOpacity:0.5,routeLineWidth:5,endLocation:_76.end,startLocation:_76.start,optimizeroute:_76.optimizeroute,startwithcurrentlocation:_76.startwithcurrentlocation,routeUrl:_76.routeUrl,map:this.map};var _7b=this.factory.createRouter(_7a);_7b.customConf=this.customConf;var fct=function(_7c){_7c.id=this.routes.length;this.routes.push(_7c);_7c.setLineVisible(this.visible);_7c.show();if(_79!=true){_7c.zoomToRoute();}if(_77){_77(_7c);}};if(!_78){_78=_72.hitch(this,this.routingError);}_7b.drawRoute(_75,_72.hitch(this,fct),_78,_7a);},customConf:null,reGenerate:function(_7d,_7e,_7f,_80){this.customConf=_7e;if(_72.config.fwm.debug==true){}_7d.originalRouter.customConf=_7e;_7d.originalRouter.drawRoute(_7d.inputInfo.stops,_7f,_80);},replaceRoute:function(_81,id){this.removeRoute(this.routes[id]);this.routes[id]=_81;_81.id=id;},removeRoute:function(_82){_82.clear();},clearAll:function(){if(_72.config.fwm.debug==true){}while(this.routes.length>0){this.routes.pop().clear();}if(_72.config.fwm.debug==true){}},redrawAll:function(){_72.forEach(this.routes,function(_83){_83.redraw();});},setLineVisible:function(_84){_72.forEach(this.routes,function(_85){_85.setLineVisible(_84);});},hideRoutesAndCalculatedMarkers:function(){this.visible=false;_72.forEach(this.routes,function(_86){_86.setLineVisible(false);_86.hideCalculatedMarkers();});},showRoutesAndCalculatedMarkers:function(){this.visible=true;_72.forEach(this.routes,function(_87){_87.setLineVisible(true);_87.showCalculatedMarkers();});},centerAndZoom:function(){this.zoomAndCenterOverAll();},zoomAndCenterOverAll:function(){if(this.routes.length>0){var _88=this.routes[0].getBounds();for(var i=1;i<this.routes.length;i++){var r=this.routes[i];_88.merge(r.getBounds());}this.map.getMapstraction().setBounds(_88);}else{console.warn("[MultipleRoutesManager] No routes to center on");}},routingError:function(_89,_8a){var _8b=this.map.getMaximo();switch(_89){case ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.MIN_STOPS_REQ:_8b.showMessage("mapserver","route_min_stops_failure");break;case ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.ZERO_RESULTS:_8b.showMessage("mapserver","route_zero_results");break;case ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.INVALID_REQUEST:_8b.showMessage("mapserver","route_invalid_request");break;case ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.REQUEST_DENIED:_8b.showMessage("mapserver","route_request_denied");break;case ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.OVER_LIMIT:_8b.showMessage("mapserver","route_over_limit");break;case ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.TIMEOUT:_8b.showMessage("mapserver","route_timeout");break;default:var msg=_8a;if(_8a&&_8a.message){msg=_8a.message;}_8b.showMessage("mapserver","route_unknown_failure",[msg]);break;}},destroyRecursive:function(){if(this.router){this.router.destroyRecursive();}this.inherited(arguments);},getItinerary:function(){return this.routes[0].itinerary;}});});},"dijit/place":function(){define("dijit/place",["dojo/_base/array","dojo/dom-geometry","dojo/dom-style","dojo/_base/kernel","dojo/_base/window","dojo/window","."],function(_8c,_8d,_8e,_8f,win,_90,_91){function _92(_93,_94,_95,_96){var _97=_90.getBox();if(!_93.parentNode||String(_93.parentNode.tagName).toLowerCase()!="body"){win.body().appendChild(_93);}var _98=null;_8c.some(_94,function(_99){var _9a=_99.corner;var pos=_99.pos;var _9b=0;var _9c={w:{"L":_97.l+_97.w-pos.x,"R":pos.x-_97.l,"M":_97.w}[_9a.charAt(1)],h:{"T":_97.t+_97.h-pos.y,"B":pos.y-_97.t,"M":_97.h}[_9a.charAt(0)]};if(_95){var res=_95(_93,_99.aroundCorner,_9a,_9c,_96);_9b=typeof res=="undefined"?0:res;}var _9d=_93.style;var _9e=_9d.display;var _9f=_9d.visibility;if(_9d.display=="none"){_9d.visibility="hidden";_9d.display="";}var mb=_8d.getMarginBox(_93);_9d.display=_9e;_9d.visibility=_9f;var _a0={"L":pos.x,"R":pos.x-mb.w,"M":Math.max(_97.l,Math.min(_97.l+_97.w,pos.x+(mb.w>>1))-mb.w)}[_9a.charAt(1)],_a1={"T":pos.y,"B":pos.y-mb.h,"M":Math.max(_97.t,Math.min(_97.t+_97.h,pos.y+(mb.h>>1))-mb.h)}[_9a.charAt(0)],_a2=Math.max(_97.l,_a0),_a3=Math.max(_97.t,_a1),_a4=Math.min(_97.l+_97.w,_a0+mb.w),_a5=Math.min(_97.t+_97.h,_a1+mb.h),_a6=_a4-_a2,_a7=_a5-_a3;_9b+=(mb.w-_a6)+(mb.h-_a7);if(_98==null||_9b<_98.overflow){_98={corner:_9a,aroundCorner:_99.aroundCorner,x:_a2,y:_a3,w:_a6,h:_a7,overflow:_9b,spaceAvailable:_9c};}return !_9b;});if(_98.overflow&&_95){_95(_93,_98.aroundCorner,_98.corner,_98.spaceAvailable,_96);}var l=_8d.isBodyLtr(),s=_93.style;s.top=_98.y+"px";s[l?"left":"right"]=(l?_98.x:_97.w-_98.x-_98.w)+"px";s[l?"right":"left"]="auto";return _98;};return (_91.place={at:function(_a8,pos,_a9,_aa){var _ab=_8c.map(_a9,function(_ac){var c={corner:_ac,pos:{x:pos.x,y:pos.y}};if(_aa){c.pos.x+=_ac.charAt(1)=="L"?_aa.x:-_aa.x;c.pos.y+=_ac.charAt(0)=="T"?_aa.y:-_aa.y;}return c;});return _92(_a8,_ab);},around:function(_ad,_ae,_af,_b0,_b1){var _b2=(typeof _ae=="string"||"offsetWidth" in _ae)?_8d.position(_ae,true):_ae;if(_ae.parentNode){var _b3=_ae.parentNode;while(_b3&&_b3.nodeType==1&&_b3.nodeName!="BODY"){var _b4=_8d.position(_b3,true);var _b5=_8e.getComputedStyle(_b3).overflow;if(_b5=="hidden"||_b5=="auto"||_b5=="scroll"){var _b6=Math.min(_b2.y+_b2.h,_b4.y+_b4.h);var _b7=Math.min(_b2.x+_b2.w,_b4.x+_b4.w);_b2.x=Math.max(_b2.x,_b4.x);_b2.y=Math.max(_b2.y,_b4.y);_b2.h=_b6-_b2.y;_b2.w=_b7-_b2.x;}_b3=_b3.parentNode;}}var x=_b2.x,y=_b2.y,_b8="w" in _b2?_b2.w:(_b2.w=_b2.width),_b9="h" in _b2?_b2.h:(_8f.deprecated("place.around: dijit.place.__Rectangle: { x:"+x+", y:"+y+", height:"+_b2.height+", width:"+_b8+" } has been deprecated.  Please use { x:"+x+", y:"+y+", h:"+_b2.height+", w:"+_b8+" }","","2.0"),_b2.h=_b2.height);var _ba=[];function _bb(_bc,_bd){_ba.push({aroundCorner:_bc,corner:_bd,pos:{x:{"L":x,"R":x+_b8,"M":x+(_b8>>1)}[_bc.charAt(1)],y:{"T":y,"B":y+_b9,"M":y+(_b9>>1)}[_bc.charAt(0)]}});};_8c.forEach(_af,function(pos){var ltr=_b0;switch(pos){case "above-centered":_bb("TM","BM");break;case "below-centered":_bb("BM","TM");break;case "after":ltr=!ltr;case "before":_bb(ltr?"ML":"MR",ltr?"MR":"ML");break;case "below-alt":ltr=!ltr;case "below":_bb(ltr?"BL":"BR",ltr?"TL":"TR");_bb(ltr?"BR":"BL",ltr?"TR":"TL");break;case "above-alt":ltr=!ltr;case "above":_bb(ltr?"TL":"TR",ltr?"BL":"BR");_bb(ltr?"TR":"TL",ltr?"BR":"BL");break;default:_bb(pos.aroundCorner,pos.corner);}});var _be=_92(_ad,_ba,_b1,{w:_b8,h:_b9});_be.aroundNodePos=_b2;return _be;}});});},"dijit/_HasDropDown":function(){define("dijit/_HasDropDown",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/keys","dojo/_base/lang","dojo/touch","dojo/_base/window","dojo/window","./registry","./focus","./popup","./_FocusMixin"],function(_bf,_c0,_c1,dom,_c2,_c3,_c4,_c5,has,_c6,_c7,_c8,win,_c9,_ca,_cb,_cc,_cd){return _bf("dijit._HasDropDown",_cd,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:true,forceWidth:false,maxHeight:0,dropDownPosition:["below","above"],_stopClickEvents:true,_onDropDownMouseDown:function(e){if(this.disabled||this.readOnly){return;}e.preventDefault();this._docHandler=this.connect(win.doc,_c8.release,"_onDropDownMouseUp");this.toggleDropDown();},_onDropDownMouseUp:function(e){if(e&&this._docHandler){this.disconnect(this._docHandler);}var _ce=this.dropDown,_cf=false;if(e&&this._opened){var c=_c4.position(this._buttonNode,true);if(!(e.pageX>=c.x&&e.pageX<=c.x+c.w)||!(e.pageY>=c.y&&e.pageY<=c.y+c.h)){var t=e.target;while(t&&!_cf){if(_c3.contains(t,"dijitPopup")){_cf=true;}else{t=t.parentNode;}}if(_cf){t=e.target;if(_ce.onItemClick){var _d0;while(t&&!(_d0=_ca.byNode(t))){t=t.parentNode;}if(_d0&&_d0.onClick&&_d0.getParent){_d0.getParent().onItemClick(_d0,e);}}return;}}}if(this._opened){if(_ce.focus&&_ce.autoFocus!==false){window.setTimeout(_c7.hitch(_ce,"focus"),1);}}else{setTimeout(_c7.hitch(this,"focus"),0);}if(has("ios")){this._justGotMouseUp=true;setTimeout(_c7.hitch(this,function(){this._justGotMouseUp=false;}),0);}},_onDropDownClick:function(e){if(has("ios")&&!this._justGotMouseUp){this._onDropDownMouseDown(e);this._onDropDownMouseUp(e);}if(this._stopClickEvents){_c1.stop(e);}},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var _d1={"after":this.isLeftToRight()?"Right":"Left","before":this.isLeftToRight()?"Left":"Right","above":"Up","below":"Down","left":"Left","right":"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";_c3.add(this._arrowWrapperNode||this._buttonNode,"dijit"+_d1+"ArrowButton");},postCreate:function(){this.inherited(arguments);this.connect(this._buttonNode,_c8.press,"_onDropDownMouseDown");this.connect(this._buttonNode,"onclick","_onDropDownClick");this.connect(this.focusNode,"onkeypress","_onKey");this.connect(this.focusNode,"onkeyup","_onKeyUp");},destroy:function(){if(this.dropDown){if(!this.dropDown._destroyed){this.dropDown.destroyRecursive();}delete this.dropDown;}this.inherited(arguments);},_onKey:function(e){if(this.disabled||this.readOnly){return;}var d=this.dropDown,_d2=e.target;if(d&&this._opened&&d.handleKey){if(d.handleKey(e)===false){_c1.stop(e);return;}}if(d&&this._opened&&e.charOrCode==_c6.ESCAPE){this.closeDropDown();_c1.stop(e);}else{if(!this._opened&&(e.charOrCode==_c6.DOWN_ARROW||((e.charOrCode==_c6.ENTER||e.charOrCode==" ")&&((_d2.tagName||"").toLowerCase()!=="input"||(_d2.type&&_d2.type.toLowerCase()!=="text"))))){this._toggleOnKeyUp=true;_c1.stop(e);}}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var d=this.dropDown;if(d&&d.focus){setTimeout(_c7.hitch(d,"focus"),1);}}},_onBlur:function(){var _d3=_cb.curNode&&this.dropDown&&dom.isDescendant(_cb.curNode,this.dropDown.domNode);this.closeDropDown(_d3);this.inherited(arguments);},isLoaded:function(){return true;},loadDropDown:function(_d4){_d4();},loadAndOpenDropDown:function(){var d=new _c0(),_d5=_c7.hitch(this,function(){this.openDropDown();d.resolve(this.dropDown);});if(!this.isLoaded()){this.loadDropDown(_d5);}else{_d5();}return d;},toggleDropDown:function(){if(this.disabled||this.readOnly){return;}if(!this._opened){this.loadAndOpenDropDown();}else{this.closeDropDown();}},openDropDown:function(){var _d6=this.dropDown,_d7=_d6.domNode,_d8=this._aroundNode||this.domNode,_d9=this;if(!this._preparedNode){this._preparedNode=true;if(_d7.style.width){this._explicitDDWidth=true;}if(_d7.style.height){this._explicitDDHeight=true;}}if(this.maxHeight||this.forceWidth||this.autoWidth){var _da={display:"",visibility:"hidden"};if(!this._explicitDDWidth){_da.width="";}if(!this._explicitDDHeight){_da.height="";}_c5.set(_d7,_da);var _db=this.maxHeight;if(_db==-1){var _dc=_c9.getBox(),_dd=_c4.position(_d8,false);_db=Math.floor(Math.max(_dd.y,_dc.h-(_dd.y+_dd.h)));}_cc.moveOffScreen(_d6);if(_d6.startup&&!_d6._started){_d6.startup();}var mb=_c4.getMarginSize(_d7);var _de=(_db&&mb.h>_db);_c5.set(_d7,{overflowX:"hidden",overflowY:_de?"auto":"hidden"});if(_de){mb.h=_db;if("w" in mb){mb.w+=16;}}else{delete mb.h;}if(this.forceWidth){mb.w=_d8.offsetWidth;}else{if(this.autoWidth){mb.w=Math.max(mb.w,_d8.offsetWidth);}else{delete mb.w;}}if(_c7.isFunction(_d6.resize)){_d6.resize(mb);}else{_c4.setMarginBox(_d7,mb);}}var _df=_cc.open({parent:this,popup:_d6,around:_d8,orient:this.dropDownPosition,onExecute:function(){_d9.closeDropDown(true);},onCancel:function(){_d9.closeDropDown(true);},onClose:function(){_c2.set(_d9._popupStateNode,"popupActive",false);_c3.remove(_d9._popupStateNode,"dijitHasDropDownOpen");_d9._opened=false;}});_c2.set(this._popupStateNode,"popupActive","true");_c3.add(_d9._popupStateNode,"dijitHasDropDownOpen");this._opened=true;return _df;},closeDropDown:function(_e0){if(this._opened){if(_e0){this.focus();}_cc.close(this.dropDown);this._opened=false;}}});});},"ibm/tivoli/fwm/mxmap/layers/LayerPanelWidget":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/_Widget,dijit/_Templated,ibm/tivoli/fwm/mxmap/panels/MobileInfoPanelDialog,ibm/tivoli/fwm/mxmap/layers/LayerWidget"],function(_e1,_e2,_e3){_e2.provide("ibm.tivoli.fwm.mxmap.layers.LayerPanelWidget");_e2.require("ibm.tivoli.fwm.mxmap._Base");_e2.require("dijit._Widget");_e2.require("dijit._Templated");_e2.require("ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog");_e2.require("ibm.tivoli.fwm.mxmap.layers.LayerWidget");_e2.declare("ibm.tivoli.fwm.mxmap.layers.LayerPanelWidget",[_e1._Widget,_e1._Templated,ibm.tivoli.fwm.mxmap._Base],{templateString:_e2.cache("ibm.tivoli.fwm.mxmap","templates/LayerPanelWidget.html","<div class=\"text\">\n\t<div data-dojo-attach-point=\"layers\"></div>\n</div>"),infoPanel:null,map:null,_layers:null,_title:null,_div:null,constructor:function(_e4){_e2.mixin(this,_e4);this._layers=[];this._title=_e4.title;},postCreate:function(){},updateLayers:function(_e5){if(_e2.config.fwm.debug==true){}_e2.forEach(this._layers,function(_e6){_e6.destroyRecursive(true);});var div=_e2.create("div");_e2.style(div,{borderBottom:"1px solid #E0E0E0"});this._layers=[];for(var i=0;i<_e5.length;i++){if(_e5[i].isVisibleInUI()){var _e7=new ibm.tivoli.fwm.mxmap.layers.LayerWidget({layer:_e5[i],layerPanel:this});_e2.place(_e7.domNode,div,"last");this._layers.push(_e7);}}_e2.place(div,this.layers,"only");if(!this._title){if(_e5[0] instanceof ibm.tivoli.fwm.mxmap.layers.SymbologyLayer){this._title=ibm.tivoli.fwm.i18n.getMaxMsg("map","symbologydialogtitle");}else{if(_e5[0] instanceof ibm.tivoli.fwm.mxmap.layers.LegendLayer){this._title=ibm.tivoli.fwm.i18n.getMaxMsg("map","legenddialogtitle");}else{this._title=ibm.tivoli.fwm.i18n.getMaxMsg("map","layers");}}}if(this.infoPanel){this.infoPanel.close();this.infoPanel=null;}this.infoPanel=new ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog({map:this.map,title:this._title});this.infoPanel.setContent(this.domNode);this.infoPanel.show(true);},close:function(){if(this.infoPanel){this.infoPanel.close();this.infoPanel=null;}}});});},"dijit/_MenuBase":function(){define("dijit/_MenuBase",["./popup","dojo/window","./_Widget","./_KeyNavContainer","./_TemplatedMixin","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/_base/array"],function(pm,_e8,_e9,_ea,_eb,_ec,dom,_ed,_ee,_ef,_f0){return _ec("dijit._MenuBase",[_e9,_eb,_ea],{parentMenu:null,popupDelay:500,onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.focusedChild._onClick(evt);}else{var _f1=this._getTopMenu();if(_f1&&_f1._isMenuBar){_f1.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _f2=this.currentPopup.parentMenu;if(_f2.focusedChild){_f2.focusedChild._setSelected(false);}_f2.focusedChild=this.currentPopup.from_item;_f2.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(_f3){if(this.isActive){this.focusChild(_f3);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=setTimeout(_ef.hitch(this,"_openPopup"),this.popupDelay);}}if(this.focusedChild){this.focusChild(_f3);}this._hoveredChild=_f3;},_onChildBlur:function(_f4){this._stopPopupTimer();_f4._setSelected(false);var _f5=_f4.popup;if(_f5){this._stopPendingCloseTimer(_f5);_f5._pendingClose_timer=setTimeout(function(){_f5._pendingClose_timer=null;if(_f5.parentMenu){_f5.parentMenu.currentPopup=null;}pm.close(_f5);},this.popupDelay);}},onItemUnhover:function(_f6){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==_f6){this._hoveredChild=null;}},_stopPopupTimer:function(){if(this.hover_timer){clearTimeout(this.hover_timer);this.hover_timer=null;}},_stopPendingCloseTimer:function(_f7){if(_f7._pendingClose_timer){clearTimeout(_f7._pendingClose_timer);_f7._pendingClose_timer=null;}},_stopFocusTimer:function(){if(this._focus_timer){clearTimeout(this._focus_timer);this._focus_timer=null;}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(_f8,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(_f8);if(_f8.disabled){return false;}if(_f8.popup){this._openPopup();}else{this.onExecute();_f8.onClick(evt);}},_openPopup:function(){this._stopPopupTimer();var _f9=this.focusedChild;if(!_f9){return;}var _fa=_f9.popup;if(_fa.isShowingNow){return;}if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_fa.parentMenu=this;_fa.from_item=_f9;var _fb=this;pm.open({parent:this,popup:_fa,around:_f9.domNode,orient:this._orient||["after","before"],onCancel:function(){_fb.focusChild(_f9);_fb._cleanUp();_f9._setSelected(true);_fb.focusedChild=_f9;},onExecute:_ef.hitch(this,"_cleanUp")});this.currentPopup=_fa;_fa.connect(_fa.domNode,"onmouseenter",_ef.hitch(_fb,"_onPopupHover"));if(_fa.focus){_fa._focus_timer=setTimeout(_ef.hitch(_fa,function(){this._focus_timer=null;this.focus();}),0);}},_markActive:function(){this.isActive=true;_ee.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_ee.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_f0.indexOf(this._focusManager.activeStack,this.id)>=0){_ed.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.focusedChild._onUnhover();this.focusedChild=null;}},_onItemFocus:function(_fc){if(this._hoveredChild&&this._hoveredChild!=_fc){this._hoveredChild._onUnhover();}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});},"dijit/focus":function(){define("dijit/focus",["dojo/aspect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/Evented","dojo/_base/lang","dojo/on","dojo/ready","dojo/_base/sniff","dojo/Stateful","dojo/_base/unload","dojo/_base/window","dojo/window","./a11y","./registry","."],function(_fd,_fe,dom,_ff,_100,_101,lang,on,_102,has,_103,_104,win,_105,a11y,_106,_107){var _108=_fe([_103,_101],{curNode:null,activeStack:[],constructor:function(){var _109=lang.hitch(this,function(node){if(dom.isDescendant(this.curNode,node)){this.set("curNode",null);}if(dom.isDescendant(this.prevNode,node)){this.set("prevNode",null);}});_fd.before(_100,"empty",_109);_fd.before(_100,"destroy",_109);},registerIframe:function(_10a){return this.registerWin(_10a.contentWindow,_10a);},registerWin:function(_10b,_10c){var _10d=this;var _10e=function(evt){_10d._justMouseDowned=true;setTimeout(function(){_10d._justMouseDowned=false;},0);if(has("ie")&&evt&&evt.srcElement&&evt.srcElement.parentNode==null){return;}_10d._onTouchNode(_10c||evt.target||evt.srcElement,"mouse");};var doc=has("ie")?_10b.document.documentElement:_10b.document;if(doc){if(has("ie")){_10b.document.body.attachEvent("onmousedown",_10e);var _10f=function(evt){var tag=evt.srcElement.tagName.toLowerCase();if(tag=="#document"||tag=="body"){return;}if(a11y.isTabNavigable(evt.srcElement)){_10d._onFocusNode(_10c||evt.srcElement);}else{_10d._onTouchNode(_10c||evt.srcElement);}};doc.attachEvent("onactivate",_10f);var _110=function(evt){_10d._onBlurNode(_10c||evt.srcElement);};doc.attachEvent("ondeactivate",_110);return {remove:function(){_10b.document.detachEvent("onmousedown",_10e);doc.detachEvent("onactivate",_10f);doc.detachEvent("ondeactivate",_110);doc=null;}};}else{doc.body.addEventListener("mousedown",_10e,true);doc.body.addEventListener("touchstart",_10e,true);var _111=function(evt){_10d._onFocusNode(_10c||evt.target);};doc.addEventListener("focus",_111,true);var _112=function(evt){_10d._onBlurNode(_10c||evt.target);};doc.addEventListener("blur",_112,true);return {remove:function(){doc.body.removeEventListener("mousedown",_10e,true);doc.body.removeEventListener("touchstart",_10e,true);doc.removeEventListener("focus",_111,true);doc.removeEventListener("blur",_112,true);doc=null;}};}}},_onBlurNode:function(){this.set("prevNode",this.curNode);this.set("curNode",null);if(this._justMouseDowned){return;}if(this._clearActiveWidgetsTimer){clearTimeout(this._clearActiveWidgetsTimer);}this._clearActiveWidgetsTimer=setTimeout(lang.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([]);this.prevNode=null;}),100);},_onTouchNode:function(node,by){if(this._clearActiveWidgetsTimer){clearTimeout(this._clearActiveWidgetsTimer);delete this._clearActiveWidgetsTimer;}var _113=[];try{while(node){var _114=_ff.get(node,"dijitPopupParent");if(_114){node=_106.byId(_114).domNode;}else{if(node.tagName&&node.tagName.toLowerCase()=="body"){if(node===win.body()){break;}node=_105.get(node.ownerDocument).frameElement;}else{var id=node.getAttribute&&node.getAttribute("widgetId"),_115=id&&_106.byId(id);if(_115&&!(by=="mouse"&&_115.get("disabled"))){_113.unshift(id);}node=node.parentNode;}}}}catch(e){}this._setStack(_113,by);},_onFocusNode:function(node){if(!node){return;}if(node.nodeType==9){return;}this._onTouchNode(node);if(node==this.curNode){return;}this.set("curNode",node);},_setStack:function(_116,by){var _117=this.activeStack;this.set("activeStack",_116);for(var _118=0;_118<Math.min(_117.length,_116.length);_118++){if(_117[_118]!=_116[_118]){break;}}var _119;for(var i=_117.length-1;i>=_118;i--){_119=_106.byId(_117[i]);if(_119){_119._hasBeenBlurred=true;_119.set("focused",false);if(_119._focusManager==this){_119._onBlur(by);}this.emit("widget-blur",_119,by);}}for(i=_118;i<_116.length;i++){_119=_106.byId(_116[i]);if(_119){_119.set("focused",true);if(_119._focusManager==this){_119._onFocus(by);}this.emit("widget-focus",_119,by);}}},focus:function(node){if(node){try{node.focus();}catch(e){}}}});var _11a=new _108();_102(function(){var _11b=_11a.registerWin(win.doc.parentWindow||win.doc.defaultView);if(has("ie")){_104.addOnWindowUnload(function(){_11b.remove();_11b=null;});}});_107.focus=function(node){_11a.focus(node);};for(var attr in _11a){if(!/^_/.test(attr)){_107.focus[attr]=typeof _11a[attr]=="function"?lang.hitch(_11a,attr):_11a[attr];}}_11a.watch(function(attr,_11c,_11d){_107.focus[attr]=_11d;});return _11a;});},"dojo/i18n":function(){define("dojo/i18n",["./_base/kernel","require","./has","./_base/array","./_base/lang","./_base/xhr"],function(dojo,_11e,has,_11f,lang){var _120=dojo.i18n={},_121=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,_122=function(root,_123,_124,_125){for(var _126=[_124+_125],_127=_123.split("-"),_128="",i=0;i<_127.length;i++){_128+=(_128?"-":"")+_127[i];if(!root||root[_128]){_126.push(_124+_128+"/"+_125);}}return _126;},_129={},_12a=dojo.getL10nName=function(_12b,_12c,_12d){_12d=_12d?_12d.toLowerCase():dojo.locale;_12b="dojo/i18n!"+_12b.replace(/\./g,"/");_12c=_12c.replace(/\./g,"/");return (/root/i.test(_12d))?(_12b+"/nls/"+_12c):(_12b+"/nls/"+_12d+"/"+_12c);},_12e=function(_12f,_130,_131,_132,_133,load){_12f([_130],function(root){var _134=_129[_130+"/"]=lang.clone(root.root),_135=_122(!root._v1x&&root,_133,_131,_132);_12f(_135,function(){for(var i=1;i<_135.length;i++){_129[_135[i]]=_134=lang.mixin(lang.clone(_134),arguments[i]);}var _136=_130+"/"+_133;_129[_136]=_134;load&&load(lang.delegate(_134));});});},_137=function(id,_138){var _139=_121.exec(id),_13a=_139[1];return /^\./.test(_13a)?_138(_13a)+"/"+id.substring(_13a.length):id;};load=function(id,_13b,load){var _13c=_121.exec(id),_13d=_13c[1]+"/",_13e=_13c[5]||_13c[4],_13f=_13d+_13e,_140=(_13c[5]&&_13c[4]),_141=_140||dojo.locale,_142=_13f+"/"+_141;if(_140){if(_129[_142]){load(_129[_142]);}else{_12e(_13b,_13f,_13d,_13e,_141,load);}return;}var _143=dojo.config.extraLocale||[];_143=lang.isArray(_143)?_143:[_143];_143.push(_141);_11f.forEach(_143,function(_144){_12e(_13b,_13f,_13d,_13e,_144,_144==_141&&load);});};true||has.add("dojo-v1x-i18n-Api",1);if(1){var _145=new Function("bundle","var __preAmdResult, __amdResult; function define(bundle){__amdResult= bundle;} __preAmdResult= eval(bundle); return [__preAmdResult, __amdResult];"),_146=function(url,_147,_148){return _147?(/nls\/[^\/]+\/[^\/]+$/.test(url)?_147:{root:_147,_v1x:1}):_148;},_149=function(deps,_14a){var _14b=[];dojo.forEach(deps,function(mid){var url=_11e.toUrl(mid+".js");if(_129[url]){_14b.push(_129[url]);}else{try{var _14c=_11e(mid);if(_14c){_14b.push(_14c);return;}}catch(e){}dojo.xhrGet({url:url,sync:true,load:function(text){var _14d=_145(text);_14b.push(_129[url]=_146(url,_14d[0],_14d[1]));},error:function(){_14b.push(_129[url]={});}});}});_14a.apply(null,_14b);};_120.getLocalization=function(_14e,_14f,_150){var _151,_152=_12a(_14e,_14f,_150).substring(10);load(_152,(1&&!_11e.isXdUrl(_11e.toUrl(_152+".js"))?_149:_11e),function(_153){_151=_153;});return _151;};_120.normalizeLocale=function(_154){var _155=_154?_154.toLowerCase():dojo.locale;if(_155=="root"){_155="ROOT";}return _155;};}return lang.mixin(_120,{dynamic:true,normalize:_137,load:load,cache:function(mid,_156){_129[mid]=_156;}});});},"dijit/hccss":function(){define("dijit/hccss",["require","dojo/_base/config","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/ready","dojo/_base/sniff","dojo/_base/window"],function(_157,_158,_159,_15a,_15b,_15c,has,win){if(has("ie")||has("mozilla")){_15c(90,function(){var div=_15a.create("div",{id:"a11yTestNode",style:{cssText:"border: 1px solid;"+"border-color:red green;"+"position: absolute;"+"height: 5px;"+"top: -999px;"+"background-image: url(\""+(_158.blankGif||_157.toUrl("dojo/resources/blank.gif"))+"\");"}},win.body());var cs=_15b.getComputedStyle(div);if(cs){var _15d=cs.backgroundImage;var _15e=(cs.borderTopColor==cs.borderRightColor)||(_15d!=null&&(_15d=="none"||_15d=="url(invalid-url:)"));if(_15e){_159.add(win.body(),"dijit_a11y");}if(has("ie")){div.outerHTML="";}else{win.body().removeChild(div);}}});}});},"ibm/tivoli/fwm/mxmap/toolbar/ext/_ToolTemplate":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/form/Button"],function(_15f,dojo,_160){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ext._ToolTemplate");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("dijit.form.Button");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ext._ToolTemplate",ibm.tivoli.fwm.mxmap._Base,{map:null,label:"",_button:null,iconClass:"basicMapToolbarBtn",constructor:function(_161){dojo.mixin(this,_161);this._handlers=[];},createToolbarButton:function(){this._button=new _15f.form.Button({label:this.label,showLabel:false,iconClass:this.iconClass,onClick:dojo.hitch(this,function(){this.execute();})});return this._button;},execute:function(){console.error("to be implemented");},disable:function(){console.error("to be implemented");},destroy:function(){this._button.destroyRecursive();this.inherited(arguments);this.destroyRecursive();}});});},"ibm/tivoli/fwm/mxmap/routing/itinerary/ItineraryManager":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/_Widget,dijit/_Templated,dijit/form/CheckBox,dijit/form/RadioButton,ibm/tivoli/fwm/mxmap/panels/MobileInfoPanelDialog,ibm/tivoli/fwm/mxmap/routing/itinerary/Leg,ibm/tivoli/fwm/mxmap/routing/itinerary/Step"],function(_162,dojo,_163){dojo.provide("ibm.tivoli.fwm.mxmap.routing.itinerary.ItineraryManager");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("dijit.form.CheckBox");dojo.require("dijit.form.RadioButton");dojo.require("ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog");dojo.require("ibm.tivoli.fwm.mxmap.routing.itinerary.Leg");dojo.require("ibm.tivoli.fwm.mxmap.routing.itinerary.Step");dojo.declare("ibm.tivoli.fwm.mxmap.routing.itinerary.ItineraryManager",[_162._Widget,_162._Templated,ibm.tivoli.fwm.mxmap._Base],{templateString:dojo.cache("ibm.tivoli.fwm.mxmap","templates/ItineraryManager.html","<div style=\"width:100%;overflow: auto;\">\n\t<div data-dojo-attach-point=\"controls\" style=\"background-color: #FFFFFF;border: 1px solid #E0E0E0;padding: 10px;margin-left: 4px; margin-right: 4px;\">\n\t\t<div style=\"float:left;width:50%;\" data-dojo-attach-point=\"avoidersNode\">\n\t\t\t<div style=\"padding-top:0px;padding-bottom:10px\">\n\t\t\t\t<span data-dojo-attach-point=\"ahNode\" style=\"padding-left:10px;padding-right:10px\"></span> <div data-dojo-attach-point=\"avoidhighwaysdiv\" data-dojo-attach-event=\"ondijitclick:_highClick\" style=\"display:inline\"><label data-dojo-attach-point=\"itineraryavoidhighways\" for=\"avoidhighways\">Avoid highways</label></div><br/>\n\t\t\t</div>\n\t\t\t<div style=\"padding-top: 10px; padding-bottom:0px\">\n\t\t\t\t<span data-dojo-attach-point=\"atNode\" style=\"padding-left:10px;padding-right:10px\"></span> <div data-dojo-attach-point=\"avoidtollsdiv\" data-dojo-attach-event=\"ondijitclick:_tollsClick\" style=\"display:inline\"><label data-dojo-attach-point=\"itineraryavoidtolls\" for=\"avoidtolls\">Avoid tolls</label></div><br/>\n\t\t\t</div>\n\t\t</div>\n\t\t<div data-dojo-attach-point=\"kmdiv\" data-dojo-attach-event=\"ondijitclick:_kmClick\" style=\"padding-top:0px;padding-bottom:10px\">\n\t\t\t<span data-dojo-attach-point=\"kmNode\" style=\"padding-left:10px;padding-right:10px\"></span><label data-dojo-attach-point=\"itinerarykm\" for=\"km\">Kilometers</label>\n\t\t</div>\n\t\t<div data-dojo-attach-point=\"milesdiv\" data-dojo-attach-event=\"ondijitclick:_milesClick\" style=\"padding-top:10px;padding-bottom:0px\">\n\t\t\t<span data-dojo-attach-point=\"miNode\" style=\"padding-left:10px;padding-right:10px\"></span><label data-dojo-attach-point=\"itinerarymiles\" for=\"miles\">Miles</label>\n\t\t</div>\n\t</div>\n\t<div data-dojo-attach-point=\"markerNode\" style=\"float:left;\" data-dojo-attach-event=\"ondijitclick:_onInitialLocClick\"></div>\n\t<div data-dojo-attach-point=\"startLocation\" style=\"margin: 1px;padding: 7px 2px;\" ></div>\n\t<div data-dojo-attach-point=\"routeInfo\" style=\"padding: 2px;\">\n\t</div>\n</div>"),infoPanel:null,map:null,legs:[],constructor:function(_164){dojo.mixin(this,_164);},highway:null,toll:null,km:null,miles:null,postCreate:function(){var _165=navigator.userAgent.indexOf("Android")>-1;var _166=(_165?function(_167,_168){return new ibm.tivoli.fwm.mxmap.routing.itinerary.MobileInput("checkbox",_167,_168);}:function(_169,_16a){return new _162.form.CheckBox(_169,_16a);});var _16b=(_165?function(_16c,_16d){return new ibm.tivoli.fwm.mxmap.routing.itinerary.MobileInput("radio",_16c,_16d);}:function(_16e,_16f){return new _162.form.RadioButton(_16e,_16f);});this.highway=_166({name:"highway",value:"highway",checked:false,onChange:dojo.hitch(this,this.onHighWayChanged),label:this.itineraryavoidhighways},this.ahNode);this.toll=_166({name:"toll",value:"toll",checked:false,onChange:dojo.hitch(this,this.onTollChanged),label:this.itineraryavoidtolls},this.atNode);var _170=this.map.getDefaultLengthUnit();this.km=_16b({checked:(_170=="KILOMETERS"),value:"km",name:"unit",onChange:dojo.hitch(this,this.onUnitChanged),label:this.itinerarykm},this.kmNode);this.miles=_16b({checked:(_170=="MILES"),value:"mi",name:"unit",onChange:dojo.hitch(this,this.onUnitChanged),label:this.itinerarymiles},this.miNode);this.itineraryavoidhighways.innerHTML=ibm.tivoli.fwm.i18n.getMaxMsg("map","itineraryavoidhw");this.itineraryavoidtolls.innerHTML=ibm.tivoli.fwm.i18n.getMaxMsg("map","itineraryavoidtolls");this.itinerarykm.innerHTML=ibm.tivoli.fwm.i18n.getMaxMsg("map","itinerarykm");this.itinerarymiles.innerHTML=ibm.tivoli.fwm.i18n.getMaxMsg("map","itinerarymiles");this.addressLoading=ibm.tivoli.fwm.i18n.getMaxMsg("map","address_being_loaded");this.failedToLoadAddress=ibm.tivoli.fwm.i18n.getMaxMsg("map","address_info_not_found");},_highClick:function(){var _171=!this.highway.get("value");this.highway.set("checked",_171);},_tollsClick:function(){var _172=!this.toll.get("value");this.toll.set("checked",_172);},_kmClick:function(){this.km.set("checked",true);},_milesClick:function(){this.miles.set("checked",true);},onUnitChanged:function(_173){if(_173==true){this.onRouteControlsChanged(false);}},onTollChanged:function(){this.onRouteControlsChanged(true);},onHighWayChanged:function(arg){this.onRouteControlsChanged(true);},enableControls:function(_174){this.miles.setDisabled(!_174);this.km.setDisabled(!_174);this.highway.setDisabled(!_174);this.toll.setDisabled(!_174);},onRouteControlsChanged:function(_175){this.enableControls(false);var _176=this.getControls();var conf=this.route.inputInfo;var me=this;if(!this.infoPanel){this._getInfoPanel();}var fct=function(_177){var _178=me.route.id;if(_175==true){me.routeManager.replaceRoute(_177,_178);_177.show();}me.updateRouteItinerary(_177.itinerary,me.routeManager,_177);me.enableControls(true);};var _179=function(_17a){me.enableControls(true);conf.errorCb(_17a);};if(_175==true){dojo.empty(this.routeInfo);dojo.create("img",{src:dojo.config.fwm.ctxRoot+"/webclient/skins/tivoli09/images/progressbar.gif"},this.routeInfo);this.routeManager.reGenerate(this.route,_176,fct,_179);}else{this.route.originalRouter.customConf=_176;fct(this.route);}},getControls:function(){var _17b={};if(this.highway.get("value")!=false){_17b.avoidHighway=true;}else{_17b.avoidHighway=false;}if(this.toll.get("value")!=false){_17b.avoidToll=true;}else{_17b.avoidToll=false;}var km=this.km.get("value")!=false;var _17c=this.miles.get("value")!=false;if(km==true){_17b.distanceUnit=ibm.tivoli.fwm.mxmap.routing.DistanceUnit.KM;}else{_17b.distanceUnit=ibm.tivoli.fwm.mxmap.routing.DistanceUnit.MILES;}return _17b;},routeManager:null,route:null,_createLegFromInitialLocation:function(_17d){var leg=_17d;leg.marker=this.route.getMarkerForStop(0);leg.map=this.map;leg.distanceUnit=this.getControls().distanceUnit;var _17e=new ibm.tivoli.fwm.mxmap.routing.itinerary.Leg(leg);return _17e;dojo.place(_17e.domNode,this.routeInfo,"first");},updateRouteItinerary:function(_17f,_180,_181){this.routeManager=_180;this.route=_181;if(this.route==null){this.enableControls(false);return;}this.enableControls(true);if(this.route.avoidTollsSupported==false&&this.route.avoidHighwaysSupported==false){dojo.style(this.avoidersNode,"display","none");}else{dojo.style(this.avoidersNode,"display","block");}this.legs=[];var _182=_17f.getInitialLocation();var fct=function(){this.infoPanel.close();};if(_182){_182.marker=this.route.getMarkerForStop(0);_182.closeDialog=dojo.hitch(this,fct);var _183=this._createLegFromInitialLocation(_182);dojo.place(_183.domNode,this.startLocation,"only");}dojo.empty(this.routeInfo);for(var i=0;i<_17f.legs.length;i++){var leg=_17f.legs[i];leg.marker=this.route.getMarkerForStop(i+1);leg.map=this.map;leg.distanceUnit=this.getControls().distanceUnit;leg.closeDialog=dojo.hitch(this,fct);var _183=new ibm.tivoli.fwm.mxmap.routing.itinerary.Leg(leg);dojo.place(_183.domNode,this.routeInfo,"last");this.legs.push(_183);}},_onInitialLocClick:function(args){var _184=this.route.itinerary.getInitialLocation().location;this.map.getMapstraction().setCenter(_184);},isIt:false,showPanel:function(){if(this.isIt==false){this.isIt=true;this._getInfoPanel();this.infoPanel.setContent(this.domNode);}if(this.route==null){this.enableControls(false);}else{this.enableControls(true);}this.infoPanel.show();},_getInfoPanel:function(){if(this.infoPanel){this.infoPanel.close();this.infoPanel=null;}this.infoPanel=new ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog({map:this.map,fitHeight:true});return this.infoPanel;}});dojo.declare("ibm.tivoli.fwm.mxmap.routing.itinerary.MobileInput",[],{_checkbox:null,constructor:function(type,args,_185){_185.innerHTML+="<input type=\""+type+"\" name=\""+args.name+"\" value=\""+args.value+"\"/>";var _186=_185.childNodes[0];_186.checked=args.checked;var _187=args.onChange;_186.onchange=function(evt){_187(evt.target.checked);};args.label.onclick=function(){_186.click();};this._checkbox=_186;},get:function(name){if(name=="value"){return this._checkbox.checked;}},set:function(name,_188){},setDisabled:function(_189){this._checkbox.disabled=_189;}});});},"ibm/tivoli/fwm/mxmap/panels/MobileInfoPanelLine":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated"],function(_18a,dojo,_18b){dojo.provide("ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelLine");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.declare("ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelLine",[_18a._Widget,_18a._Templated],{templateString:"<tr role=\"row\" style=\"display: ;\" dojoAttachPoint=\"row\">\n\t<th>\n\t\t<img src=\"../webclient/skins/tivoli09/images/blank.gif\" style=\"display: none\" class=\"tablerow_blank_icon\" title=\"\" alt=\"\">\n\t</th>\n\t<td role=\"gridcell\" control=\"true\" dojoAttachPoint=\"clickable\" onmouseover=\"appendClass(this.parentNode,'trh')\" onmouseout=\"removeClass(this.parentNode,'trh')\" style=\"padding-left: 5px;\" class=\"tc hl cursor_hand\">\n\t\t<table role=\"presentation\" style=\"display: inline;\">\n\t\t\t<tbody>\n\t\t\t\t<tr>\n\t\t\t\t\t<td nowrap=\"nowrap\" valign=\"top\" style=\"vertical-align: top;\">\n\t\t\t\t\t\t<table role=\"presentation\" control=\"true\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\" \" summary=\"\" style=\"width: 100%; vertical-align: top\">\n\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t<tr control=\"true\" style=\"vertical-align: top;\">\n\t\t\t\t\t\t\t\t\t<td nowrap=\"nowrap\" align=\"left\" valign=\"top\" style=\"vertical-align: top;\">\n\t\t\t\t\t\t\t\t\t\t<div aria-live=\"polite\" class=\"bc\">\n\t\t\t\t\t\t\t\t\t\t\t<span ctype=\"label\" tabindex=\"0\" \n\t\t\t\t\t\t\t\t\t\t\tclass=\"text txtplain  label  \" \n\t\t\t\t\t\t\t\t\t\t\tstyle=\"cursor: pointer;\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"content\"></div>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</td>\n</tr>",domNode:null,row:null,content:null,clickable:null,constructor:function(_18c){dojo.mixin(this,_18c);},postCreate:function(){dojo.parser.parse(this.domNode);},setCallbackFunction:function(_18d){this.clickable.onclick=_18d;},setRowClass:function(_18e){dojo.addClass(this.row,_18e);},setContent:function(_18f){this.content.innerHTML=_18f;}});});},"ibm/tivoli/fwm/mxmap/MapTipsManager":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/i18n,dijit/form/Select"],function(_190,dojo,_191){dojo.provide("ibm.tivoli.fwm.mxmap.MapTipsManager");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.i18n");dojo.require("dijit.form.Select");dojo.declare("ibm.tivoli.fwm.mxmap.MapTipsManager",ibm.tivoli.fwm.mxmap._Base,{_templateCache:{},_menuCache:{},maximo:null,constructor:function(_192){dojo.mixin(this,_192);this._templateCache={};this._menuCache={};},enableMarker:function(_193,_194){_193.openBubble.clone=function(){var that=this;var temp=function temporary(){return that.apply(this,arguments);};for(key in this){temp[key]=this[key];}return temp;};var _195=_193.openBubble.clone();var me=this;_193.openBubble=function(){me._handleOpenBubble(_193,_194,_195);};},_isTemplateLoaded:function(_196,id){return this._templateCache[_196]&&this._templateCache[_196][id];},_getTemplate:function(_197,id){return this._templateCache[_197][id];},_onTemplateLoaded:function(html,_198,_199,fct){var _19a=_199.mboName;var id=_199.uid.value;this._updateTemplate(_19a,id,html);this._openMapTip(_19a,id,_198,fct);},_updateTemplate:function(_19b,id,html){if(!this._templateCache.hasOwnProperty(_19b)){this._templateCache[_19b]={};}this._templateCache[_19b][id]=html;},_openMapTip:function(_19c,id,_19d,fct){var html=this._getTemplate(_19c,id);var _19e=this._getMenuData(_19c);var _19f=this._createInfoDOM(html,_19e,_19c,id);_19d.setInfoBubble(_19f);fct.apply(_19d);},_createInfoDOM:function(html,_1a0,_1a1,_1a2){var _1a3=dojo.create("div",{style:{overflow:"auto",marginTop:"8px"}});var _1a4=dojo.create("div",{innerHTML:html},_1a3);if(_1a0){var _1a5=dojo.create("div",null,_1a3);this._newSelect(_1a0,_1a5,_1a1,_1a2);}return _1a3;},_handleOpenBubble:function(_1a6,_1a7,fct){var _1a8=_1a7.mboName;var id=_1a7.uid.value;if(this._isMenuLoaded(_1a8)){this._loadTemplate(_1a7,_1a6,fct);}else{this._loadMenu(_1a7,_1a6,fct);}},_loadMenu:function(_1a9,_1aa,fct){var _1ab=dojo.hitch(this,function(data){this._onMenuLoaded(data,_1aa,_1a9,fct);});var _1ac=dojo.hitch(this,function(_1ad){this._onMenuLoadError(_1ad,_1aa,_1a9,fct);});this.maximo.loadMapTipItems(_1ab,_1ac);},_loadTemplate:function(_1ae,_1af,fct){var _1b0=dojo.hitch(this,function(data){this._onTemplateLoaded(data,_1af,_1ae,fct);});var _1b1=dojo.hitch(this,function(_1b2){this._onTemplateLoadError(_1b2,_1af,_1ae,fct);});this.maximo.loadMapTipTemplate(_1ae,_1b0,_1b1);},_onTemplateLoadError:function(_1b3,_1b4,_1b5,fct){_1b4.setInfoBubble("Error loading maptip "+_1b3);fct.apply(_1b4);},_onMenuLoadError:function(_1b6,_1b7,_1b8,fct){_1b7.setInfoBubble("Error loading maptipmenu "+_1b6);fct.apply(_1b7);},_onMenuLoaded:function(_1b9,_1ba,_1bb,fct){for(var _1bc in _1b9){var _1bd=_1b9[_1bc];this._updateMenu(_1bc,_1bd);}this._loadTemplate(_1bb,_1ba,fct);},_updateMenu:function(_1be,_1bf){var _1c0=ibm.tivoli.fwm.i18n.getMaxMsg("map","moredetailsaboutrecord");var _1c1=[{value:"noaction",label:_1c0,selected:true}];for(var _1c2 in _1bf){var _1c3={value:_1bf[_1c2],label:_1bf[_1c2].name};_1c3.itemData=_1bf[_1c2];_1c1.push(_1c3);}this._menuCache[_1be]=_1c1;},_isMenuLoaded:function(_1c4){return this._menuCache[_1c4]!=null;},_newSelect:function(_1c5,div,_1c6,_1c7){var _1c8;var _1c9=dojo.hitch(this,function(item){if("noaction"!=""+item){this.maximo.showMaximoDialog(item.dialogid,_1c6,_1c7,item.relationship);_1c8.reset();}});_1c8=new _190.form.Select({onChange:_1c9},div);_1c8.addOption(_1c5);_1c8.reset();_1c8.startup();if(navigator.userAgent.indexOf("Android")>-1){var _1ca="40px";_1c8.domNode.style.height=_1ca;var _1cb=_1c8.openDropDown;_1c8.openDropDown=function(){var _1cc=_1c8.dropDown.getChildren();_1cc.forEach(function(item){item.domNode.style.height=_1ca;});_1cb.apply(_1c8,arguments);};}},_getMenuData:function(_1cd){return this._menuCache[_1cd];},destroyRecursive:function(){this._templateCache={};}});});},"ibm/tivoli/fwm/mxmap/toolbar/ext/QueryUnassignedWorkDispatcherTool":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/toolbar/ext/QueryUnassignedWorkTool,dijit/form/Button"],function(_1ce,dojo,_1cf){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ext.QueryUnassignedWorkDispatcherTool");dojo.require("ibm.tivoli.fwm.mxmap.toolbar.ext.QueryUnassignedWorkTool");dojo.require("dijit.form.Button");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ext.QueryUnassignedWorkDispatcherTool",ibm.tivoli.fwm.mxmap.toolbar.ext.QueryUnassignedWorkTool,{constructor:function(_1d0){this.inherited(arguments);this.addSubscription(dojo.subscribe("onMapRefresh_"+this.map.getId(),dojo.hitch(this,this._onMapRefresh)));},executeOn:function(_1d1){var _1d2=this.map.getMapstraction().getBounds();this.map.getMaximo().queryUnassignedWorkDispatcher(_1d2,dojo.hitch(this,function(data){this.queryReturned(data,_1d1);}),dojo.hitch(this,this.cancelQuery));},_onMapRefresh:function(_1d3){if(this.isActive()==true){this.executeOff();if(!_1d3){_1d3={zoom:false,disableMsgs:false,automatic:false};}this.executeOn(_1d3);}}});});},"ibm/tivoli/fwm/mxmap/layers/LegendLayer":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_1d4,dojo,_1d5){dojo.provide("ibm.tivoli.fwm.mxmap.layers.LegendLayer");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.layers.LegendLayer",[ibm.tivoli.fwm.mxmap.layers.Layer],{symbol:null,minValue:null,maxValue:null,isDefault:false,init:function(){this._setRightIconURL();},toggleState:function(){},enable:function(){},disable:function(){},getSymbolURL:function(){var _1d6=null;if(this.symbol!=null){_1d6=this.symbol.url;}return _1d6;},getMinValue:function(){return this.minValue;},getMaxValue:function(){return this.maxValue;},isDefaultLegend:function(){return this.isDefault;},_setLeftIconURL:function(){},_setRightIconURL:function(){this._rightIconURL=this.getSymbolURL();}});});},"ibm/tivoli/fwm/mxmap/impl/MaximoSpatial":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/Map"],function(_1d7,dojo,_1d8){dojo.provide("ibm.tivoli.fwm.mxmap.impl.MaximoSpatial");dojo.require("ibm.tivoli.fwm.mxmap.Map");dojo.declare("ibm.tivoli.fwm.mxmap.impl.MaximoSpatial",ibm.tivoli.fwm.mxmap.Map,{constructor:function(_1d9){this.providerName="maximospatial";this._alreadyFixedStartingMboZoom=false;},allowsTrafficLayer:function(){return false;},_getCustomInitOptions:function(){if(this.customInitialMapOptions){return this.customInitialMapOptions.spatial;}log.info("no custom configuration");return {};},createMap:function(_1da){if(!_1da.mapConf.SPATIAL){console.error("no spatial conf");this.maximo=new ibm.tivoli.fwm.mxmap.MaximoIntegration(_1da);this.getMaximo().showMessage("mapcontrol","nospatialmapconf");}else{var _1db=_1da.mapConf.SPATIAL;if(_1db.bingMaps!=true&&_1db.openStreetMap!=true&&(_1db.mapservices==null||_1db.mapservices.length==0)){this.maximo=new ibm.tivoli.fwm.mxmap.MaximoIntegration(_1da);this.getMaximo().showMessage("plussmap","no_mapservices_configured");}else{this.inherited(arguments);}}},_getInitOptions:function(){var _1dc={route:this.mapConf.route,geocode:this.mapConf.geocode,initialExtent:this._getInitialLocation(),lastUserLocationData:this.userSessionManager.getLastUserLocation(),spatial:this.mapConf.SPATIAL,isMobile:this.isMobile,defaultLenUnit:this.getDefaultLengthUnit()};return _1dc;},_getDefaultInitialLocation:function(){return {};},getGeoCoderConf:function(){var _1dd={url:this.mapConf.geocode};return _1dd;},destroyMap:function(){try{var map=this.getMapstraction();if(typeof (map)!="undefined"&&map!=null){map.destroyMap();}}catch(e){console.error("cannot destroy spatial maps",e.message);}},_checkMapLoadedCorrectly:function(){var _1de=this.getMapstraction().getFailedLayers();if(_1de&&_1de.length>0){var _1df=[_1de[0].name,_1de[0].error.message];this.getMaximo().showMessage("plussmap","failed_loading_layer",_1df);}},centerOnMbo:function(_1e0,_1e1){var _1e2=this._isAutolocateBasedOnSpatial(_1e0);if(this._isBasedOnSpatial(_1e0)==true||_1e2==true){var fct=function(args){try{var _1e3=this._updateMboInfo(_1e0,args);this._centerOnPoint(_1e3,_1e1);}catch(e){console.error("No feature found to zoom over!",args,e);}};if(_1e2==true){this._queryMapsServiceForMboGeometry(_1e0.autolocate,dojo.hitch(this,fct));}else{this._queryMapsServiceForMboGeometry(_1e0,dojo.hitch(this,fct));}}else{this.inherited(arguments);}},_getLatLngFromFeature:function(_1e4){if(!_1e4){console.error("feature is empty",_1e4);return null;}var _1e5=_1e4.geometry;var _1e6=_1e4.geometry;if(_1e5.type!="point"){_1e6=_1e5.getExtent().getCenter();}var lng=_1e6.x;var lat=_1e6.y;var _1e6=new mxn.LatLonPoint(lat,lng);return _1e6;},_getMboObjectLayers:function(_1e7,_1e8){var conf=this.mapConf.SPATIAL;var _1e9=[];for(var i in conf.linkableInfo){var _1ea=conf.linkableInfo[i];for(var j in _1ea.layers){var _1eb=_1ea.layers[j];if(_1eb.parent==_1e7&&_1eb.child==_1e8){_1e9.push({url:_1ea.url+"/"+_1eb.layerId,layer:_1eb});}}}return _1e9;},_isBasedOnSpatial:function(_1ec){return (_1ec&&_1ec.gisdata&&_1ec.gisdata.PLUSSISGIS==true)||(_1ec&&_1ec.gisdata&&_1ec.gisdata.FROMFC==true);},_isAutolocateBasedOnSpatial:function(_1ed){if(this._isBasedOnSpatial(_1ed)==false){return this._isBasedOnSpatial(_1ed.autolocate);}return false;},getPointFromMboInfo:function(_1ee){var _1ef=this._getLatLngFromFeature(_1ee.FC);return _1ef;},_updateMboInfo:function(_1f0,_1f1,_1f2){if(dojo.config.fwm.debug==true){}if(_1f1.features&&_1f1.features[0]){var _1f3=_1f1.features[0];var _1f4=this._isAutolocateBasedOnSpatial(_1f0);if(dojo.config.fwm.debug==true){}if(_1f4==true){_1f0.autolocate.FC=_1f3;_1f0.autolocate.FROMFC=true;}else{_1f0.FC=_1f3;_1f0.FROMFC=true;}var _1f5=this._getLatLngFromFeature(_1f3);return _1f5;}else{console.error("no feature found!",_1f1);throw "no feature found!";}},addMboMarker:function(_1f6,_1f7,_1f8){var _1f9=this._isAutolocateBasedOnSpatial(_1f6);if(this._isBasedOnSpatial(_1f6)==true||_1f9==true){var fct=function(_1fa){try{var _1fb=this._updateMboInfo(_1f6,_1fa);this._createMarker(_1f6,_1f7,_1fb,_1f8);}catch(e){console.error("No feature found!",_1fa,e);}};if(_1f9==true){this._queryMapsServiceForMboGeometry(_1f6.autolocate,dojo.hitch(this,fct));}else{this._queryMapsServiceForMboGeometry(_1f6,dojo.hitch(this,fct));}}else{this.inherited(arguments);}},_getLayerMappingForMbo:function(_1fc){var _1fd=this._getMboObjectLayers(_1fc.mxdata.mboName,_1fc.mxdata.attributes.plussfeatureclass);if(!_1fd||_1fd.length==0){_1fd=this._getMboObjectLayers(_1fc.mxdata.extendsMboName,_1fc.mxdata.attributes.plussfeatureclass);if(!_1fd||_1fd.length==0){console.error("no layer mapping info for this mbo",_1fc.mxdata.extendsMboName,_1fc.mxdata.attributes.plussfeatureclass,_1fc);return;}}if(_1fd.length>1){console.warn("more than one layer mapping ",_1fc.mxdata.mboName,_1fc.mxdata.attributes.plussfeatureclass,_1fd);}return _1fd;},_queryMapsServiceForMboGeometry:function(_1fe,_1ff,_200){if(_1fe.FROMFC==true){_1ff({features:[_1fe.FC]});return;}var _201=this._getLayerMappingForMbo(_1fe);if(_201){this._getMBOGeometry(_201,[_1fe],_1ff,_200);}else{console.error("No layer info");if(_200){_200();}}},_checkIfAnyFeaturedClass:function(recs){for(var i in recs){var stop=recs[i];var _202=new ibm.tivoli.fwm.mxmap.MXRecord({mboInfo:stop,map:this.map});if(_202.hasSPATIALCoordinates()||(_202.hasGISCoordinates()==false&&_202.hasAutolocateSpatialData()==true)){return true;}}},showAllMboRecords:function(_203,_204,zoom){if(!_203||_203.length==0){return;}var _205=function(_206,_207){for(var _208 in _203){var _209=new ibm.tivoli.fwm.mxmap.MXRecord({mboInfo:_203[_208],map:this});if(_209.hasAnyGISCoordinates()==true){this.addMboToLayerManager(_203[_208],_204);}else{console.warn("Mbo with no GIS info ",_203[_208]);}}if(zoom==true){this.map.autoCenterAndZoom();}};if(this._checkIfAnyFeaturedClass(_203)==true){this.queryMultipleRecordsAtOnce(_203,dojo.hitch(this,_205),dojo.hitch(this,_205));}else{dojo.hitch(this,_205)([]);}},filterRecordsInMapView:function(_20a,_20b,_20c){var _20d=this.map.maps["maximospatial"];this.queryMultipleRecordsAtOnce(_20a,_20b,_20c,_20d.extent);},queryMultipleRecordsAtOnce:function(_20e,_20f,_210,_211){var _212={};var _213=0;for(var i=0;i<_20e.length;i++){var _214=_20e[i];var _215=this._isAutolocateBasedOnSpatial(_214);if(this._isBasedOnSpatial(_214)==true||_215==true){var _216=_214;if(_215==true){_216=_214.autolocate;}var _217=this._getLayerMappingForMbo(_216);if(!_217){console.error("No layer info");if(_210){_210();}return;}for(var j=0;j<_217.length;j++){if(_212[_217[j].url]==null){_213++;_212[_217[j].url]={info:_217[j],refMbos:[],mbos:[]};}_212[_217[j].url].refMbos.push(_216);_212[_217[j].url].mbos.push(_214);}}}var _218=[];var _219=[];var _21a=function(url,mbos,_21b){_213--;_218=_218.concat(mbos);_219.push({error:_21b,url:url});if(_213==0){_20f(_218,_219);}};for(var _21c in _212){this.queryAndCache(_21c,_212,dojo.hitch(this,_21a),_211);}},queryAndCache:function(_21d,_21e,_21f,_220){var _221=_21e[_21d].info;var _222=_221.layer.linkableColumns;var _223=_221.layer.mboColumns;var _224,_225;_224=new esri.tasks.QueryTask(_21d);_225=new esri.tasks.Query();_225.returnGeometry=true;if(_220!=null){_225.geometry=_220;}_225.spatialRelationship=esri.tasks.Query.SPATIAL_REL_CONTAINS;_225.outFields=["*"];_225.where=this._createWhereClause(_21e[_21d].refMbos,_222,_223);var fct=function(args){var _226=_21e[_21d].refMbos;var _227={};for(var ii in _222){for(var kk in args.fieldAliases){var _228=args.fieldAliases[kk];if(_228==_222[ii]){_227[_222[ii]]=kk;}else{if(kk==_222[ii]){_227[_222[ii]]=kk;}else{if(kk.search("."+_222[ii])!=-1){_227[_222[ii]]=kk;}}}}}var mbos=[];for(var l=0;l<args.features.length;l++){var _229=args.features[l];var mbo=this._getRefMboOfFeature(_226,_229.attributes,_222,_223,_227);if(!mbo){}var _22a=this._createWhereClause([mbo],_222,_223);var _22b={features:[_229]};this._updateQueryResultCache(_21d,_22a,_22b);mbos.push(mbo);mbo.FC=_229;mbo.FROMFC=true;}_21f(_21d,mbos);};var _22c=function(_22d){console.error("Error querying",_22d);_21f(_21d,[],_22d);};_224.execute(_225,dojo.hitch(this,fct),dojo.hitch(this,_22c));},_getRefMboOfFeature:function(_22e,_22f,_230,_231,_232){for(var k=0;k<_22e.length;k++){var m=_22e[k];var _233=false;for(var ii in _230){var _234=_230[ii];if(m.mxdata.attributes[_231[ii].toLowerCase()]==_22f[_232[_234]]){_233=true;}else{_233=false;break;}}if(_233==true){return m;}}},_getMBOGeometry:function(_235,_236,_237,_238,_239){if(!_239){_239=0;}var _23a=_235[_239].url;var _23b=_235[_239].layer.linkableColumns;var _23c=_235[_239].layer.mboColumns;var _23d,_23e;_23d=new esri.tasks.QueryTask(_23a);_23e=new esri.tasks.Query();_23e.returnGeometry=true;_23e.outFields=[];_23e.where=this._createWhereClause(_236,_23b,_23c);if(dojo.config.fwm.debug==true){}var _23f=_23e.where;if(this._isInCache(_23a,_23e.where)==true){_237(this._queryCache[_23a][_23e.where].results);return;}if(this._hasRequestedAlready(_23a,_23e.where)==true){this._updateRequestCache(_23a,_23e.where,_237,_238);return;}this._updateRequestCache(_23a,_23e.where,_237,_238);var fct=function(args){if(!args.features||!args.features[0]){_239++;if(_239<_235.length){this._getMBOGeometry(_235,mboInfo,_237,_238,_239);}else{var err={errormsg:"no feature found for '"+_23f+"' on "+_23a,details:{whereClause:_23f,layerURL:_23a,layerInfoData:_235}};this._triggerQueryResultError(_23a,_23f,args,err);}}else{this._updateQueryResultCache(_23a,_23f,args);while(this._queryRequestCache[_23a][_23f].reqs.length>0){if(dojo.config.fwm.debug==true){}var ff=this._queryRequestCache[_23a][_23f].reqs.pop();ff.success(args);}}};var _240=function(args){var err={errormsg:"Error querying for spatial feature class"};this._triggerQueryResultError(_23a,_23f,args,err);};_23d.execute(_23e,dojo.hitch(this,fct),dojo.hitch(this,_240));},_createWhereClause:function(_241,_242,_243){var _244="";for(var j=0;j<_241.length;j++){var _245=_241[j];var _246="";for(var i=0;i<_242.length;i++){var _247="'";var attr=_242[i];var _248=_245.mxdata.attributes[_243[i].toLowerCase()];if(isNaN(_248)){_248=_248.split("'").join("''");}if(_248.length==0){_246+=attr+" is null AND ";}else{if(isNaN(_248)){_246+=attr+"="+_247+_248+_247+" AND ";}else{_246+=attr+"="+_248+" AND ";}}}if(_246.length>0){_246=_246.substr(0,_246.length-5);if(_244.length>0){_244+=" OR ";}_244+="(";_244+=_246;_244+=")";}else{console.error("no matching attributes",_245,_242,_243);}}return _244;},_isInCache:function(_249,_24a){if(this._queryCache[_249]){if(this._queryCache[_249][_24a]){if((this._queryCache[_249][_24a]._timestamp-new Date().getTime())<this._expiringCache){this._queryCache[_249][_24a]._hitTimes++;return true;}else{this._queryCache[_249][_24a]=null;}}}return false;},_updateQueryResultCache:function(_24b,_24c,_24d){if(!this._queryCache[_24b]){this._queryCache[_24b]={};}this._queryCache[_24b][_24c]={results:_24d,_hitTimes:0,_timestamp:new Date().getTime()};},_hasRequestedAlready:function(_24e,_24f){if(this._queryRequestCache[_24e]&&this._queryRequestCache[_24e][_24f]!=null){return true;}return false;},_updateRequestCache:function(_250,_251,_252,_253){if(!this._queryRequestCache[_250]){this._queryRequestCache[_250]={};}if(!this._queryRequestCache[_250][_251]){this._queryRequestCache[_250][_251]={reqs:[]};}this._queryRequestCache[_250][_251].reqs.push({success:_252,error:_253});},_triggerQueryResultError:function(_254,_255,args,err){while(this._queryRequestCache[_254][_255].reqs.length>0){var ff=this._queryRequestCache[_254][_255].reqs.pop();if(ff.error){ff.error(err,args);}else{}}},_queryCache:{},_queryRequestCache:{},_expiringCache:30000,getInitialLocationCustomInfo:function(){var _256=this.map.maps["maximospatial"];return {extentData:{wkid:_256.spatialReference.wkid,wkt:_256.spatialReference.wkt,xmin:_256.extent.xmin,xmax:_256.extent.xmax,ymax:_256.extent.ymax,ymin:_256.extent.ymin}};},_setDefaultLocation:function(_257){var _258=this.map.maps["maximospatial"];if(_258.extentInitiallySet!=true){this.inherited(arguments);}},_resize:function(){if(!this.width){w="99%";}else{if(this.width.indexOf("%")>-1){var _259=parseInt(this.width.substr(0,this.width.length-1));if(_259>99){this.width="99%";}}}this.inherited(arguments);},_alreadyFixedStartingMboZoom:null,_zoomToCurrentMboRec:function(_25a){if(this._alreadyFixedStartingMboZoom!=true){var _25b;var _25c=0;var fct=dojo.hitch(this,function(){_25c++;if(this.map.state.updating!=true||_25c>100){this.currentRecordMgr.centerAndZoom(_25a.level);}else{setTimeout(fct,300);}dojo.unsubscribe(_25b);});var h2;var _25d=dojo.hitch(this,function(){dojo.unsubscribe(h2);_25b=dojo.subscribe("onESRIReposition",fct);});h2=dojo.subscribe(this.events.mapLoaded,_25d);}this.inherited(arguments);}});});},"dojo/parser":function(){define("dojo/parser",["./_base/kernel","./_base/lang","./_base/array","./_base/html","./_base/window","./_base/url","./_base/json","./aspect","./date/stamp","./query","./on","./ready"],function(dojo,_25e,_25f,_260,_261,_262,_263,_264,_265,_266,don){new Date("X");var _267={"dom-attributes-explicit":document.createElement("div").attributes.length<40};function has(_268){return _267[_268];};dojo.parser=new function(){var _269={};function _26a(_26b){var map={};for(var name in _26b){if(name.charAt(0)=="_"){continue;}map[name.toLowerCase()]=name;}return map;};_264.after(_25e,"extend",function(){_269={};},true);var _26c={};this._functionFromScript=function(_26d,_26e){var _26f="";var _270="";var _271=(_26d.getAttribute(_26e+"args")||_26d.getAttribute("args"));if(_271){_25f.forEach(_271.split(/\s*,\s*/),function(part,idx){_26f+="var "+part+" = arguments["+idx+"]; ";});}var _272=_26d.getAttribute("with");if(_272&&_272.length){_25f.forEach(_272.split(/\s*,\s*/),function(part){_26f+="with("+part+"){";_270+="}";});}return new Function(_26f+_26d.innerHTML+_270);};this.instantiate=function(_273,_274,args){var _275=[],_274=_274||{};args=args||{};var _276=(args.scope||dojo._scopeName)+"Type",_277="data-"+(args.scope||dojo._scopeName)+"-",_278=_277+"type",_279=_277+"props",_27a=_277+"attach-point",_27b=_277+"attach-event",_27c=_277+"id";var _27d={};_25f.forEach([_279,_278,_276,_27c,"jsId",_27a,_27b,"dojoAttachPoint","dojoAttachEvent","class","style"],function(name){_27d[name.toLowerCase()]=name.replace(args.scope,"dojo");});_25f.forEach(_273,function(obj){if(!obj){return;}var node=obj.node||obj,type=_276 in _274?_274[_276]:obj.node?obj.type:(node.getAttribute(_278)||node.getAttribute(_276)),ctor=_26c[type]||(_26c[type]=_25e.getObject(type)),_27e=ctor&&ctor.prototype;if(!ctor){throw new Error("Could not load class '"+type);}var _27f={};if(args.defaults){_25e.mixin(_27f,args.defaults);}if(obj.inherited){_25e.mixin(_27f,obj.inherited);}var _280;if(has("dom-attributes-explicit")){_280=node.attributes;}else{var _281=/^input$|^img$/i.test(node.nodeName)?node:node.cloneNode(false),_282=_281.outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*/,"").replace(/>.*$/,"");_280=_25f.map(_282.split(/\s+/),function(name){var _283=name.toLowerCase();return {name:name,value:(node.nodeName=="LI"&&name=="value")||_283=="enctype"?node.getAttribute(_283):node.getAttributeNode(_283).value,specified:true};});}var i=0,item;while(item=_280[i++]){if(!item||!item.specified){continue;}var name=item.name,_284=name.toLowerCase(),_285=item.value;if(_284 in _27d){switch(_27d[_284]){case "data-dojo-props":var _286=_285;break;case "data-dojo-id":case "jsId":var _287=_285;break;case "data-dojo-attach-point":case "dojoAttachPoint":_27f.dojoAttachPoint=_285;break;case "data-dojo-attach-event":case "dojoAttachEvent":_27f.dojoAttachEvent=_285;break;case "class":_27f["class"]=node.className;break;case "style":_27f["style"]=node.style&&node.style.cssText;break;}}else{if(!(name in _27e)){var map=(_269[type]||(_269[type]=_26a(_27e)));name=map[_284]||name;}if(name in _27e){switch(typeof _27e[name]){case "string":_27f[name]=_285;break;case "number":_27f[name]=_285.length?Number(_285):NaN;break;case "boolean":_27f[name]=_285.toLowerCase()!="false";break;case "function":if(_285===""||_285.search(/[^\w\.]+/i)!=-1){_27f[name]=new Function(_285);}else{_27f[name]=_25e.getObject(_285,false)||new Function(_285);}break;default:var pVal=_27e[name];_27f[name]=(pVal&&"length" in pVal)?(_285?_285.split(/\s*,\s*/):[]):(pVal instanceof Date)?(_285==""?new Date(""):_285=="now"?new Date():_265.fromISOString(_285)):(pVal instanceof dojo._Url)?(dojo.baseUrl+_285):_263.fromJson(_285);}}else{_27f[name]=_285;}}}if(_286){try{_286=_263.fromJson.call(args.propsThis,"{"+_286+"}");_25e.mixin(_27f,_286);}catch(e){throw new Error(e.toString()+" in data-dojo-props='"+_286+"'");}}_25e.mixin(_27f,_274);var _288=obj.node?obj.scripts:(ctor&&(ctor._noScript||_27e._noScript)?[]:_266("> script[type^='dojo/']",node));var _289=[],_28a=[],_28b=[],on=[];if(_288){for(i=0;i<_288.length;i++){var _28c=_288[i];node.removeChild(_28c);var _28d=(_28c.getAttribute(_277+"event")||_28c.getAttribute("event")),prop=_28c.getAttribute(_277+"prop"),type=_28c.getAttribute("type"),nf=this._functionFromScript(_28c,_277);if(_28d){if(type=="dojo/connect"){_289.push({event:_28d,func:nf});}else{if(type=="dojo/on"){on.push({event:_28d,func:nf});}else{_27f[_28d]=nf;}}}else{if(type=="dojo/watch"){_28b.push({prop:prop,func:nf});}else{_28a.push(nf);}}}}var _28e=ctor.markupFactory||_27e.markupFactory;var _28f=_28e?_28e(_27f,node,ctor):new ctor(_27f,node);_275.push(_28f);if(_287){_25e.setObject(_287,_28f);}for(i=0;i<_289.length;i++){_264.after(_28f,_289[i].event,dojo.hitch(_28f,_289[i].func),true);}for(i=0;i<_28a.length;i++){_28a[i].call(_28f);}for(i=0;i<_28b.length;i++){_28f.watch(_28b[i].prop,_28b[i].func);}for(i=0;i<on.length;i++){don(_28f,on[i].event,on[i].func);}},this);if(!_274._started){_25f.forEach(_275,function(_290){if(!args.noStart&&_290&&_25e.isFunction(_290.startup)&&!_290._started){_290.startup();}});}return _275;};this.parse=function(_291,args){var root;if(!args&&_291&&_291.rootNode){args=_291;root=args.rootNode;}else{root=_291;}root=root?_260.byId(root):_261.body();args=args||{};var _292=(args.scope||dojo._scopeName)+"Type",_293="data-"+(args.scope||dojo._scopeName)+"-",_294=_293+"type",_295=_293+"textdir";var list=[];var node=root.firstChild;var _296=args&&args.inherited;if(!_296){function _297(node,attr){return (node.getAttribute&&node.getAttribute(attr))||(node!==_261.doc&&node!==_261.doc.documentElement&&node.parentNode?_297(node.parentNode,attr):null);};_296={dir:_297(root,"dir"),lang:_297(root,"lang"),textDir:_297(root,_295)};for(var key in _296){if(!_296[key]){delete _296[key];}}}var _298={inherited:_296};var _299;var _29a;function _29b(_29c){if(!_29c.inherited){_29c.inherited={};var node=_29c.node,_29d=_29b(_29c.parent);var _29e={dir:node.getAttribute("dir")||_29d.dir,lang:node.getAttribute("lang")||_29d.lang,textDir:node.getAttribute(_295)||_29d.textDir};for(var key in _29e){if(_29e[key]){_29c.inherited[key]=_29e[key];}}}return _29c.inherited;};while(true){if(!node){if(!_298||!_298.node){break;}node=_298.node.nextSibling;_299=_298.scripts;_29a=false;_298=_298.parent;continue;}if(node.nodeType!=1){node=node.nextSibling;continue;}if(_299&&node.nodeName.toLowerCase()=="script"){type=node.getAttribute("type");if(type&&/^dojo\/\w/i.test(type)){_299.push(node);}node=node.nextSibling;continue;}if(_29a){node=node.nextSibling;continue;}var type=node.getAttribute(_294)||node.getAttribute(_292);var _29f=node.firstChild;if(!type&&(!_29f||(_29f.nodeType==3&&!_29f.nextSibling))){node=node.nextSibling;continue;}var _2a0={node:node,scripts:_299,parent:_298};var ctor=type&&(_26c[type]||(_26c[type]=_25e.getObject(type))),_2a1=ctor&&!ctor.prototype._noScript?[]:null;if(type){list.push({"type":type,node:node,scripts:_2a1,inherited:_29b(_2a0)});}node=_29f;_299=_2a1;_29a=ctor&&ctor.prototype.stopParser&&!(args&&args.template);_298=_2a0;}var _2a2=args&&args.template?{template:true}:null;return this.instantiate(list,_2a2,args);};}();if(dojo.config.parseOnLoad){dojo.ready(100,dojo.parser,"parse");}return dojo.parser;});},"url:dijit/form/templates/DropDownButton.html":"<span class=\"dijit dijitReset dijitInline\"\n\t><span class='dijitReset dijitInline dijitButtonNode'\n\t\tdata-dojo-attach-event=\"ondijitclick:_onClick\" data-dojo-attach-point=\"_buttonNode\"\n\t\t><span class=\"dijitReset dijitStretch dijitButtonContents\"\n\t\t\tdata-dojo-attach-point=\"focusNode,titleNode,_arrowWrapperNode\"\n\t\t\trole=\"button\" aria-haspopup=\"true\" aria-labelledby=\"${id}_label\"\n\t\t\t><span class=\"dijitReset dijitInline dijitIcon\"\n\t\t\t\tdata-dojo-attach-point=\"iconNode\"\n\t\t\t></span\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"\n\t\t\t\tdata-dojo-attach-point=\"containerNode,_popupStateNode\"\n\t\t\t\tid=\"${id}_label\"\n\t\t\t></span\n\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonInner\"></span\n\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonChar\">&#9660;</span\n\t\t></span\n\t></span\n\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" class=\"dijitOffScreen\" tabIndex=\"-1\"\n\t\tdata-dojo-attach-point=\"valueNode\"\n/></span>\n","dijit/form/ToggleButton":function(){define("dijit/form/ToggleButton",["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(_2a3,_2a4,_2a5,_2a6){return _2a3("dijit.form.ToggleButton",[_2a5,_2a6],{baseClass:"dijitToggleButton",setChecked:function(_2a7){_2a4.deprecated("setChecked("+_2a7+") is deprecated. Use set('checked',"+_2a7+") instead.","","2.0");this.set("checked",_2a7);}});});},"dojo/date/stamp":function(){define("dojo/date/stamp",["../_base/kernel","../_base/lang","../_base/array"],function(dojo,lang,_2a8){lang.getObject("date.stamp",true,dojo);dojo.date.stamp.fromISOString=function(_2a9,_2aa){if(!dojo.date.stamp._isoRegExp){dojo.date.stamp._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;}var _2ab=dojo.date.stamp._isoRegExp.exec(_2a9),_2ac=null;if(_2ab){_2ab.shift();if(_2ab[1]){_2ab[1]--;}if(_2ab[6]){_2ab[6]*=1000;}if(_2aa){_2aa=new Date(_2aa);_2a8.forEach(_2a8.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(prop){return _2aa["get"+prop]();}),function(_2ad,_2ae){_2ab[_2ae]=_2ab[_2ae]||_2ad;});}_2ac=new Date(_2ab[0]||1970,_2ab[1]||0,_2ab[2]||1,_2ab[3]||0,_2ab[4]||0,_2ab[5]||0,_2ab[6]||0);if(_2ab[0]<100){_2ac.setFullYear(_2ab[0]||1970);}var _2af=0,_2b0=_2ab[7]&&_2ab[7].charAt(0);if(_2b0!="Z"){_2af=((_2ab[8]||0)*60)+(Number(_2ab[9])||0);if(_2b0!="-"){_2af*=-1;}}if(_2b0){_2af-=_2ac.getTimezoneOffset();}if(_2af){_2ac.setTime(_2ac.getTime()+_2af*60000);}}return _2ac;};dojo.date.stamp.toISOString=function(_2b1,_2b2){var _2b3=function(n){return (n<10)?"0"+n:n;};_2b2=_2b2||{};var _2b4=[],_2b5=_2b2.zulu?"getUTC":"get",date="";if(_2b2.selector!="time"){var year=_2b1[_2b5+"FullYear"]();date=["0000".substr((year+"").length)+year,_2b3(_2b1[_2b5+"Month"]()+1),_2b3(_2b1[_2b5+"Date"]())].join("-");}_2b4.push(date);if(_2b2.selector!="date"){var time=[_2b3(_2b1[_2b5+"Hours"]()),_2b3(_2b1[_2b5+"Minutes"]()),_2b3(_2b1[_2b5+"Seconds"]())].join(":");var _2b6=_2b1[_2b5+"Milliseconds"]();if(_2b2.milliseconds){time+="."+(_2b6<100?"0":"")+_2b3(_2b6);}if(_2b2.zulu){time+="Z";}else{if(_2b2.selector!="time"){var _2b7=_2b1.getTimezoneOffset();var _2b8=Math.abs(_2b7);time+=(_2b7>0?"-":"+")+_2b3(Math.floor(_2b8/60))+":"+_2b3(_2b8%60);}}_2b4.push(time);}return _2b4.join("T");};return dojo.date.stamp;});},"dojo/Stateful":function(){define("dojo/Stateful",["./_base/kernel","./_base/declare","./_base/lang","./_base/array"],function(dojo,_2b9,lang,_2ba){return dojo.declare("dojo.Stateful",null,{postscript:function(_2bb){if(_2bb){lang.mixin(this,_2bb);}},get:function(name){return this[name];},set:function(name,_2bc){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _2bd=this[name];this[name]=_2bc;if(this._watchCallbacks){this._watchCallbacks(name,_2bd,_2bc);}return this;},watch:function(name,_2be){var _2bf=this._watchCallbacks;if(!_2bf){var self=this;_2bf=this._watchCallbacks=function(name,_2c0,_2c1,_2c2){var _2c3=function(_2c4){if(_2c4){_2c4=_2c4.slice();for(var i=0,l=_2c4.length;i<l;i++){try{_2c4[i].call(self,name,_2c0,_2c1);}catch(e){console.error(e);}}}};_2c3(_2bf["_"+name]);if(!_2c2){_2c3(_2bf["*"]);}};}if(!_2be&&typeof name==="function"){_2be=name;name="*";}else{name="_"+name;}var _2c5=_2bf[name];if(typeof _2c5!=="object"){_2c5=_2bf[name]=[];}_2c5.push(_2be);return {unwatch:function(){_2c5.splice(_2ba.indexOf(_2c5,_2be),1);}};}});});},"dijit/form/ComboButton":function(){require({cache:{"url:dijit/form/templates/ComboButton.html":"<table class=\"dijit dijitReset dijitInline dijitLeft\"\n\tcellspacing='0' cellpadding='0' role=\"presentation\"\n\t><tbody role=\"presentation\"><tr role=\"presentation\"\n\t\t><td class=\"dijitReset dijitStretch dijitButtonNode\" data-dojo-attach-point=\"buttonNode\" data-dojo-attach-event=\"ondijitclick:_onClick,onkeypress:_onButtonKeyPress\"\n\t\t><div id=\"${id}_button\" class=\"dijitReset dijitButtonContents\"\n\t\t\tdata-dojo-attach-point=\"titleNode\"\n\t\t\trole=\"button\" aria-labelledby=\"${id}_label\"\n\t\t\t><div class=\"dijitReset dijitInline dijitIcon\" data-dojo-attach-point=\"iconNode\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitInline dijitButtonText\" id=\"${id}_label\" data-dojo-attach-point=\"containerNode\" role=\"presentation\"></div\n\t\t></div\n\t\t></td\n\t\t><td id=\"${id}_arrow\" class='dijitReset dijitRight dijitButtonNode dijitArrowButton'\n\t\t\tdata-dojo-attach-point=\"_popupStateNode,focusNode,_buttonNode\"\n\t\t\tdata-dojo-attach-event=\"onkeypress:_onArrowKeyPress\"\n\t\t\ttitle=\"${optionsTitle}\"\n\t\t\trole=\"button\" aria-haspopup=\"true\"\n\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" role=\"presentation\">&#9660;</div\n\t\t></td\n\t\t><td style=\"display:none !important;\"\n\t\t\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" data-dojo-attach-point=\"valueNode\"\n\t\t/></td></tr></tbody\n></table>\n"}});define("dijit/form/ComboButton",["dojo/_base/declare","dojo/_base/event","dojo/keys","../focus","./DropDownButton","dojo/text!./templates/ComboButton.html"],function(_2c6,_2c7,keys,_2c8,_2c9,_2ca){return _2c6("dijit.form.ComboButton",_2c9,{templateString:_2ca,_setIdAttr:"",_setTabIndexAttr:["focusNode","titleNode"],_setTitleAttr:"titleNode",optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{"buttonNode":"dijitButtonNode","titleNode":"dijitButtonContents","_popupStateNode":"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyPress:function(evt){if(evt.charOrCode==keys[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]){_2c8.focus(this._popupStateNode);_2c7.stop(evt);}},_onArrowKeyPress:function(evt){if(evt.charOrCode==keys[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]){_2c8.focus(this.titleNode);_2c7.stop(evt);}},focus:function(_2cb){if(!this.disabled){_2c8.focus(_2cb=="start"?this.titleNode:this._popupStateNode);}}});});},"ibm/tivoli/fwm/mxmap/helpers/MapMarkersRefresher":function(){define(["dijit","dojo","dojox","dojo/require!dojox/timing/_base"],function(_2cc,dojo,_2cd){dojo.require("dojox.timing._base");dojo.provide("ibm.tivoli.fwm.mxmap.helpers.MapMarkersRefresher");dojo.declare("ibm.tivoli.fwm.mxmap.helpers.MapMarkersRefresher",ibm.tivoli.fwm.mxmap._Base,{maximo:null,interval:0,_timer:null,_signalCounter:0,map:null,constructor:function(_2ce){dojo.mixin(this,_2ce);this.addSubscription(dojo.subscribe("startedUserInteractionOnMap_"+this.map.getId(),dojo.hitch(this,this.disableMapRefresh)));this.addSubscription(dojo.subscribe("endedUserInteractionOnMap_"+this.map.getId(),dojo.hitch(this,this.checkToEnableMapRefresh)));this._signalCounter=0;},start:function(){if(this._timer==null){if(this.interval>0){this._doStart();}else{}}else{}},disableMapRefresh:function(e){this._signalCounter=this._signalCounter+1;},checkToEnableMapRefresh:function(e){this._signalCounter=this._signalCounter-1;if(this._signalCounter<=0){this._signalCounter=0;}},stop:function(){if(this._timer==null){}else{this._timer.stop();this._timer=null;}},_doStart:function(){var that=this;this._timer=new _2cd.timing.Timer(this.interval*1000);this._timer.onTick=function(){if(that._signalCounter==0){that.map.autoRefreshMap();}else{}};this._timer.onStart=function(){};this._timer.onStop=function(){};this._timer.start();},getMaximo:function(){return this.maximo;},destroyRecursive:function(){this.stop();this.inherited(arguments);}});});},"dijit/_base/window":function(){define("dijit/_base/window",["dojo/window",".."],function(_2cf,_2d0){_2d0.getDocumentWindow=function(doc){return _2cf.get(doc);};});},"dijit/PopupMenuItem":function(){define("dijit/PopupMenuItem",["dojo/_base/declare","dojo/dom-style","dojo/query","dojo/_base/window","./registry","./MenuItem","./hccss"],function(_2d1,_2d2,_2d3,win,_2d4,_2d5){return _2d1("dijit.PopupMenuItem",_2d5,{_fillContent:function(){if(this.srcNodeRef){var _2d6=_2d3("*",this.srcNodeRef);this.inherited(arguments,[_2d6[0]]);this.dropDownContainer=this.srcNodeRef;}},startup:function(){if(this._started){return;}this.inherited(arguments);if(!this.popup){var node=_2d3("[widgetId]",this.dropDownContainer)[0];this.popup=_2d4.byNode(node);}win.body().appendChild(this.popup.domNode);this.popup.startup();this.popup.domNode.style.display="none";if(this.arrowWrapper){_2d2.set(this.arrowWrapper,"visibility","");}this.focusNode.setAttribute("aria-haspopup","true");},destroyDescendants:function(_2d7){if(this.popup){if(!this.popup._destroyed){this.popup.destroyRecursive(_2d7);}delete this.popup;}this.inherited(arguments);}});});},"ibm/tivoli/fwm/mxmap/dispatcher/DispatcherManager":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/routing/MultipleRoutesManager,ibm/tivoli/fwm/mxmap/ImageLibraryManager"],function(_2d8,dojo,_2d9){dojo.provide("ibm.tivoli.fwm.mxmap.dispatcher.DispatcherManager");dojo.require("ibm.tivoli.fwm.mxmap.routing.MultipleRoutesManager");dojo.require("ibm.tivoli.fwm.mxmap.ImageLibraryManager");dojo.declare("ibm.tivoli.fwm.mxmap.dispatcher.DispatcherManager",ibm.tivoli.fwm.mxmap._Base,{map:null,_needsModelRefresh:false,applet:null,routeCache:null,routeManager:null,_calculatingRoutes:false,_callBuffer:[],_totalRequested:0,_totalCompleted:0,travelTimeToSave:[],errorCodes:null,_updateProjTries:10,constructor:function(_2da){dojo.mixin(this,_2da);this.map.registerDatasourceRefresh(dojo.hitch(this,this.refreshDS));this._executionOptions={};this.routeManager=this.map.routeManager;this.addSubscription(dojo.subscribe("onWorkAssigned_"+this.map.getId(),dojo.hitch(this,this.onWorkAssigned)));this.routeCache={};this._calculatingRoutes=false;this._callBuffer=[];this._needsModelRefresh=false;this.errorCodes=[];this._totalRequested=0;this._totalCompleted=0;this.travelTimeToSave=[];this._updateProjTries=10;},init:function(){var _2db=ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager().getDefaultWorkOrderMarkerImageInfo();var _2dc={"id":"resource","labelGroup":"map","labelKey":"resourcesymbologylabel","legendTitleGroup":"map","legendTitleKey":"workorderresourcelegendtitle","type":"dynamic","legends":[{"id":"fwm_default","labelGroup":"map","labelKey":"defaultlayerlabel","symbol":{"url":_2db.getImageURL(),"color":"","offsetx":_2db.getImageAnchor()[0],"offsety":_2db.getImageAnchor()[1],"width":_2db.getImageSize()[0],"height":_2db.getImageSize()[1]},"isDefault":true}]};var _2dd=this.map.layersManager.getLayerForObjectName("WORKORDER");this.routeLayer=_2dd.createNewChildLayer({layerName:ibm.tivoli.fwm.i18n.getMaxMsg("map","resourcesymbologylabel"),layerId:_2dc.id,layerConf:_2dc,map:this.map,layerType:ibm.tivoli.fwm.mxmap.layers.LayerType.SYMBOLOGY,symbologyType:_2dc.type,childrenTitle:""});this.routeLayer.toggleState();},clearAllCurrentRoutes:function(){this.data={};this.routeManager.clearAll();this.routeCache={};},drawAllRoutes:function(_2de,_2df,_2e0){this.resetMaximoTimer();if(this._calculatingRoutes==false){this.travelTimeToSave=[];this.errorCodes=[];}this._loadedData(_2de);},_triggerBufferedCalls:function(){if(this._callBuffer.length>0){this._loadedData(this._callBuffer.pop());}},_loadedData:function(data){if(!window.ccc){window.ccc=0;}data.id=window.ccc++;if(this._calculatingRoutes==true){var _2e1=this._callBuffer[0];if(_2e1&&_2e1.options){if(_2e1.options.hasErrCallback==true){this._refreshInfo.errorCb();}else{if(_2e1.options.hasCallback==true){this._refreshInfo.callback();}}}this._callBuffer[0]=(data);}else{var _2e2=data.allRoutes;this._totalRequested=_2e2.length;this.data=data;if(this._totalRequested>0){this._startTime=new Date().getTime();this._calculatingRoutes=true;this._needsModelRefresh=false;if(dojo.config.fwm.debug==true){}this._totalCompleted=0;for(var id in _2e2){var _2e3=_2e2[id];this._addRoute(id,_2e3);}}else{this.allSLRRequestsComplete();}}},__debugAddStopToMap:function(_2e4){var _2e5=new mxn.LatLonPoint(_2e4.lat,_2e4.lng);this.map.getMapstraction().addMarker(new mxn.Marker(_2e5));},_addRoute:function(id,_2e6){var _2e7=_2e6.color;if(_2e7.substring(0,1)!="#"){_2e7="#"+_2e7;}var _2e8=[];var cf=this.map.routeConf;cf.routecolor=_2e7;_2e8=_2e6.stops;var _2e9=_2e6;if(_2e6.noroute!=true&&_2e8.length>1){var _2ea=function(_2eb){if(this.routeCache[_2e9.resource.id]){this.routeCache[_2e9.resource.id].clear();}this.routeCache[_2e9.resource.id]=_2eb;this.completeRoute(_2eb,_2e9);};var _2ec=function(_2ed,msg){this._totalCompleted++;this.onError(_2ed,_2e9,msg);if(this.routeCache[_2e6.resource.id]){this.routeCache[_2e6.resource.id].clear();this.routeCache[_2e6.resource.id]=null;}if(this._totalCompleted==this._totalRequested){this.allSLRRequestsComplete();}};this.routeManager.createRoute(_2e8,cf,dojo.hitch(this,_2ea),dojo.hitch(this,_2ec),true);}else{this._totalCompleted++;if(_2e6.noroute==true){if(dojo.config.fwm.debug==true){}}else{this.onError("MIN_STOPS_REQ",_2e9);}if(this.routeCache[_2e6.resource.id]){this.routeCache[_2e6.resource.id].clear();this.routeCache[_2e6.resource.id]=null;}if(this._totalCompleted==this._totalRequested){this.allSLRRequestsComplete();}}},completeRoute:function(_2ee,_2ef){if(dojo.config.fwm.debug==true){}this._totalCompleted++;for(var j in _2ef.stops){var item=_2ef.stops[j];if(j>0){var _2f0=_2ee.itinerary.legs[j-1];var _2f1=item.routedata;if(_2f1==null){console.error("Assignment ",item," with no route data info");continue;}if(_2f1.HASTRAVELTIME==false){if(_2f0){var _2f2=this.convertDurationToSeconds(_2f0.durationToLeg);if(_2f2){var _2f3={ASSIGNMENTID:_2f1.ASSIGNMENTID,SLROUTEID:_2f1.SLROUTEID,FROMLOCATIONSID:_2f1.FROMLOCATIONSID,TOLOCATIONSID:_2f1.TOLOCATIONSID,FROMASSIGNMENT:_2f1.FROMASSIGNMENT,TRAVELTIME_SECS:_2f2};this.travelTimeToSave.push(_2f3);this._needsModelRefresh=true;}}}}}if(this._totalCompleted==this._totalRequested){this.allSLRRequestsComplete();}},convertDurationToSeconds:function(_2f4){return Math.round(_2f4*60);},onError:function(_2f5,_2f6,msg){console.warn("Failed to draw route",_2f5);this.errorCodes.push({errorInfo:{code:_2f5,msg:msg},routeInfo:_2f6});},_saveBulkOfSLRTravelTime:function(){var _2f7=function(_2f8){this._handleServerData(_2f8,"onSLRTravelTimeUpdated");};var _2f9=new Event("SAVEBULKTRAVELTIME","mapdispatcher-mxdispatcherctrl",this.travelTimeToSave,REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_2f9,"application/json","json",dojo.hitch(this,_2f7),dojo.hitch(this,this.genericError));},_saveSLRTravelTime:function(_2fa){var _2fb=function(data){};var _2fc=new Event("SAVETRAVELTIME","mapdispatcher-mxdispatcherctrl",_2fa,REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_2fc,"application/json","json",_2fb,this.genericError);},sendActionToServer:function(p,_2fd,_2fe){var _2ff=p.servermethod;var _300=p.serverparams;if(dojo.config.fwm.debug==true){}var _301=function(data){this._handleServerData(data,_2fd,_2fe);};var _302=new Event(_2ff,"mapdispatcher-mxdispatcherctrl",_300,REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_302,"application/json","json",dojo.hitch(this,_301),dojo.hitch(this,_301));},allSLRRequestsComplete:function(){this._calculatingRoutes=false;if(this._callBuffer.length>0){this.handleExecutionFinished();this._triggerBufferedCalls();}else{if(!this.data.options||this.data.options.noZoom!=true){this.routeManager.zoomAndCenterOverAll();}var _303=new Date().getTime();if(this.travelTimeToSave!=null&&this.travelTimeToSave.length>0){this._saveBulkOfSLRTravelTime();}if(this.map){if(this.errorCodes!=null&&this.errorCodes.length>0){var _304=function(data){this.triggerMsgs();this.handleExecutionFinished();};var _305=new Event("SHOWMULTIPLEROUTEERRORS","mapdispatcher-mxdispatcherctrl",this.errorCodes,REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_305,"application/json","json",dojo.hitch(this,_304),dojo.hitch(this,_304));}else{this.handleExecutionFinished();}}}},handleExecutionFinished:function(){if(this.data.options&&this.data.options.hasCallback==true){this._refreshInfo.callback(this.routeManager);}},genericError:function(_306){this._calculatingRoutes=false;this.triggerMsgs();console.error("Error ",_306);},_handleServerData:function(data,_307,_308){if(data&&data.result=="failed"){console.warn("there was an error on server",data);if(data.mxerror==true){this.triggerMsgs();}if(_308){this.getApplet().jsCallback(_308,dojo.toJson(data));}}else{this.getApplet().jsCallback(_307,dojo.toJson(data));}},bulkAssignmentsUpdates:function(_309){var _30a=function(data){this._handleServerData(data,"onBulkAssignments");};var _30b=new Event("UPDATEASSIGNMENTS","mapdispatcher-mxdispatcherctrl",_309,REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_30b,"application/json","json",dojo.hitch(this,_30a),dojo.hitch(this,this.genericError));this.resetMaximoTimer();},updateProject:function(_30c){if(!this.getApplet()){this._updateProjTries--;if(this._updateProjTries<=0){this._updateProjTries=10;console.error("Can't find the applet or it's not loaded!");}else{var fct=function(){this.updateProject(_30c);};setTimeout(dojo.hitch(this,fct),1000);}}this._updateProjTries=10;this.getApplet().updateProjId(_30c);this.resetMaximoTimer();},triggerMsgs:function(){sendEvent("TRIGGERMSGS","mapdispatcher-mxdispatcherctrl");this.resetMaximoTimer();},getApplet:function(){try{this.applet.isLoaded();return this.applet;}catch(e){this.applet=dojo.byId("CalendarViewId");try{this.applet.isLoaded();return this.applet;}catch(e2){this.applet=window.CalendarViewId;try{this.applet.isLoaded();return this.applet;}catch(e3){console.warn("can't find applet to start communication",e3);}}}},refresh:function(){this.getApplet().updateModel();},_refreshInfo:null,refreshDS:function(_30d,_30e,_30f){this._refreshInfo={callback:_30d,errorCb:_30e};var _310={noZoom:_30f,refreshMap:true,hasCallback:false,hasErrCallback:false};if(_30d){_310.hasCallback=true;}if(_30d){_310.hasErrCallback=true;}this.getApplet().updateModelWithOptions(dojo.toJson(_310));},onWorkAssigned:function(){this.getApplet().updateModel();},resetMaximoTimer:function(){resetLogoutTimer(false);}});});},"dijit/form/RadioButton":function(){define("dijit/form/RadioButton",["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(_311,_312,_313){return _311("dijit.form.RadioButton",[_312,_313],{baseClass:"dijitRadio"});});},"ibm/tivoli/fwm/mxmap/toolbar/ext/MobileInfoPanel":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/form/Button,ibm/tivoli/fwm/mxmap/panels/MobileInfoPanelDialog"],function(_314,dojo,_315){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ext.MobileInfoPanel");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("dijit.form.Button");dojo.require("ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ext.MobileInfoPanel",ibm.tivoli.fwm.mxmap._Base,{label:"Info Panel",iconClass:"basicMapToolbarBtn",map:null,_dialog:null,constructor:function(_316){dojo.mixin(this,_316);this._dialog=null;var _317=ibm.tivoli.fwm.i18n.getMaxMsg("map","infopanel");this.label=_317||this.label;},createToolbarButton:function(){var _318=new _314.form.Button({label:this.label,showLabel:true,iconClass:this.iconClass,onClick:dojo.hitch(this,function(){this.execute();})});return _318;},execute:function(){if(this._dialog){this._dialog.close();this._dialog=null;}var me=this;this._dialog=new ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog({map:me.map});this._dialog.show();},disable:function(){},destroy:function(){this.destroyRecursive();}});});},"dijit/main":function(){define("dijit/main",["dojo/_base/kernel"],function(dojo){return dojo.dijit;});},"ibm/tivoli/fwm/mxmap/geolocation/MyCurrentLocation":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_319,dojo,_31a){dojo.provide("ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation");dojo.require("ibm.tivoli.fwm.mxmap._Base");ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus={UNASSIGNED:-1,HAS_LOCATION:0,PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2,GEOLOCATION_NOT_SUPPORTED:4,TIMEOUT:3};ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation._instance=null;dojo.declare("ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation",ibm.tivoli.fwm.mxmap._Base,{_userLocation:null,_userLocationStatus:ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.UNASSIGNED,_timeout:5000,_watchPositionId:null,_waitingForTimeout:false,_callbackArray:null,_listenerArray:null,constructor:function(_31b){dojo.mixin(this,_31b);this._callbackArray=[];this._listenerArray=[];this._h=0;if(dojo.isMozilla){this._oldTimeout=this._timeout;this._timeout=10*60000;}},getPosition:function(){return this._userLocation;},getStatus:function(){return this._userLocationStatus;},_lastLocationTimestamp:0,gotUserLocation:function(_31c){this._userLocation=_31c;this._userLocationStatus=ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.HAS_LOCATION;this._lastLocationTimestamp=new Date().getTime();if(this._listenerArray){for(var _31d in this._listenerArray){var fct=this._listenerArray[_31d];fct.success(_31c);}}if(this._callbackArray){while(this._callbackArray.length>0){var _31e=this._callbackArray.pop();_31e.success(_31c);}}this._callbackArray=[];},failedToGetLocation:function(_31f){console.warn("Error finding user location",_31f);this._userLocationStatus=_31f.code;if(this._listenerArray){for(var _320 in this._listenerArray){var fct=this._listenerArray[_320];fct.failure(_31f);}}if(this._callbackArray){while(this._callbackArray.length>0){var _321=this._callbackArray.pop();_321.failure(_31f);}}this._callbackArray=[];},_isWaitingForTimeout:function(){var now=new Date();if(now.getTime()<(this._lastGetLocCall+this._timeout)){return true;}else{return false;}},_lastGetLocCall:0,getUserLocation:function(_322,_323){if(this._watchPositionId!=null&&this.isStatusHasLocation()){_322(this._userLocation);}else{this._callbackArray.push({success:_322,failure:_323});this.watchUserLocation();}},_h:null,createListener:function(_324,_325){this._h++;var h=this._h;this._listenerArray[h]={success:_324,failure:_325};return h;},listenToUserLocation:function(_326){if(this._listenerArray[_326]!=null){this.watchUserLocation();}else{console.warn("No listener for handler ",_326);}},removeListeners:function(_327){if(_327!=null){this._listenerArray[_327]=null;delete this._listenerArray[_327];}},watchUserLocation:function(){if(navigator.geolocation){if(this._watchPositionId==null){var _328=function(_329){this.gotUserLocation(_329);if(this._mozzilaTS){clearTimeout(this._mozzilaTS);}};var _32a=function(_32b){this.clearWatchUserLocation();if(_32b.code==_32b.TIMEOUT&&dojo.isMozilla&&this.isStatusHasLocation()==true){var now=new Date();var _32c=(now.getTime()-this._requestTimestamp.getTime());if(_32c<(this._timeout+5000)||_32c>(this._timeout-5000)){this.watchUserLocation();return;}}this.failedToGetLocation(_32b);};this._requestTimestamp=new Date();this._watchPositionId=navigator.geolocation.watchPosition(dojo.hitch(this,_328),dojo.hitch(this,_32a),{timeout:this._timeout});if(dojo.isMozilla){if(this.isStatusUnassigned()==true){var _32d=dojo.hitch(this,function(){this.clearWatchUserLocation();var _32e={TIMEOUT:true,code:ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.TIMEOUT,message:"Browser FF timeout"};this.clearWatchUserLocation();this.failedToGetLocation(_32e);});this._mozzilaTS=setTimeout(_32d,this._oldTimeout);}}}else{console.warn("Watch Position is already enabled");if(this.isStatusHasLocation()==true){this.gotUserLocation(this._userLocation);}else{if(this.isStatusUnassigned()!=true){var _32f={code:this.getStatus(),message:"Failed"};this.clearWatchUserLocation();this.failedToGetLocation(_32f);}}}}else{console.warn("no geolocation support");this._userLocationStatus=ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.GEOLOCATION_NOT_SUPPORTED;var _32f={code:ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.GEOLOCATION_NOT_SUPPORTED,message:"Browser does not support geolocation"};this.failedToGetLocation(_32f);}},clearWatchUserLocation:function(){if(this._watchPositionId!=null){if(navigator.geolocation){navigator.geolocation.clearWatch(this._watchPositionId);this._watchPositionId=null;}}else{}},isStatusUnassigned:function(){return this.isStatusEqual(ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.UNASSIGNED);},isStatusHasLocation:function(){return this.isStatusEqual(ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.HAS_LOCATION);},isStatusEqual:function(_330){return (this._userLocationStatus==_330);},convertPositionToMapPoint:function(map,_331,_332){var _333=this.getPosition();var _334=new mxn.LatLonPoint(_333.coords.latitude,_333.coords.longitude);map.getMapstraction().getAllPointsFromWGS84([_334],dojo.hitch(this,function(_335){_331(_335[0]);}));}});ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation.getMyCurrentLocationInstance=function(){if(!ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation._instance){ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation._instance=new ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation();}return ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation._instance;};});},"ibm/tivoli/fwm/mxmap/layers/SymbologyLayer":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_336,dojo,_337){dojo.provide("ibm.tivoli.fwm.mxmap.layers.SymbologyLayer");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.layers.SymbologyLayer",[ibm.tivoli.fwm.mxmap.layers.Layer],{symbologyType:null,toggleState:function(){var _338=this.getSiblings();dojo.forEach(_338,function(_339){_339.disable();});this.enable();},enable:function(){var _33a=this.getParentLayer().getLayerId();this._map.getSymbologyManager().setActiveSymbology(_33a,this.layerConf);this.inherited(arguments);this._map.getLayersManager().redrawMarkers();},disable:function(){this.inherited(arguments);}});});},"ibm/tivoli/fwm/mxmap/ImageLibraryManager":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/MarkerImageInfo"],function(_33b,dojo,_33c){dojo.provide("ibm.tivoli.fwm.mxmap.ImageLibraryManager");dojo.require("ibm.tivoli.fwm.mxmap.MarkerImageInfo");ibm.tivoli.fwm.mxmap.ImageLibraryManager._instance=null;dojo.declare("ibm.tivoli.fwm.mxmap.ImageLibraryManager",null,{_infoCache:null,constructor:function(_33d){dojo.mixin(this,_33d);this._loadCache();},getMarkerImageInfoForObject:function(_33e){var _33f=_33e?this._infoCache[_33e.toUpperCase()]:null;if(!_33f){console.warn("[ImageLibraryManager] No marker image found for object "+_33e);console.warn("[ImageLibraryManager] returning default one");return this.getDefaultMarkerImageInfo();}return _33f;},getLBSMarkerImageInfo:function(_340){if(_340){if("EXCEEDED_TOLERANCE"===_340.max_accuracy_state){return this.getMarkerImageInfoForObject("__LBS_EXCEEDED_ACCURACY");}else{if("EXCEEDED_TOLERANCE"===_340.last_update_condition_state){return this.getMarkerImageInfoForObject("__LBS_EXCEEDED_UPDATE_COND");}else{return this.getMarkerImageInfoForObject("__LBS_INSIDE_TOLERANCE");}}}console.warn("no lbs data!");return null;},getDefaultMarkerImageInfo:function(){return this._infoCache["__DEFAULT_MARKER"];},getStartPositionMarkerImageInfo:function(){return this._infoCache["__START_POSITION_MARKER"];},getEndPositionMarkerImageInfo:function(){return this._infoCache["__END_POSITION_MARKER"];},getLayerOnImageInfo:function(){return this._infoCache["__LAYER_ON"];},getLayerOffImageInfo:function(){return this._infoCache["__LAYER_OFF"];},getLayerDetailsImageInfo:function(){return this._infoCache["__LAYER_DETAILS"];},getLayerDetailsOffImageInfo:function(){return this._infoCache["__LAYER_DETAILS_OFF"];},getDefaultReadOnlyMarkerImageInfo:function(){return this._infoCache["__DEFAULT_RO_MARKER"];},getMyLocationMarkerImageInfo:function(){return this._infoCache["__MY_LOCATION"];},getDefaultWorkOrderMarkerImageInfo:function(){return this._infoCache["WORKORDER"];},getResourcesPath:function(){return dojo.moduleUrl("ibm.tivoli.fwm.mxmap","resources");},updateDefaultMarkerImageURL:function(_341){this.getDefaultMarkerImageInfo().setImageURL(_341);},_loadCache:function(){var _342="";if(document.body.dir=="rtl"){_342="/rtl";}this._infoCache={};this._infoCache["LABOR"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/symbology/labor/map_locationLabor.png",imageSize:[47,36],imageAnchor:[24,41]});this._infoCache["AMCREW"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/symbology/crew/map_locationCrew.png",imageSize:[47,36],imageAnchor:[24,41]});this._infoCache["WORKORDER"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/symbology/workorder/map_WO_default.png",imageSize:[47,36],imageAnchor:[24,36]});this._infoCache["__DEFAULT_MARKER"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/symbology/map_default_marker.png",imageSize:[36,36],imageAnchor:[11,36]});this._infoCache["__START_POSITION_MARKER"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/map16_pointMarker_start.png",imageSize:[16,16],imageAnchor:[8,8]});this._infoCache["__END_POSITION_MARKER"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/map16_pointMarker_red.png",imageSize:[16,16],imageAnchor:[8,8]});this._infoCache["__DEFAULT_RO_MARKER"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/symbology/map_default_marker.png",imageSize:[32,32],imageAnchor:[0,32]});this._infoCache["__LBS_EXCEEDED_ACCURACY"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/map16_pointMarker_red.png",imageSize:[16,16],imageAnchor:[8,8]});this._infoCache["__LBS_EXCEEDED_UPDATE_COND"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/map16_pointMarker_yellow.png",imageSize:[16,16],imageAnchor:[8,8]});this._infoCache["__LBS_INSIDE_TOLERANCE"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/map16_pointMarker_blue.png",imageSize:[16,16],imageAnchor:[8,8]});this._infoCache["__MY_LOCATION"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/map16_pointMarker_blue.png",imageSize:[16,16],imageAnchor:[8,8]});this._infoCache["__LAYER_ON"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/checkBox_selected.png",imageSize:[15,15],imageAnchor:[0,0]});this._infoCache["__LAYER_OFF"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/checkBox_unselected.png",imageSize:[15,15],imageAnchor:[0,0]});this._infoCache["__LAYER_DETAILS"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/symbologyMenu_arrow.png",imageSize:[15,15],imageAnchor:[0,0]});this._infoCache["__LAYER_DETAILS_OFF"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/symbologyMenu_arrow_off.png",imageSize:[15,15],imageAnchor:[0,0]});this._infoCache["UNASSIGNEDWORK"]=new ibm.tivoli.fwm.mxmap.MarkerImageInfo({imageUrl:this.getResourcesPath()+_342+"/marker_yellow.png",imageSize:[20,34],imageAnchor:[10,34]});}});ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager=function(){if(!ibm.tivoli.fwm.mxmap.ImageLibraryManager._instance){ibm.tivoli.fwm.mxmap.ImageLibraryManager._instance=new ibm.tivoli.fwm.mxmap.ImageLibraryManager();}return ibm.tivoli.fwm.mxmap.ImageLibraryManager._instance;};});},"dijit/_OnDijitClickMixin":function(){define("dijit/_OnDijitClickMixin",["dojo/on","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/sniff","dojo/_base/unload","dojo/_base/window"],function(on,_343,keys,_344,has,_345,win){var _346=null;if(has("ie")){(function(){var _347=function(evt){_346=evt.srcElement;};win.doc.attachEvent("onkeydown",_347);_345.addOnWindowUnload(function(){win.doc.detachEvent("onkeydown",_347);});})();}else{win.doc.addEventListener("keydown",function(evt){_346=evt.target;},true);}var _348=function(node,_349){if(/input|button/i.test(node.nodeName)){return on(node,"click",_349);}else{function _34a(e){return (e.keyCode==keys.ENTER||e.keyCode==keys.SPACE)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey;};var _34b=[on(node,"keypress",function(e){if(_34a(e)){_346=e.target;e.preventDefault();}}),on(node,"keyup",function(e){if(_34a(e)&&e.target==_346){_346=null;_349.call(this,e);}}),on(node,"click",function(e){_349.call(this,e);})];return {remove:function(){_343.forEach(_34b,function(h){h.remove();});}};}};return _344("dijit._OnDijitClickMixin",null,{connect:function(obj,_34c,_34d){return this.inherited(arguments,[obj,_34c=="ondijitclick"?_348:_34c,_34d]);}});});},"ibm/tivoli/fwm/mxmap/factories/spatial":function(){define(["dijit","dojo","dojox","dojo/require!dojo/io/script,ibm/tivoli/fwm/mxmap/impl/MaximoSpatial"],function(_34e,dojo,_34f){dojo.provide("ibm.tivoli.fwm.mxmap.factories.spatial");dojo.require("dojo.io.script");dojo.require("ibm.tivoli.fwm.mxmap.impl.MaximoSpatial");ibm.tivoli.fwm.mxmap.factories.spatial=({loaded:false,apiLoaded:function(){ibm.tivoli.fwm.mxmap.factories.spatial.loaded=true;esri.config.defaults.io.proxyUrl=dojo.config.fwm.ctxRoot+"/webclient/pluss/proxy.jsp";ibm.tivoli.fwm.mxmap.factory.apiInitialized("ibm.tivoli.fwm.mxmap.impl.MaximoSpatial","spatial");},init:function(_350){var _351=false;if(_350.mapConf.SPATIAL&&_350.mapConf.SPATIAL.localApi){_351=true;}this._loadJSApi(_350.mapConf.key,_350.mapConf.https,_350.isMobile,_351);},_loadJSApi:function(key,_352,_353,_354){this.isMobile=_353;this.localApi=_354;this.protocol="http";if(window.location.protocol=="https:"){this.protocol="https";}dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/pluss/com/esri/solutions/jsviewer/themes/spatial/mxmap.css","css");dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/pluss/com/esri/solutions/jsviewer/themes/spatial/override.css","css");dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/ibm/tivoli/fwm/mxn/mxn.maximospatial.core.js","js");dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/ibm/tivoli/fwm/mxn/mxn.maximospatial.geocoder.js","js");ibm.tivoli.fwm.mxmap.factories.spatial.initDojo(ibm.tivoli.fwm.mxmap.factories.spatial.apiLoaded);},localApi:false,isMobile:false,protocol:"http",initDojo:function(fct){if(window.esri==null){if(window.djConfig==null){window.djConfig=dojo.config;}window.djConfig.scopeMap=[["dojo","esriDojoNew"],["dijit","esriDijitNew"],["dojox","esriDojoxNew"]];var _355="";if(this.isMobile){_355="compact";}var url=this.protocol+"://serverapi.arcgisonline.com/jsapi/arcgis/?v=2.8"+_355;if(this.localApi){url=dojo.config.fwm.ctxRoot+"/webclient/javascript/pluss/arcgis_js_index.jsp?apiPath=arcgis_js_api/library/2.8/jsapi"+_355+"/";}dojo.io.script.get({url:url,timeout:30000,error:function(){console.error("Failed to load esri js apis");alert("Failed to load esri js api");}});}ibm.tivoli.fwm.mxmap.factories.spatial.fcc=fct;ibm.tivoli.fwm.mxmap.factories.spatial.waiter();},waiter:function(){if(!window.esri){setTimeout("ibm.tivoli.fwm.mxmap.factories.spatial.waiter()",300);}else{try{if(this.isMobile){esriDojoNew.require("esri.toolbars.draw");esriDojoNew.require("esri.toolbars.edit");esriDojoNew.require("esri.toolbars.navigation");esriDojoNew.require("esri.tasks.identify");esriDojoNew.require("esri.tasks.query");esriDojoNew.require("esri.tasks.geometry");esriDojoNew.require("esri.virtualearth.VETiledLayer");esriDojoNew.require("esri.virtualearth.VEGeocoder");}esriDojoNew.require("esri.dijit.Scalebar");esriDojoNew.require("esri.dijit.OverviewMap");esriDojoNew.require("esri.map");esriDojoNew.addOnLoad(ibm.tivoli.fwm.mxmap.factories.spatial.fcc);}catch(e){}}},apiPooler:function(){try{if(window.esri!=null){ibm.tivoli.fwm.mxmap.factories.spatial.apiLoaded();return;}}catch(e){}if(dojo.config.fwm.debug==true){}if(ibm.tivoli.fwm.mxmap.factories.spatial.loaded!=true){setTimeout("ibm.tivoli.fwm.mxmap.factories.spatial.apiPooler()",500);}else{ibm.tivoli.fwm.mxmap.factories.spatial.apiLoaded();}}});});},"dojo/dnd/autoscroll":function(){define("dojo/dnd/autoscroll",["../main","../window"],function(dojo){dojo.getObject("dnd",true,dojo);dojo.dnd.getViewport=dojo.window.getBox;dojo.dnd.V_TRIGGER_AUTOSCROLL=32;dojo.dnd.H_TRIGGER_AUTOSCROLL=32;dojo.dnd.V_AUTOSCROLL_VALUE=16;dojo.dnd.H_AUTOSCROLL_VALUE=16;dojo.dnd.autoScroll=function(e){var v=dojo.window.getBox(),dx=0,dy=0;if(e.clientX<dojo.dnd.H_TRIGGER_AUTOSCROLL){dx=-dojo.dnd.H_AUTOSCROLL_VALUE;}else{if(e.clientX>v.w-dojo.dnd.H_TRIGGER_AUTOSCROLL){dx=dojo.dnd.H_AUTOSCROLL_VALUE;}}if(e.clientY<dojo.dnd.V_TRIGGER_AUTOSCROLL){dy=-dojo.dnd.V_AUTOSCROLL_VALUE;}else{if(e.clientY>v.h-dojo.dnd.V_TRIGGER_AUTOSCROLL){dy=dojo.dnd.V_AUTOSCROLL_VALUE;}}window.scrollBy(dx,dy);};dojo.dnd._validNodes={"div":1,"p":1,"td":1};dojo.dnd._validOverflow={"auto":1,"scroll":1};dojo.dnd.autoScrollNodes=function(e){var b,t,w,h,rx,ry,dx=0,dy=0,_356,_357;for(var n=e.target;n;){if(n.nodeType==1&&(n.tagName.toLowerCase() in dojo.dnd._validNodes)){var s=dojo.getComputedStyle(n),_358=(s.overflow.toLowerCase() in dojo.dnd._validOverflow),_359=(s.overflowX.toLowerCase() in dojo.dnd._validOverflow),_35a=(s.overflowY.toLowerCase() in dojo.dnd._validOverflow);if(_358||_359||_35a){b=dojo._getContentBox(n,s);t=dojo.position(n,true);}if(_358||_359){w=Math.min(dojo.dnd.H_TRIGGER_AUTOSCROLL,b.w/2);rx=e.pageX-t.x;if(dojo.isWebKit||dojo.isOpera){rx+=dojo.body().scrollLeft;}dx=0;if(rx>0&&rx<b.w){if(rx<w){dx=-w;}else{if(rx>b.w-w){dx=w;}}_356=n.scrollLeft;n.scrollLeft=n.scrollLeft+dx;}}if(_358||_35a){h=Math.min(dojo.dnd.V_TRIGGER_AUTOSCROLL,b.h/2);ry=e.pageY-t.y;if(dojo.isWebKit||dojo.isOpera){ry+=dojo.body().scrollTop;}dy=0;if(ry>0&&ry<b.h){if(ry<h){dy=-h;}else{if(ry>b.h-h){dy=h;}}_357=n.scrollTop;n.scrollTop=n.scrollTop+dy;}}if(dx||dy){return;}}try{n=n.parentNode;}catch(x){n=null;}}dojo.dnd.autoScroll(e);};return dojo.dnd;});},"dijit/form/_RadioButtonMixin":function(){define("dijit/form/_RadioButtonMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/_base/event","dojo/_base/lang","dojo/query","dojo/_base/window","../registry"],function(_35b,_35c,_35d,_35e,lang,_35f,win,_360){return _35c("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var ary=[];_35f("input[type=radio]",this.focusNode.form||win.doc).forEach(lang.hitch(this,function(_361){if(_361.name==this.name&&_361.form==this.focusNode.form){var _362=_360.getEnclosingWidget(_361);if(_362){ary.push(_362);}}}));return ary;},_setCheckedAttr:function(_363){this.inherited(arguments);if(!this._created){return;}if(_363){_35b.forEach(this._getRelatedWidgets(),lang.hitch(this,function(_364){if(_364!=this&&_364.checked){_364.set("checked",false);}}));}},_onClick:function(e){if(this.checked||this.disabled){_35e.stop(e);return false;}if(this.readOnly){_35e.stop(e);_35b.forEach(this._getRelatedWidgets(),lang.hitch(this,function(_365){_35d.set(this.focusNode||this.domNode,"checked",_365.checked);}));return false;}return this.inherited(arguments);}});});},"dojo/dnd/TimedMoveable":function(){define("dojo/dnd/TimedMoveable",["../main","./Moveable"],function(dojo){var _366=dojo.dnd.Moveable.prototype.onMove;dojo.declare("dojo.dnd.TimedMoveable",dojo.dnd.Moveable,{timeout:40,constructor:function(node,_367){if(!_367){_367={};}if(_367.timeout&&typeof _367.timeout=="number"&&_367.timeout>=0){this.timeout=_367.timeout;}},onMoveStop:function(_368){if(_368._timer){clearTimeout(_368._timer);_366.call(this,_368,_368._leftTop);}dojo.dnd.Moveable.prototype.onMoveStop.apply(this,arguments);},onMove:function(_369,_36a){_369._leftTop=_36a;if(!_369._timer){var _36b=this;_369._timer=setTimeout(function(){_369._timer=null;_366.call(_36b,_369,_369._leftTop);},this.timeout);}}});return dojo.dnd.TimedMoveable;});},"ibm/tivoli/fwm/mxmap/layers/VirtualLayer":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/layers/Layer,ibm/tivoli/fwm/mxmap/_Base"],function(_36c,dojo,_36d){dojo.provide("ibm.tivoli.fwm.mxmap.layers.VirtualLayer");dojo.require("ibm.tivoli.fwm.mxmap.layers.Layer");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.layers.VirtualLayer",[ibm.tivoli.fwm.mxmap.layers.Layer],{constructor:function(_36e){this._layerName=_36e.layerId;this._layerId=_36e.layerId;this.enable();this.layerConf=this.symbManager.getLayerConfigById(_36e.objectType);}});});},"ibm/tivoli/fwm/mxmap/factories/gmaps":function(){define(["dijit","dojo","dojox","dojo/require!dojo/io/script,ibm/tivoli/fwm/mxmap/impl/GMaps"],function(_36f,dojo,_370){dojo.provide("ibm.tivoli.fwm.mxmap.factories.gmaps");dojo.require("dojo.io.script");dojo.require("ibm.tivoli.fwm.mxmap.impl.GMaps");ibm.tivoli.fwm.mxmap.factories.gmaps={compId:null,apiLoaded:function(){ibm.tivoli.fwm.mxmap.factory.apiInitialized("ibm.tivoli.fwm.mxmap.impl.GMaps","gmaps");},init:function(_371){this._loadJSApi(_371.mapConf.key,_371.mapConf.https);},_loadJSApi:function(key,_372){var _373="http";var _374="";if(_372){_373="https";}if(key){_374="&client="+key;}dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/ibm/tivoli/fwm/mxn/mxn.googlev3.core.js","js");dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/ibm/tivoli/fwm/mxn/mxn.googlev3.geocoder.js","js");dojo.io.script.get({url:_373+"://maps.google.com/maps/api/js?v=3.8&sensor=true&callback=ibm.tivoli.fwm.mxmap.factories.gmaps.apiLoaded"+_374,timeout:30000,error:function(){console.error("Failed to load google apis");alert("Failed to load google maps api, check your internet conncetion.");}});}};});},"dojo/cache":function(){define("dojo/cache",["./_base/kernel","./text"],function(dojo,text){return dojo.cache;});},"ibm/tivoli/fwm/mxmap/Geocoder":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/util/AddressCandidatesFormatter,ibm/tivoli/fwm/mxmap/panels/MobileInfoPanelDialog,ibm/tivoli/fwm/i18n"],function(_375,dojo,_376){dojo.provide("ibm.tivoli.fwm.mxmap.Geocoder");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.util.AddressCandidatesFormatter");dojo.require("ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog");dojo.require("ibm.tivoli.fwm.i18n");ibm.tivoli.fwm.mxmap.GeoCodeErrorCodes={ZERO_RESULTS:"ZERO_RESULTS",INVALID_REQUEST:"INVALID_REQUEST",REQUEST_DENIED:"REQUEST_DENIED",OVER_LIMIT:"OVER_LIMIT",UNKNOWN:"UNKNOWN"};dojo.declare("ibm.tivoli.fwm.mxmap.Geocoder",ibm.tivoli.fwm.mxmap._Base,{map:null,key:null,_geocode:null,_candidateDialog:null,constructor:function(_377){dojo.mixin(this,_377);this.addSubscription(dojo.subscribe("mxmap_geocoder_"+this.map.getId(),dojo.hitch(this,this.findLocation)));this.addSubscription(dojo.subscribe("addressCandidateSelectedOnMapId_"+this.map.getId(),dojo.hitch(this,this._addressCandidateSelected)));},findLocation:function(_378,_379,_37a){if(!_378||_378.length==0){return;}if(!_37a){_37a=dojo.hitch(this,this.errorDuringGeocode);}if(!_379){_379=dojo.hitch(this,this.returnFindLocation);}this._geocode=new mxn.Geocoder(this.map.providerName,_379,_37a,{key:this.key,map:this.map.getMapstraction(),customParams:this.map.getGeoCoderConf()});this._geocode.geocode({address:_378});},reverseGeocode:function(lat,lng,_37b,_37c){if(!_37c){_37c=dojo.hitch(this,this.errorDuringGeocode);}if(!_37b){_37b=dojo.hitch(this,this.returnUpdateAddress);}this._geocode=new mxn.Geocoder(this.map.providerName,_37b,_37c,{key:this.key,map:this.map.getMapstraction(),customParams:this.map.getGeoCoderConf()});this._geocode.geocode({lat:lat,lng:lng});},convertGeocodedAddressIntoFormattedAddress:function(_37d){return _37d.formattedAddress;},returnFindLocation:function(_37e){if(dojo.config.fwm.debug==true){}if(_37e.length==1){var _37f=_37e[0];this.map.getMaximo().setCurrentRecordLocation({lat:_37f.point.lat,lng:_37f.point.lng,address:this.convertGeocodedAddressIntoFormattedAddress(_37f)});}else{var me=this;var _380=ibm.tivoli.fwm.i18n.getMaxMsg("map","addresscandidates");if(this._candidateDialog==null){this._candidateDialog=new ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog({map:me.map,title:_380});}var _381=ibm.tivoli.fwm.mxmap.util.AddressCandidatesFormatter.createHTMLDOMWithList(_37e,this.map.getId(),this._candidateDialog.getCalculatedWidth(),this._candidateDialog.getCalculatedHeight());this._candidateDialog.setContent(_381);this._candidateDialog.show();}},returnUpdateAddress:function(_382){this.map.getMaximo().setCurrentRecordLocation({address:this.convertGeocodedAddressIntoFormattedAddress(_382)});},errorDuringGeocode:function(_383){switch(_383){case ibm.tivoli.fwm.mxmap.GeoCodeErrorCodes.ZERO_RESULTS:this.map.getMaximo().showMessage("mapserver","geocode_noresults");break;case ibm.tivoli.fwm.mxmap.GeoCodeErrorCodes.INVALID_REQUEST:this.map.getMaximo().showMessage("mapserver","geocode_invalid_req");break;case ibm.tivoli.fwm.mxmap.GeoCodeErrorCodes.REQUEST_DENIED:this.map.getMaximo().showMessage("mapserver","geocode_req_denied");break;case ibm.tivoli.fwm.mxmap.GeoCodeErrorCodes.OVER_LIMIT:this.map.getMaximo().showMessage("mapserver","geocode_limits_exceed");break;case ibm.tivoli.fwm.mxmap.GeoCodeErrorCodes.UNKNOWN:this.map.getMaximo().showMessage("mapserver","geocode_unknown_error");break;default:this.map.getMaximo().showMessage("mapserver","geocode_unknown_error");break;}},_addressCandidateSelected:function(_384){if(this._candidateDialog){this._candidateDialog.close();this._candidateDialog=null;}this.returnFindLocation([_384]);}});});},"ibm/tivoli/fwm/mxmap/InfoWindow":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/_Widget,dijit/_Templated"],function(_385,dojo,_386){dojo.provide("ibm.tivoli.fwm.mxmap.InfoWindow");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.declare("ibm.tivoli.fwm.mxmap.InfoWindow",[ibm.tivoli.fwm.mxmap._Base,_385._Widget,_385._Templated],{map:null,isRTL:null,templateString:"<div>\n<div style=\"position: relative; width: 0pt; height: 0pt; line-height: 0; border-color: transparent rgb(255, 255, 255) transparent transparent; margin-left: 0px; margin-top: 0px; border-style: solid; float: left; border-width: 15px 15px 15px 2px;\"></div>\n\n<div dojoAttachPoint=\"mainDialog\" style=\"padding:5px;position:relative;float:left;border:1px solid #000;background-color:#fff;min-width:100px;min-height:50px;\">\n\t<div dojoAttachPoint=\"closeBtn\" style=\"padding:0;margin:0;float:right;width:29px;height:29px;cursor: pointer;text-align:right;position:absolute;background: url(../webclient/javascript/ibm/tivoli/fwm/mxmap/resources/ac16_winClose.png) no-repeat;background-position: 8px 6px;\" dojoAttachEvent=\"onclick:close\"></div>\t\n\t<div dojoAttachPoint=\"content\" style=\"overflow-x:auto;\"></div>\n\t</div>\n</div>",_display:null,rootElement:null,domNode:null,mapId:null,constructor:function(_387){dojo.mixin(this,_387);this._display=false;if(!this.isRTL){this.isRTL=document.body.dir=="rtl";}},postCreate:function(){dojo.parser.parse(this.domNode);dojo.style(this.domNode,"display","none");dojo.style(this.domNode,"position","absolute");this._display=false;this.placeAt(this.rootElement);if(this.isRTL==true){dojo.style(this.closeBtn,"float","left");dojo.style(this.closeBtn,"left","3px");dojo.style(this.domNode,"direction","rtl");}else{dojo.style(this.closeBtn,"float","right");dojo.style(this.closeBtn,"right","3px");dojo.style(this.domNode,"direction","ltr");}if(dojo.isIE){dojo.style(this.mainDialog,"width","100px");}dojo.connect(this.domNode,"oncontextmenu",function(evt){mxn.util.stopEventPropagation(evt);dojo.stopEvent(evt);});},updatePosition:function(x,y){var _388={x:0,y:0};var px=x+_388.x+this.offset.x;var py=y+_388.y+this.offset.y;dojo.style(this.domNode,"left",px);dojo.style(this.domNode,"top",py);if(this.isDisplayed()){if(parseInt(px)<0||parseInt(py)<0||parseInt(dojo.style(this.domNode,"right"))<0||parseInt(dojo.style(this.domNode,"bottom"))<0){this.close();}}},isDisplayed:function(){return (this._display==true);},setContent:function(_389){if(typeof (_389)=="object"){this.setDomContent(_389);}else{dojo.empty(this.content);dojo.create("div",{innerHTML:text},this.content);}},setDomContent:function(_38a){dojo.place(_38a,this.content,"only");},close:function(){dojo.style(this.domNode,"display","none");this._display=false;dojo.publish("endedUserInteractionOnMap_"+this.mapId,[{objectSource:this,objectSourceName:"infowindow",eventName:"closeBubble"}]);},offset:{y:-15,x:0},show:function(x,y){var _38b={x:0,y:0};var px=x+_38b.x+this.offset.x;var py=y+_38b.y+this.offset.y;dojo.style(this.domNode,"top",py);dojo.style(this.domNode,"left",px);dojo.style(this.domNode,"display","block");this._display=true;}});});},"dijit/_base/popup":function(){define("dijit/_base/popup",["dojo/dom-class","../popup","../BackgroundIframe"],function(_38c,_38d){var _38e=_38d._createWrapper;_38d._createWrapper=function(_38f){if(!_38f.declaredClass){_38f={_popupWrapper:(_38f.parentNode&&_38c.contains(_38f.parentNode,"dijitPopup"))?_38f.parentNode:null,domNode:_38f,destroy:function(){}};}return _38e.call(this,_38f);};var _390=_38d.open;_38d.open=function(args){if(args.orient&&typeof args.orient!="string"&&!("length" in args.orient)){var ary=[];for(var key in args.orient){ary.push({aroundCorner:key,corner:args.orient[key]});}args.orient=ary;}return _390.call(this,args);};return _38d;});},"ibm/tivoli/fwm/mxmap/toolbar/ext/WorkOrderSymbologyTool":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/layers/LayerPanelWidget,ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/toolbar/ext/LayersTool,dijit/form/Button"],function(_391,dojo,_392){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ext.WorkOrderSymbologyTool");dojo.require("ibm.tivoli.fwm.mxmap.layers.LayerPanelWidget");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.toolbar.ext.LayersTool");dojo.require("dijit.form.Button");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ext.WorkOrderSymbologyTool",ibm.tivoli.fwm.mxmap.toolbar.ext.LayersTool,{iconClass:"basicMapToolbarBtn workOrderSymbologyMapToolbarBtn",constructor:function(_393){dojo.mixin(this,_393);var _394=ibm.tivoli.fwm.i18n.getMaxMsg("map","workordersymbology");this.label=_394||this.label;},execute:function(){var _395=this.map.getLayersManager().getLayerById("workorder");if((_395!=null)&&(_395.hasChildren())){var _396=new ibm.tivoli.fwm.mxmap.layers.LayerPanelWidget({map:this.map,title:_395.getChildrenTitle()});_396.updateLayers(_395.getChildren());}}});});},"url:dijit/form/templates/Button.html":"<span class=\"dijit dijitReset dijitInline\" role=\"presentation\"\n\t><span class=\"dijitReset dijitInline dijitButtonNode\"\n\t\tdata-dojo-attach-event=\"ondijitclick:_onClick\" role=\"presentation\"\n\t\t><span class=\"dijitReset dijitStretch dijitButtonContents\"\n\t\t\tdata-dojo-attach-point=\"titleNode,focusNode\"\n\t\t\trole=\"button\" aria-labelledby=\"${id}_label\"\n\t\t\t><span class=\"dijitReset dijitInline dijitIcon\" data-dojo-attach-point=\"iconNode\"></span\n\t\t\t><span class=\"dijitReset dijitToggleButtonIconChar\">&#x25CF;</span\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"\n\t\t\t\tid=\"${id}_label\"\n\t\t\t\tdata-dojo-attach-point=\"containerNode\"\n\t\t\t></span\n\t\t></span\n\t></span\n\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" class=\"dijitOffScreen\"\n\t\ttabIndex=\"-1\" role=\"presentation\" data-dojo-attach-point=\"valueNode\"\n/></span>\n","ibm/tivoli/fwm/mxmap/toolbar/ext/RefresherTool":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/toolbar/ext/_ToolTemplate,ibm/tivoli/fwm/mxmap/_Base,dijit/form/Button"],function(_397,dojo,_398){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ext.RefresherTool");dojo.require("ibm.tivoli.fwm.mxmap.toolbar.ext._ToolTemplate");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("dijit.form.Button");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ext.RefresherTool",ibm.tivoli.fwm.mxmap.toolbar.ext._ToolTemplate,{label:"Refresh",iconClass:"basicMapToolbarBtn refreshMapToolbarBtn",map:null,constructor:function(_399){dojo.mixin(this,_399);var _39a=ibm.tivoli.fwm.i18n.getMaxMsg("map","refreshtoolbar");this.label=_39a||this.label;},execute:function(){var _39b={zoom:true,disableMsgs:false,automatic:false};this.map.refreshMap(_39b);},disable:function(){},destroy:function(){this.destroyRecursive();}});});},"dojo/_base/url":function(){define("dojo/_base/url",["./kernel"],function(dojo){var ore=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),ire=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$"),_39c=function(){var n=null,_39d=arguments,uri=[_39d[0]];for(var i=1;i<_39d.length;i++){if(!_39d[i]){continue;}var _39e=new _39c(_39d[i]+""),_39f=new _39c(uri[0]+"");if(_39e.path==""&&!_39e.scheme&&!_39e.authority&&!_39e.query){if(_39e.fragment!=n){_39f.fragment=_39e.fragment;}_39e=_39f;}else{if(!_39e.scheme){_39e.scheme=_39f.scheme;if(!_39e.authority){_39e.authority=_39f.authority;if(_39e.path.charAt(0)!="/"){var path=_39f.path.substring(0,_39f.path.lastIndexOf("/")+1)+_39e.path;var segs=path.split("/");for(var j=0;j<segs.length;j++){if(segs[j]=="."){if(j==segs.length-1){segs[j]="";}else{segs.splice(j,1);j--;}}else{if(j>0&&!(j==1&&segs[0]=="")&&segs[j]==".."&&segs[j-1]!=".."){if(j==(segs.length-1)){segs.splice(j,1);segs[j-1]="";}else{segs.splice(j-1,2);j-=2;}}}}_39e.path=segs.join("/");}}}}uri=[];if(_39e.scheme){uri.push(_39e.scheme,":");}if(_39e.authority){uri.push("//",_39e.authority);}uri.push(_39e.path);if(_39e.query){uri.push("?",_39e.query);}if(_39e.fragment){uri.push("#",_39e.fragment);}}this.uri=uri.join("");var r=this.uri.match(ore);this.scheme=r[2]||(r[1]?"":n);this.authority=r[4]||(r[3]?"":n);this.path=r[5];this.query=r[7]||(r[6]?"":n);this.fragment=r[9]||(r[8]?"":n);if(this.authority!=n){r=this.authority.match(ire);this.user=r[3]||n;this.password=r[4]||n;this.host=r[6]||r[7];this.port=r[9]||n;}};_39c.prototype.toString=function(){return this.uri;};return dojo._Url=_39c;});},"dojox/main":function(){define("dojox/main",["dojo/_base/kernel"],function(dojo){return dojo.dojox;});},"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\"\n\t\tdata-dojo-attach-event=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n","dojo/text":function(){define("dojo/text",["./_base/kernel","require","./has","./_base/xhr"],function(dojo,_3a0,has,xhr){var _3a1;if(1){_3a1=function(url,sync,load){xhr("GET",{url:url,sync:!!sync,load:load});};}else{if(_3a0.getText){_3a1=_3a0.getText;}else{console.error("dojo/text plugin failed to load because loader does not support getText");}}var _3a2={},_3a3=function(text){if(text){text=text.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var _3a4=text.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);if(_3a4){text=_3a4[1];}}else{text="";}return text;},_3a5={},_3a6={},_3a7={dynamic:true,normalize:function(id,_3a8){var _3a9=id.split("!"),url=_3a9[0];return (/^\./.test(url)?_3a8(url):url)+(_3a9[1]?"!"+_3a9[1]:"");},load:function(id,_3aa,load){var _3ab=id.split("!"),_3ac=_3ab.length>1,_3ad=_3ab[0],url=_3aa.toUrl(_3ab[0]),text=_3a5,_3ae=function(text){load(_3ac?_3a3(text):text);};if(_3ad in _3a2){text=_3a2[_3ad];}else{if(url in _3aa.cache){text=_3aa.cache[url];}else{if(url in _3a2){text=_3a2[url];}}}if(text===_3a5){if(_3a6[url]){_3a6[url].push(_3ae);}else{var _3af=_3a6[url]=[_3ae];_3a1(url,!_3aa.async,function(text){_3a2[_3ad]=_3a2[url]=text;for(var i=0;i<_3af.length;){_3af[i++](text);}delete _3a6[url];});}}else{_3ae(text);}}};dojo.cache=function(_3b0,url,_3b1){var key;if(typeof _3b0=="string"){if(/\//.test(_3b0)){key=_3b0;_3b1=url;}else{key=_3a0.toUrl(_3b0.replace(/\./g,"/")+(url?("/"+url):""));}}else{key=_3b0+"";_3b1=url;}var val=(_3b1!=undefined&&typeof _3b1!="string")?_3b1.value:_3b1,_3b2=_3b1&&_3b1.sanitize;if(typeof val=="string"){_3a2[key]=val;return _3b2?_3a3(val):val;}else{if(val===null){delete _3a2[key];return null;}else{if(!(key in _3a2)){_3a1(key,true,function(text){_3a2[key]=text;});}return _3b2?_3a3(_3a2[key]):_3a2[key];}}};return _3a7;});},"ibm/tivoli/fwm/mxmap/toolbar/ext/_ToggleTool":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/form/ToggleButton,ibm/tivoli/fwm/mxmap/toolbar/ext/_ToolTemplate"],function(_3b3,dojo,_3b4){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ext._ToggleTool");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("dijit.form.ToggleButton");dojo.require("ibm.tivoli.fwm.mxmap.toolbar.ext._ToolTemplate");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ext._ToggleTool",ibm.tivoli.fwm.mxmap.toolbar.ext._ToolTemplate,{toolActive:false,constructor:function(_3b5){dojo.mixin(this,_3b5);},createToolbarButton:function(){this._button=new _3b3.form.ToggleButton({label:this.label,showLabel:false,iconClass:this.iconClass,onClick:dojo.hitch(this,function(){this.execute();})});return this._button;},execute:function(){this.toggleStatus();},toggleStatus:function(){if(this.isActive()==true){this.setActive(false);this.executeOff();}else{this.setActive(true);this.executeOn();}},isActive:function(){return this.toolActive;},executeOn:function(){console.error("to be implemented");},executeOff:function(){console.error("to be implemented");},setActive:function(_3b6){if(this._button!=null){this._button.set({checked:_3b6});}this.toolActive=_3b6;}});});},"url:dijit/form/templates/CheckBox.html":"<div class=\"dijit dijitReset dijitInline\" role=\"presentation\"\n\t><input\n\t \t${!nameAttrSetting} type=\"${type}\" ${checkedAttrSetting}\n\t\tclass=\"dijitReset dijitCheckBoxInput\"\n\t\tdata-dojo-attach-point=\"focusNode\"\n\t \tdata-dojo-attach-event=\"onclick:_onClick\"\n/></div>\n","ibm/tivoli/fwm/mxmap/toolbar/ext/MyLocationTool":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/toolbar/ext/_ToggleTool,dijit/form/Button,ibm/tivoli/fwm/mxmap/ImageLibraryManager,ibm/tivoli/fwm/mxmap/geolocation/MyCurrentLocation"],function(_3b7,dojo,_3b8){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationTool");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.toolbar.ext._ToggleTool");dojo.require("dijit.form.Button");dojo.require("ibm.tivoli.fwm.mxmap.ImageLibraryManager");dojo.require("ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation");ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus={DISABLED:-1,MARKER_CENTERED:0,MARKER_NOT_CENTERED:1};dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationTool",ibm.tivoli.fwm.mxmap.toolbar.ext._ToggleTool,{label:"My Location",iconClass:"basicMapToolbarBtn myLocationMapToolbarBtn",map:null,myLocationToolStatus:null,myLocationMarker:null,lbsCircle:null,imageLibManager:null,myCurrentLocationInstance:null,_executedAtLeastOnce:false,constructor:function(_3b9){dojo.mixin(this,_3b9);var _3ba=ibm.tivoli.fwm.i18n.getMaxMsg("map","mylocationtool");this.resetMyLocationTool();this.label=_3ba||this.label;this.imageLibManager=ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager();this.myCurrentLocationInstance=ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation.getMyCurrentLocationInstance();},disable:function(){},destroy:function(){this.resetMyLocationTool();this.destroyRecursive();},toggleStatus:function(){this.toggleMyLocationStatus();},toggleMyLocationStatus:function(){switch(this.myLocationToolStatus){case ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus.DISABLED:this.setActive(true);this.myLocationToolStatus=ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus.MARKER_CENTERED;this.watchMyLocationMarkerPosition();break;case ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus.MARKER_NOT_CENTERED:this.setActive(true);this.myLocationToolStatus=ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus.MARKER_CENTERED;this.setCenterAndUpdateMarkerPosition();break;case ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus.MARKER_CENTERED:this.resetMyLocationTool();break;default:break;}},setCenterAndUpdateMarkerPosition:function(){this._executedAtLeastOnce=true;if(this.myLocationToolStatus!=ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus.DISABLED){if(this.myCurrentLocationInstance){if(this.myCurrentLocationInstance.getPosition()&&this.myCurrentLocationInstance.getPosition().coords){var _3bb=this.myCurrentLocationInstance.getPosition().coords;var lat=_3bb.latitude;var lng=_3bb.longitude;var _3bc=_3bb.accuracy;var _3bd=new mxn.LatLonPoint(lat,lng);this.removeMyLocationMarker();this.createMyLocationMarker(_3bd,_3bc);if(this.myLocationToolStatus==ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus.MARKER_CENTERED){this.map.getMapstraction().endPan.removeHandler(this.endPanHandler,this);this.map.getMapstraction().endPan.addHandler(this.createEndPanHandler,this);this._center(_3bd);}}}}},_handler:null,watchMyLocationMarkerPosition:function(){if(this.myCurrentLocationInstance){this._handler=this.myCurrentLocationInstance.createListener(dojo.hitch(this,this.setCenterAndUpdateMarkerPosition),dojo.hitch(this,this.failedToGetLocation));this.myCurrentLocationInstance.listenToUserLocation(this._handler);}},convertedPoints:{},createMyLocationMarker:function(_3be,_3bf){var _3c0=function(_3c1){var p=_3c1[0];this.convertedPoints[_3be]=p;var _3c2=this.imageLibManager.getMyLocationMarkerImageInfo().generateMarkerData("");this.myLocationMarker=new mxn.Marker(p);this.createAccuracyCircle(p,_3bf);this.map.getMapstraction().addMarkerWithData(this.myLocationMarker,_3c2);};var _3c3=function(_3c4){console.error("error",_3c4);};this.map.getMapstraction().getAllPointsFromWGS84([_3be],dojo.hitch(this,_3c0),dojo.hitch(this,_3c3));},_center:function(_3c5){var _3c6=function(_3c7){var p=_3c7[0];this.map.getMapstraction().setCenter(p);};var _3c8=function(_3c9){console.error("error",_3c9);};this.map.getMapstraction().getAllPointsFromWGS84([_3c5],dojo.hitch(this,_3c6),dojo.hitch(this,_3c8));},removeMyLocationMarker:function(){if(this.myLocationMarker){this.map.getMapstraction().removeMarker(this.myLocationMarker);this.myLocationMarker=null;}if(this.lbsCircle){this.map.getMapstraction().removePolyline(this.lbsCircle);this.lbsCircle=null;}},failedToGetLocation:function(){if(this._executedAtLeastOnce==false){this.map.failedToGetLocation();this.resetMyLocationTool();}else{this.map.failedToGetLocationStatusMessages();}},resetMyLocationTool:function(){this.myLocationToolStatus=ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus.DISABLED;this.removeMyLocationMarker();this.stopWatchingMyLocationMarkerPosition();this._executedAtLeastOnce=false;this.setActive(false);},stopWatchingMyLocationMarkerPosition:function(){if(this.myCurrentLocationInstance!=null){this.myCurrentLocationInstance.removeListeners(this._handler);}},createEndPanHandler:function(){this.map.getMapstraction().endPan.removeHandler(this.createEndPanHandler,this);this.map.getMapstraction().endPan.addHandler(this.endPanHandler,this);},endPanHandler:function(_3ca,_3cb,_3cc){if(this.myLocationToolStatus==ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus.MARKER_CENTERED){this.myLocationToolStatus=ibm.tivoli.fwm.mxmap.toolbar.ext.MyLocationToolStatus.MARKER_NOT_CENTERED;}},createAccuracyCircle:function(_3cd,_3ce){if(this.lbsCircle==null){var _3cf=new mxn.Radius(_3cd,10);var _3d0=(_3ce/1000);if(this.lbsCircle){this.removeMyLocationMarker();}this.lbsCircle=_3cf.getPolyline(_3d0,"#C6DBEB");this.map.getMapstraction().addPolylineWithData(this.lbsCircle,{centerPoint:_3cd,width:3,opacity:0.5,fillColor:"#D0E0EC",closed:true,radiusInKMs:_3d0});}}});});},"ibm/tivoli/fwm/mxmap/toolbar/ext/QueryUnassignedWorkTool":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/toolbar/ext/_ToggleTool,dijit/form/Button"],function(_3d1,dojo,_3d2){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ext.QueryUnassignedWorkTool");dojo.require("ibm.tivoli.fwm.mxmap.toolbar.ext._ToggleTool");dojo.require("dijit.form.Button");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ext.QueryUnassignedWorkTool",ibm.tivoli.fwm.mxmap.toolbar.ext._ToggleTool,{label:"Unassigned Work Orders",iconClass:"basicMapToolbarBtn unassignedWorkOrderMapToolbarBtn",map:null,layerLabel:null,constructor:function(_3d3){dojo.mixin(this,_3d3);var _3d4=ibm.tivoli.fwm.i18n.getMaxMsg("map","unassignedworktool");this.label=_3d4||this.label;this.addSubscription(dojo.subscribe("onQueryUnassignedWorkResult_"+this.map.getId(),dojo.hitch(this,this.queryReturned)));this.addSubscription(dojo.subscribe("onWorkAssigned_"+this.map.getId(),dojo.hitch(this,this.onWorkAssigned)));this.addSubscription(dojo.subscribe("onQueryUnassignedWorkCancel_"+this.map.getId(),dojo.hitch(this,this.cancelQuery)));},onWorkAssigned:function(data){if(this.isActive()==true){dojo.publish("removeRecordsFromLayer_"+this.map.getId(),[this.layerLabel,[data]]);}},_lastQueryData:null,_lastQueryBounds:null,executeOn:function(){this._lastQueryBounds=this.map.getMapstraction().getBounds();this.map.getMaximo().showQueryUnassignedWorkDialog(this._lastQueryBounds);},executeOff:function(){this._clearUnassignedLayer();},_clearUnassignedLayer:function(){if(this.layerLabel!=null){dojo.publish("removeLayer_"+this.map.getId(),[this.layerLabel]);}},queryReturned:function(data,_3d5){var _3d6=_3d5&&_3d5.automatic;var _3d7=false;if(_3d5){_3d7=true;}if(data==null){if(!_3d6){this.map.getMaximo().showMessage("mapserver","noworkordersinarea");this.setActive(false);}return;}this._lastQueryData=data.queryData;if(data.records.length==0&&(!data.spatialEnabledRecords||data.spatialEnabledRecords.length==0)){if(!_3d6){if(data.error){this.map.getMaximo().showMessage(data.error.group,data.error.key,[data.error.params]);}else{this.map.getMaximo().showMessage("mapserver","noworkordersinarea");}this.setActive(false);}}else{this.layerLabel=data.layerLabel;if(data.spatialEnabledRecords!=null&&data.spatialEnabledRecords.length>0){var fct=function(mbos,_3d8){var _3d9=data.records.concat(mbos);if(_3d9.length==0){if(!_3d6){this.setActive(false);this.map.getMaximo().showMessage("mapserver","noworkordersinarea");}}else{this._addDefaultMarkerInfo(_3d9);dojo.publish("addRecordsToLayer_"+this.map.getId(),[data.layerLabel,_3d9,true,null,null,_3d7]);}};this.map.filterRecordsInMapView(data.spatialEnabledRecords,dojo.hitch(this,fct));}else{var _3da=data.records;this._addDefaultMarkerInfo(_3da);dojo.publish("addRecordsToLayer_"+this.map.getId(),[data.layerLabel,_3da,true,null,null,_3d7]);}}},_addDefaultMarkerInfo:function(_3db){var _3dc={"url":"../webclient/javascript/ibm/tivoli/fwm/mxmap/resources/symbology/workorder/map_WO_Unassigned.png","offsetx":24,"offsety":36,"width":47,"height":36};for(var i in _3db){_3db[i].ownDefaultMarker=_3dc;}},cancelQuery:function(data){this.setActive(false);},disable:function(){},destroy:function(){this.destroyRecursive();}});});},"ibm/tivoli/fwm/mxmap/layers/LayerWidget":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/_Widget,dijit/_Templated"],function(_3dd,dojo,_3de){dojo.provide("ibm.tivoli.fwm.mxmap.layers.LayerWidget");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.declare("ibm.tivoli.fwm.mxmap.layers.LayerWidget",[_3dd._Widget,_3dd._Templated],{templateString:dojo.cache("ibm.tivoli.fwm.mxmap","templates/LayerWidget.html","<div style=\"border: 1px solid #E0E0E0; border-bottom:0px\">\n<table style=\"width: 99%;height:35px;\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td data-dojo-attach-event=\"ondijitclick:_enableOrDisableLayer\" style=\"padding: 5px;\">\n\t\t\t\t<div data-dojo-attach-point=\"activeOrHiddenImage\"></div>\n\t\t\t</td>\n\t\t\t<td style=\"width: 90%;\" data-dojo-attach-event=\"ondijitclick:_enableOrDisableLayer\" >\n\t\t\t\t<div data-dojo-attach-point=\"layerInfo\"></div>\n\t\t\t</td>\n\t\t\t<td data-dojo-attach-event=\"ondijitclick:_showChildrenLayerWidget\" style=\"padding: 0px 4px 0px 12px; height: 35px;\">\n\t\t\t\t<div data-dojo-attach-point=\"submenu\" style=\"float:right;\"></div>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n</div>"),layer:null,_layerLeftImageDom:null,_layerRightImageDom:null,layerPanel:null,_symbologyPanelManager:null,constructor:function(_3df){dojo.mixin(this,_3df);},postCreate:function(){this.layerInfo.innerHTML=this.layer.getLayerName();var _3e0=this.layer.getLeftIconURL();if(_3e0!=null){this._layerLeftImageDom=dojo.create("img",{src:_3e0},this.activeOrHiddenImage,"only");dojo.style(this._layerLeftImageDom,{opacity:1,visibility:"visible"});}var _3e1=this.layer.getRightIconURL();this._layerRightImageDom=dojo.create("img",{src:_3e1},this.submenu,"last");if(_3e1==null){dojo.style(this._layerRightImageDom,{visibility:"hidden"});}dojo.style(this.layerInfo,"float",(document.body.dir=="rtl")?"right":"left");},_showChildrenLayerWidget:function(){if(this.layer.hasChildren()==true){var _3e2=new ibm.tivoli.fwm.mxmap.layers.LayerPanelWidget({map:this.layerPanel.map,title:this.layer.getChildrenTitle()});_3e2.updateLayers(this.layer.getChildren());this.layerPanel.close();}},_enableOrDisableLayer:function(){this.layer.toggleState();if(this.layerPanel){this.layerPanel.close();}},destroyRecursive:function(){this.inherited(arguments);if(this._layerImageDom){dojo.destroy(this._layerImageDom);}if(this._layerRightImageDom){dojo.destroy(this._layerRightImageDom);}}});});},"dojo/uacss":function(){define("dojo/uacss",["./dom-geometry","./_base/lang","./ready","./_base/sniff","./_base/window"],function(_3e3,lang,_3e4,has,_3e5){var html=_3e5.doc.documentElement,ie=has("ie"),_3e6=has("opera"),maj=Math.floor,ff=has("ff"),_3e7=_3e3.boxModel.replace(/-/,""),_3e8={"dj_ie":ie,"dj_ie6":maj(ie)==6,"dj_ie7":maj(ie)==7,"dj_ie8":maj(ie)==8,"dj_ie9":maj(ie)==9,"dj_quirks":has("quirks"),"dj_iequirks":ie&&has("quirks"),"dj_opera":_3e6,"dj_khtml":has("khtml"),"dj_webkit":has("webkit"),"dj_safari":has("safari"),"dj_chrome":has("chrome"),"dj_gecko":has("mozilla"),"dj_ff3":maj(ff)==3};_3e8["dj_"+_3e7]=true;var _3e9="";for(var clz in _3e8){if(_3e8[clz]){_3e9+=clz+" ";}}html.className=lang.trim(html.className+" "+_3e9);_3e4(90,function(){if(!_3e3.isBodyLtr()){var _3ea="dj_rtl dijitRtl "+_3e9.replace(/ /g,"-rtl ");html.className=lang.trim(html.className+" "+_3ea+"dj_rtl dijitRtl "+_3e9.replace(/ /g,"-rtl "));}});return has;});},"dijit/Tooltip":function(){require({cache:{"url:dijit/templates/Tooltip.html":"<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\"\n\t><div class=\"dijitTooltipContainer dijitTooltipContents\" data-dojo-attach-point=\"containerNode\" role='alert'></div\n\t><div class=\"dijitTooltipConnector\" data-dojo-attach-point=\"connectorNode\"></div\n></div>\n"}});define("dijit/Tooltip",["dojo/_base/array","dojo/_base/declare","dojo/_base/fx","dojo/dom","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","./_base/manager","./place","./_Widget","./_TemplatedMixin","./BackgroundIframe","dojo/text!./templates/Tooltip.html","."],function(_3eb,_3ec,fx,dom,_3ed,_3ee,_3ef,lang,has,win,_3f0,_3f1,_3f2,_3f3,_3f4,_3f5,_3f6){var _3f7=_3ec("dijit._MasterTooltip",[_3f2,_3f3],{duration:_3f0.defaultDuration,templateString:_3f5,postCreate:function(){win.body().appendChild(this.domNode);this.bgIframe=new _3f4(this.domNode);this.fadeIn=fx.fadeIn({node:this.domNode,duration:this.duration,onEnd:lang.hitch(this,"_onShow")});this.fadeOut=fx.fadeOut({node:this.domNode,duration:this.duration,onEnd:lang.hitch(this,"_onHide")});},show:function(_3f8,_3f9,_3fa,rtl,_3fb){if(this.aroundNode&&this.aroundNode===_3f9&&this.containerNode.innerHTML==_3f8){return;}this.domNode.width="auto";if(this.fadeOut.status()=="playing"){this._onDeck=arguments;return;}this.containerNode.innerHTML=_3f8;this.set("textDir",_3fb);this.containerNode.align=rtl?"right":"left";var pos=_3f1.around(this.domNode,_3f9,_3fa&&_3fa.length?_3fa:_3fc.defaultPosition,!rtl,lang.hitch(this,"orient"));var _3fd=pos.aroundNodePos;if(pos.corner.charAt(0)=="M"&&pos.aroundCorner.charAt(0)=="M"){this.connectorNode.style.top=_3fd.y+((_3fd.h-this.connectorNode.offsetHeight)>>1)-pos.y+"px";this.connectorNode.style.left="";}else{if(pos.corner.charAt(1)=="M"&&pos.aroundCorner.charAt(1)=="M"){this.connectorNode.style.left=_3fd.x+((_3fd.w-this.connectorNode.offsetWidth)>>1)-pos.x+"px";}}_3ef.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=true;this.aroundNode=_3f9;},orient:function(node,_3fe,_3ff,_400,_401){this.connectorNode.style.top="";var _402=_400.w-this.connectorNode.offsetWidth;node.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[_3fe+"-"+_3ff];this.domNode.style.width="auto";var size=_3ee.getContentBox(this.domNode);var _403=Math.min((Math.max(_402,1)),size.w);var _404=_403<size.w;this.domNode.style.width=_403+"px";if(_404){this.containerNode.style.overflow="auto";var _405=this.containerNode.scrollWidth;this.containerNode.style.overflow="visible";if(_405>_403){_405=_405+_3ef.get(this.domNode,"paddingLeft")+_3ef.get(this.domNode,"paddingRight");this.domNode.style.width=_405+"px";}}if(_3ff.charAt(0)=="B"&&_3fe.charAt(0)=="B"){var mb=_3ee.getMarginBox(node);var _406=this.connectorNode.offsetHeight;if(mb.h>_400.h){var _407=_400.h-((_401.h+_406)>>1);this.connectorNode.style.top=_407+"px";this.connectorNode.style.bottom="";}else{this.connectorNode.style.bottom=Math.min(Math.max(_401.h/2-_406/2,0),mb.h-_406)+"px";this.connectorNode.style.top="";}}else{this.connectorNode.style.top="";this.connectorNode.style.bottom="";}return Math.max(0,size.w-_402);},_onShow:function(){if(has("ie")){this.domNode.style.filter="";}},hide:function(_408){if(this._onDeck&&this._onDeck[1]==_408){this._onDeck=null;}else{if(this.aroundNode===_408){this.fadeIn.stop();this.isShowingNow=false;this.aroundNode=null;this.fadeOut.play();}else{}}},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";if(this._onDeck){this.show.apply(this,this._onDeck);this._onDeck=null;}},_setAutoTextDir:function(node){this.applyTextDir(node,has("ie")?node.outerText:node.textContent);_3eb.forEach(node.children,function(_409){this._setAutoTextDir(_409);},this);},_setTextDirAttr:function(_40a){this._set("textDir",typeof _40a!="undefined"?_40a:"");if(_40a=="auto"){this._setAutoTextDir(this.containerNode);}else{this.containerNode.dir=this.textDir;}}});_3f6.showTooltip=function(_40b,_40c,_40d,rtl,_40e){if(!_3fc._masterTT){_3f6._masterTT=_3fc._masterTT=new _3f7();}return _3fc._masterTT.show(_40b,_40c,_40d,rtl,_40e);};_3f6.hideTooltip=function(_40f){return _3fc._masterTT&&_3fc._masterTT.hide(_40f);};var _3fc=_3ec("dijit.Tooltip",_3f2,{label:"",showDelay:400,connectId:[],position:[],_setConnectIdAttr:function(_410){_3eb.forEach(this._connections||[],function(_411){_3eb.forEach(_411,lang.hitch(this,"disconnect"));},this);this._connectIds=_3eb.filter(lang.isArrayLike(_410)?_410:(_410?[_410]:[]),function(id){return dom.byId(id);});this._connections=_3eb.map(this._connectIds,function(id){var node=dom.byId(id);return [this.connect(node,"onmouseenter","_onHover"),this.connect(node,"onmouseleave","_onUnHover"),this.connect(node,"onfocus","_onHover"),this.connect(node,"onblur","_onUnHover")];},this);this._set("connectId",_410);},addTarget:function(node){var id=node.id||node;if(_3eb.indexOf(this._connectIds,id)==-1){this.set("connectId",this._connectIds.concat(id));}},removeTarget:function(node){var id=node.id||node,idx=_3eb.indexOf(this._connectIds,id);if(idx>=0){this._connectIds.splice(idx,1);this.set("connectId",this._connectIds);}},buildRendering:function(){this.inherited(arguments);_3ed.add(this.domNode,"dijitTooltipData");},startup:function(){this.inherited(arguments);var ids=this.connectId;_3eb.forEach(lang.isArrayLike(ids)?ids:[ids],this.addTarget,this);},_onHover:function(e){if(!this._showTimer){var _412=e.target;this._showTimer=setTimeout(lang.hitch(this,function(){this.open(_412);}),this.showDelay);}},_onUnHover:function(){if(this._focus){return;}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}this.close();},open:function(_413){if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}_3fc.show(this.label||this.domNode.innerHTML,_413,this.position,!this.isLeftToRight(),this.textDir);this._connectNode=_413;this.onShow(_413,this.position);},close:function(){if(this._connectNode){_3fc.hide(this._connectNode);delete this._connectNode;this.onHide();}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}},onShow:function(){},onHide:function(){},uninitialize:function(){this.close();this.inherited(arguments);}});_3fc._MasterTooltip=_3f7;_3fc.show=_3f6.showTooltip;_3fc.hide=_3f6.hideTooltip;_3fc.defaultPosition=["after","before"];return _3fc;});},"dojo/string":function(){define("dojo/string",["./_base/kernel","./_base/lang"],function(dojo,lang){lang.getObject("string",true,dojo);dojo.string.rep=function(str,num){if(num<=0||!str){return "";}var buf=[];for(;;){if(num&1){buf.push(str);}if(!(num>>=1)){break;}str+=str;}return buf.join("");};dojo.string.pad=function(text,size,ch,end){if(!ch){ch="0";}var out=String(text),pad=dojo.string.rep(ch,Math.ceil((size-out.length)/ch.length));return end?out+pad:pad+out;};dojo.string.substitute=function(_414,map,_415,_416){_416=_416||dojo.global;_415=_415?lang.hitch(_416,_415):function(v){return v;};return _414.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(_417,key,_418){var _419=lang.getObject(key,false,map);if(_418){_419=lang.getObject(_418,false,_416).call(_416,_419,key);}return _415(_419,key).toString();});};dojo.string.trim=String.prototype.trim?lang.trim:function(str){str=str.replace(/^\s+/,"");for(var i=str.length-1;i>=0;i--){if(/\S/.test(str.charAt(i))){str=str.substring(0,i+1);break;}}return str;};return dojo.string;});},"url:dijit/templates/MenuSeparator.html":"<tr class=\"dijitMenuSeparator\">\n\t<td class=\"dijitMenuSeparatorIconCell\">\n\t\t<div class=\"dijitMenuSeparatorTop\"></div>\n\t\t<div class=\"dijitMenuSeparatorBottom\"></div>\n\t</td>\n\t<td colspan=\"3\" class=\"dijitMenuSeparatorLabelCell\">\n\t\t<div class=\"dijitMenuSeparatorTop dijitMenuSeparatorLabel\"></div>\n\t\t<div class=\"dijitMenuSeparatorBottom\"></div>\n\t</td>\n</tr>","ibm/tivoli/fwm/mxmap/routing/RouterFactory":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_41a,dojo,_41b){dojo.provide("ibm.tivoli.fwm.mxmap.routing.RouterFactory");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.routing.RouterFactory",ibm.tivoli.fwm.mxmap._Base,{provider:null,router:null,map:null,constructor:function(_41c){dojo.mixin(this,_41c);},createRouter:function(_41d){var _41e="ibm.tivoli.fwm.mxmap.routing.impl."+this.provider;var _41f="dojo."+"require('"+_41e+"')";eval(_41f);if(this.provider=="bingmaps"&&this.router!=null){return this.router;}this._params=_41d;var _420=" this._routerInstance = new ibm.tivoli.fwm.mxmap.routing.impl."+this.provider+"(this._params)";eval(_420);if(this.provider=="bingmaps"){this.router=this._routerInstance;}return this._routerInstance;}});});},"dijit/dijit":function(){define("dijit/dijit",[".","./_base","dojo/parser","./_Widget","./_TemplatedMixin","./_Container","./layout/_LayoutWidget","./form/_FormWidget","./form/_FormValueWidget"],function(_421){return _421;});},"ibm/tivoli/fwm/mxmap/routing/itinerary/Leg":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/_Widget,dijit/_Templated,ibm/tivoli/fwm/mxmap/routing/itinerary/Step,ibm/tivoli/fwm/mxmap/routing/Router"],function(_422,dojo,_423){dojo.provide("ibm.tivoli.fwm.mxmap.routing.itinerary.Leg");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("ibm.tivoli.fwm.mxmap.routing.itinerary.Step");dojo.require("ibm.tivoli.fwm.mxmap.routing.Router");dojo.declare("ibm.tivoli.fwm.mxmap.routing.itinerary.Leg",[_422._Widget,_422._Templated,ibm.tivoli.fwm.mxmap._Base],{templateString:dojo.cache("ibm.tivoli.fwm.mxmap","templates/Leg.html","<div  style=\"width:100%;margin-bottom:10px;\">\n<div data-dojo-attach-point=\"distanceNode\" style=\"text-align: center;width: 100%;\"></div>\n<div data-dojo-attach-point=\"stepsNode\"></div>\n<div data-dojo-attach-event=\"ondijitclick:_onClick\" data-dojo-attach-point=\"legInfo\" style=\"background-color: #FAFAFA;border: 1px solid #E0E0E0;margin: 1px;padding: 10px 2px;\">\n<span data-dojo-attach-point=\"markerNode\" style=\"float:left;margin-top:-10px\"></span>\n<span data-dojo-attach-point=\"endLocDescNode\"></span>\n</div>\n</div>"),location:null,info:null,marker:null,steps:[],stepWidgets:[],needsToGeocode:null,distanceToLeg:null,durationToLeg:null,distanceUnit:null,map:null,_maxMarkerImageWidth:47,setMap:function(map){this.map=map;},constructor:function(_424){dojo.mixin(this,_424);this.steps=[];this.stepWidgets=[];},postCreate:function(){this.addressLoading=ibm.tivoli.fwm.i18n.getMaxMsg("map","address_being_loaded");this.failedToLoadAddress=ibm.tivoli.fwm.i18n.getMaxMsg("map","address_info_not_found");if(this.distanceToLeg!=null){this.distanceNode.innerHTML=ibm.tivoli.fwm.mxmap.routing.DistanceUnit.formatDistance(this.distanceToLeg,this.distanceUnit);this.distanceNode.innerHTML+=" - ";}if(this.durationToLeg!=null){this.distanceNode.innerHTML+=ibm.tivoli.fwm.mxmap.routing.DistanceUnit.formatTime(this.durationToLeg);}if(this.marker!=null){dojo.create("img",{src:this.marker.iconUrl},this.markerNode,"only");var _425=this.marker.labelText;if(_425){var _426=this._calculateLabelOffset(_425);var _427;var _428;if(dojo.isIE){_427=this.marker.attributes.iconAnchor[0]-_426;_428=6-this.marker.attributes.iconSize[1];}else{_428=9;_427=this.marker.attributes.iconAnchor[0]+4+_426;}_427+="px";_428+="px";dojo.create("div",{innerHTML:_425,style:{"float":"left","left":_427,"top":_428,"position":"relative","color":"white"}},this.markerNode,"last");}var _429=Math.floor(this._maxMarkerImageWidth/2);var _42a=this.marker.attributes.iconSize[0]-this.marker.attributes.iconAnchor[0];if(_42a<_429){var _42b=(_429-_42a)+"px";dojo.style(this.markerNode,"marginLeft",_42b);dojo.style(this.markerNode,"marginRight",_42b);}}if(this.info||this.needsToGeocode==true){if(this.needsToGeocode==true){var _42c=function(_42d){var _42e=_42d[0].formattedAddress;this.endLocDescNode.innerHTML=_42e;this.needsToGeocode=false;this.info=_42e;};var _42f=function(_430){this.endLocDescNode.innerHTML=this.failedToLoadAddress;};this.map.geocoder.reverseGeocode(this.location.lat,this.location.lng,dojo.hitch(this,_42c),dojo.hitch(this,_42f));this.endLocDescNode.innerHTML=this.addressLoading;}else{this.endLocDescNode.innerHTML=this.info;}}for(var i=0;i<this.steps.length;i++){var step=this.steps[i];step.position=i+1;step.distanceUnit=this.distanceUnit;step.map=this.map;step.closeDialog=this.closeDialog;var _431=new ibm.tivoli.fwm.mxmap.routing.itinerary.Step(step,this.map);dojo.place(_431.domNode,this.stepsNode,"last");this.stepWidgets.push(_431);}},_onClick:function(evt){this.map.getMapstraction().setCenter(this.location);this.closeDialog();},_calculateLabelOffset:function(_432){var _433=0;var _434=parseInt(_432);if((_434/100)>=1){_433=7;}else{if((_434/10)>=1){_433=4;}}return _433;}});});},"dijit/form/DropDownButton":function(){require({cache:{"url:dijit/form/templates/DropDownButton.html":"<span class=\"dijit dijitReset dijitInline\"\n\t><span class='dijitReset dijitInline dijitButtonNode'\n\t\tdata-dojo-attach-event=\"ondijitclick:_onClick\" data-dojo-attach-point=\"_buttonNode\"\n\t\t><span class=\"dijitReset dijitStretch dijitButtonContents\"\n\t\t\tdata-dojo-attach-point=\"focusNode,titleNode,_arrowWrapperNode\"\n\t\t\trole=\"button\" aria-haspopup=\"true\" aria-labelledby=\"${id}_label\"\n\t\t\t><span class=\"dijitReset dijitInline dijitIcon\"\n\t\t\t\tdata-dojo-attach-point=\"iconNode\"\n\t\t\t></span\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"\n\t\t\t\tdata-dojo-attach-point=\"containerNode,_popupStateNode\"\n\t\t\t\tid=\"${id}_label\"\n\t\t\t></span\n\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonInner\"></span\n\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonChar\">&#9660;</span\n\t\t></span\n\t></span\n\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" class=\"dijitOffScreen\" tabIndex=\"-1\"\n\t\tdata-dojo-attach-point=\"valueNode\"\n/></span>\n"}});define("dijit/form/DropDownButton",["dojo/_base/declare","dojo/_base/lang","dojo/query","../registry","../popup","./Button","../_Container","../_HasDropDown","dojo/text!./templates/DropDownButton.html"],function(_435,lang,_436,_437,_438,_439,_43a,_43b,_43c){return _435("dijit.form.DropDownButton",[_439,_43a,_43b],{baseClass:"dijitDropDownButton",templateString:_43c,_fillContent:function(){if(this.srcNodeRef){var _43d=_436("*",this.srcNodeRef);this.inherited(arguments,[_43d[0]]);this.dropDownContainer=this.srcNodeRef;}},startup:function(){if(this._started){return;}if(!this.dropDown&&this.dropDownContainer){var _43e=_436("[widgetId]",this.dropDownContainer)[0];this.dropDown=_437.byNode(_43e);delete this.dropDownContainer;}if(this.dropDown){_438.hide(this.dropDown);}this.inherited(arguments);},isLoaded:function(){var _43f=this.dropDown;return (!!_43f&&(!_43f.href||_43f.isLoaded));},loadDropDown:function(_440){var _441=this.dropDown;var _442=_441.on("load",lang.hitch(this,function(){_442.remove();_440();}));_441.refresh();},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown;}});});},"dijit/form/_FormValueMixin":function(){define("dijit/form/_FormValueMixin",["dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/sniff","./_FormWidgetMixin"],function(_443,_444,keys,has,_445){return _443("dijit.form._FormValueMixin",_445,{readOnly:false,_setReadOnlyAttr:function(_446){_444.set(this.focusNode,"readOnly",_446);this.focusNode.setAttribute("aria-readonly",_446);this._set("readOnly",_446);},postCreate:function(){this.inherited(arguments);if(has("ie")){this.connect(this.focusNode||this.domNode,"onkeydown",this._onKeyDown);}if(this._resetValue===undefined){this._lastValueReported=this._resetValue=this.value;}},_setValueAttr:function(_447,_448){this._handleOnChange(_447,_448);},_handleOnChange:function(_449,_44a){this._set("value",_449);this.inherited(arguments);},undo:function(){this._setValueAttr(this._lastValueReported,false);},reset:function(){this._hasBeenBlurred=false;this._setValueAttr(this._resetValue,true);},_onKeyDown:function(e){if(e.keyCode==keys.ESCAPE&&!(e.ctrlKey||e.altKey||e.metaKey)){var te;if(has("ie")<9||(has("ie")&&has("quirks"))){e.preventDefault();te=document.createEventObject();te.keyCode=keys.ESCAPE;te.shiftKey=e.shiftKey;e.srcElement.fireEvent("onkeypress",te);}}}});});},"dijit/form/_FormWidgetMixin":function(){define("dijit/form/_FormWidgetMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-style","dojo/_base/lang","dojo/mouse","dojo/_base/sniff","dojo/_base/window","dojo/window","../a11y"],function(_44b,_44c,_44d,_44e,lang,_44f,has,win,_450,a11y){return _44c("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:false,intermediateChanges:false,scrollOnFocus:true,_setIdAttr:"focusNode",postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onmousedown","_onMouseDown");},_setDisabledAttr:function(_451){this._set("disabled",_451);_44d.set(this.focusNode,"disabled",_451);if(this.valueNode){_44d.set(this.valueNode,"disabled",_451);}this.focusNode.setAttribute("aria-disabled",_451);if(_451){this._set("hovering",false);this._set("active",false);var _452="tabIndex" in this.attributeMap?this.attributeMap.tabIndex:("_setTabIndexAttr" in this)?this._setTabIndexAttr:"focusNode";_44b.forEach(lang.isArray(_452)?_452:[_452],function(_453){var node=this[_453];if(has("webkit")||a11y.hasDefaultTabStop(node)){node.setAttribute("tabIndex","-1");}else{node.removeAttribute("tabIndex");}},this);}else{if(this.tabIndex!=""){this.set("tabIndex",this.tabIndex);}}},_onFocus:function(e){if(this.scrollOnFocus){_450.scrollIntoView(this.domNode);}this.inherited(arguments);},isFocusable:function(){return !this.disabled&&this.focusNode&&(_44e.get(this.domNode,"display")!="none");},focus:function(){if(!this.disabled&&this.focusNode.focus){try{this.focusNode.focus();}catch(e){}}},compare:function(val1,val2){if(typeof val1=="number"&&typeof val2=="number"){return (isNaN(val1)&&isNaN(val2))?0:val1-val2;}else{if(val1>val2){return 1;}else{if(val1<val2){return -1;}else{return 0;}}}},onChange:function(){},_onChangeActive:false,_handleOnChange:function(_454,_455){if(this._lastValueReported==undefined&&(_455===null||!this._onChangeActive)){this._resetValue=this._lastValueReported=_454;}this._pendingOnChange=this._pendingOnChange||(typeof _454!=typeof this._lastValueReported)||(this.compare(_454,this._lastValueReported)!=0);if((this.intermediateChanges||_455||_455===undefined)&&this._pendingOnChange){this._lastValueReported=_454;this._pendingOnChange=false;if(this._onChangeActive){if(this._onChangeHandle){clearTimeout(this._onChangeHandle);}this._onChangeHandle=setTimeout(lang.hitch(this,function(){this._onChangeHandle=null;this.onChange(_454);}),0);}}},create:function(){this.inherited(arguments);this._onChangeActive=true;},destroy:function(){if(this._onChangeHandle){clearTimeout(this._onChangeHandle);this.onChange(this._lastValueReported);}this.inherited(arguments);},_onMouseDown:function(e){if((!this.focused||!has("ie"))&&!e.ctrlKey&&_44f.isLeft(e)&&this.isFocusable()){var _456=this.connect(win.body(),"onmouseup",function(){if(this.isFocusable()){this.focus();}this.disconnect(_456);});}}});});},"ibm/tivoli/fwm/mxmap/util/AddressCandidatesFormatter":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/panels/MobileInfoPanelLine"],function(_457,dojo,_458){dojo.provide("ibm.tivoli.fwm.mxmap.util.AddressCandidatesFormatter");dojo.require("ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelLine");ibm.tivoli.fwm.mxmap.util.AddressCandidatesFormatter.createHTMLDOMWithList=function(_459,_45a,_45b,_45c){var _45d=dojo.create("div");var _45e=_45b-25;var _45f=dojo.create("table",{role:"grid",valign:"top",width:"100%","class":"addressCandidateTable"},_45d,"last");var _460=dojo.create("tbody",{},_45f,"last");var _461=function(_462){return function(){dojo.publish("addressCandidateSelectedOnMapId_"+_45a,[_462]);};};if(_459.length>10){_459=_459.slice(0,10);}for(var _463 in _459){var _464=_459[_463];var _465=_463%2!=0?"":"addresscandidateRowStyle";var _466=_461(_464);var _467=_464.formattedAddress;var _468=new ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelLine();_468.setRowClass(_465);_468.setCallbackFunction(_466);_468.setContent(_467);_468.placeAt(_460,"last");}return _45d;};});},"ibm/tivoli/fwm/mxmap/routing/Route":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_469,dojo,_46a){dojo.provide("ibm.tivoli.fwm.mxmap.routing.Route");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.routing.Route",ibm.tivoli.fwm.mxmap._Base,{totalDuration:0,inputInfo:null,totalDistance:0,stops:[],legsData:null,routeBounds:null,copyrights:null,polyline:null,markers:null,map:null,itinerary:null,initialConf:null,originalRouter:null,distanceUnit:null,lineVisible:true,setItinerary:function(data){this.itinerary=data;},customMarkerOptions:null,constructor:function(_46b){dojo.mixin(this,_46b);},zoomToRoute:function(){try{this.map.getMapstraction().setBounds(this.getBounds());}catch(e){console.error("zoom to route",e);}},getBounds:function(){if(this.routeBounds==null){this.routeBounds=this.map.getMapstraction().getBoundingBoxFromPoints(this.polyline.points);this.routeBounds.merge(this.map.getMapstraction().getBoundingBoxFromPoints(this.stops));}return this.routeBounds;},clear:function(){for(var i=0;i<this.inputInfo.stops.length;i++){try{if(this.inputInfo.stops[i].calculatedStop!=true){this.map.removeMboFromLayerManager(this.inputInfo.stops[i]);}}catch(e){}}this.hideCalculatedMarkers();this.markers=null;if(this.polyline){try{this.map.getMapstraction().removePolyline(this.polyline);}catch(e){console.error("cannot remove polyline");}}},show:function(){if(this.lineVisible){this.map.getMapstraction().addPolyline(this.polyline);}if(this.markers==null){this._createMarkers();}},redraw:function(){this.clear();this.show();},_addMarker:function(p,_46c){var m=new mxn.Marker(p);m.label=String(_46c);var _46d=(_46c>0)?ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager().getEndPositionMarkerImageInfo():ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager().getStartPositionMarkerImageInfo();var aa={label:"",tooltip:"",draggable:false,icon:_46d.getImageURL(),iconSize:_46d.getImageSize(),iconAnchor:_46d.getImageAnchor(),hover:true};this.map.getMapstraction().addMarkerWithData(m,aa);return m;},_woStopNumber:1,_addNewMarker:function(_46e){if(this.inputInfo.stops[_46e].calculatedStop!=true){var _46f=this.inputInfo.stops[_46e];_46f.routeInfo={stopNumber:_46e};var _470=_46e;var fct=function(_471){this.markers[_470]=_471;};var _472="";var _473="";if(_46f&&_46f.mxdata&&(_46f.mxdata.mboName=="WORKORDER"||_46f.mxdata.extendsMboName=="WORKORDER")){if(this.map.isMobile!=true){_473=_46f.mxdata.attributes.wonum;}_472=String(this._woStopNumber++);}var _474={"draggable":false,"enableMapTips":true,"label":_472,"tooltip":_473,"color":this.originalRouter.routecolor,"markerReferenceCallback":dojo.hitch(this,fct)};this.map.addMboToLayerManager(_46f,_474);}else{var m=this._addMarker(this.stops[_46e],_46e);this.markers[_46e]=m;this.markers[_46e].calculated=true;}},getMarkerForStop:function(_475){if(this.markers!=null&&this.markers.length>_475){return this.markers[_475];}else{return null;}},_createMarkers:function(){this.markers=[];var _476=this.itinerary.getInitialLocation();var _477=1;if(_476){var p=_476.location;this._addNewMarker(0);}for(var i=1;i<this.stops.length;i++){var p=this.stops[i];this._addNewMarker(i);}},avoidTollsSupported:true,setSupportAvoidToll:function(_478){this.avoidTollsSupported=_478;},avoidHighwaysSupported:true,setSupportAvoidHighway:function(_479){this.avoidHighwaysSupported=_479;},hideCalculatedMarkers:function(){if(this.markers!=null){for(var i=0;i<this.markers.length;i++){try{if(this.markers[i].calculated==true){this.map.getMapstraction().removeMarker(this.markers[i]);}}catch(e){}}}},showCalculatedMarkers:function(){if(this.markers!=null){for(var i=0;i<this.markers.length;i++){try{if(this.markers[i].calculated==true){var m=this._addMarker(this.stops[i],i);this.markers[i]=m;this.markers[i].calculated=true;}}catch(e){}}}},setLineVisible:function(_47a){if(_47a==this.lineVisible){return;}this.lineVisible=_47a;if(this.lineVisible==true){this.map.getMapstraction().addPolyline(this.polyline);}else{this.map.getMapstraction().removePolyline(this.polyline);}}});});},"ibm/tivoli/fwm/mxmap/routing/impl/spatial":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/routing/Router,ibm/tivoli/fwm/mxmap/routing/Route"],function(_47b,dojo,_47c){dojo.provide("ibm.tivoli.fwm.mxmap.routing.impl.spatial");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.routing.Router");dojo.require("ibm.tivoli.fwm.mxmap.routing.Route");dojo.declare("ibm.tivoli.fwm.mxmap.routing.impl.spatial",[ibm.tivoli.fwm.mxmap.routing.Router,ibm.tivoli.fwm.mxmap._Base],{directionsService:null,map:null,_stopSymbol:null,_routeSymbol:null,_spatialReference:null,_esriMap:null,_spatialReference:null,conf:null,_lastStop:null,_routeParams:null,_successCallback:null,_failureCallback:null,_routeLimits:10,_oldWGS84Point:null,constructor:function(_47d){dojo.mixin(this,_47d);this.directionsService=new esri.tasks.RouteTask(this.routeUrl);this._stopSymbol=new esri.symbol.SimpleMarkerSymbol().setStyle(esri.symbol.SimpleMarkerSymbol.STYLE_CROSS).setSize(15);this._stopSymbol.outline.setWidth(4);if(this.routecolor.indexOf("#")!=0){this.routecolor="#"+this.routecolor;}this._routeSymbol=new esri.symbol.SimpleLineSymbol().setColor(new dojo.Color()).setWidth(this.routeLineWidth);this._esriMap=this.map.getMapstraction().getProviderMap();this._spatialReference=this._esriMap.spatialReference;},_onSolveRoute:function(_47e,_47f){if(_47f){_47f(_47e);}},_routeFailed:function(_480,_481,_482){if(_481){if(!_482){_482=ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.UNKNOWN;}_481(_482,_480);}},_createStop:function(lat,lng,text){var _483=new esri.geometry.Point(lng,lat,this._spatialReference);var ss=new esri.symbol.TextSymbol(text).setColor(new dojo.Color([256,0,0])).setAlign(esri.symbol.Font.ALIGN_START).setFont(new esri.symbol.Font("12pt").setWeight(esri.symbol.Font.WEIGHT_BOLD));var stop=new esri.Graphic(_483,ss);if(window.DEBUGLEVEL&&window.DEBUGLEVEL>1){this.map.getMapstraction().getProviderMap().graphics.add(stop);}return stop;},_prepareParams:function(_484,_485,_486){this._routeParams.stops=new esri.tasks.FeatureSet();for(var i=_484;i<_485;i++){var stop=_486[i];var _487=null;if(stop.hasOwnProperty("gisdata")==true){var _488=new ibm.tivoli.fwm.mxmap.MXRecord({mboInfo:stop,map:this.map});if(_488.hasSPATIALCoordinates()){var _489=this.map.getPointFromMboInfo(_488.mboInfo);_487=this._createStop(_489.lat,_489.lng,i);}else{if(_488.hasGISCoordinates()){_487=this._createStop(stop.gisdata.lat,stop.gisdata.lng,i);}else{if(_488.hasAutolocateSpatialData()){var _489=this.map.getPointFromMboInfo(_488.mboInfo.autolocate);_487=this._createStop(_489.lat,_489.lng,i);}else{if(_488.hasAutolocateGISCoordinates()){_487=this._createStop(stop.autolocate.gisdata.lat,stop.autolocate.gisdata.lng,i);}else{console.warn("Stop doesn't have gis coords",stop);}}}}}else{if(stop.lat==null){console.error("stop does not have lat/lng",stop);}else{_487=this._createStop(stop.lat,stop.lng,i);}}this._routeParams.stops.features.push(_487);}},_getStops2LatLng:function(_48a){var lls=[];for(var _48b=0;_48b<_48a.length;_48b++){lls.push(new mxn.LatLonPoint(_48a[_48b].lat,_48a[_48b].lng));}return lls;},showRoute:function(_48c,_48d,_48e){if(this._checkIfAnyFeaturedClass(_48c)==true){var fct=function(){this._showRouteAllPointsWithXY(_48c,_48d,_48e);};this._convertAnyFeatureStop(_48c,dojo.hitch(this,fct),_48e);}else{this._showRouteAllPointsWithXY(_48c,_48d,_48e);}},_convertAnyFeatureStop:function(_48f,_490,_491){var _492=[];for(var j=0;j<_48f.length;j++){var stop=_48f[j];if(stop.calculatedStop==null){var _493=new ibm.tivoli.fwm.mxmap.MXRecord({mboInfo:stop,map:this.map});if(_493.hasSPATIALCoordinates()==true){_492.push(stop);}else{if(_493.hasAutolocateSpatialData()){_492.push(stop.autolocate);}else{console.warn("no SPATIAL GIS info for stop ",stop);}}}}var test=function(args){_490();};this.map.queryMultipleRecordsAtOnce(_492,test,_491);},_checkIfAnyFeaturedClass:function(_494){for(var i in _494){var stop=_494[i];var _495=new ibm.tivoli.fwm.mxmap.MXRecord({mboInfo:stop,map:this.map});if(_495.hasSPATIALCoordinates()||(_495.hasGISCoordinates()==false&&_495.hasAutolocateSpatialData()==true)){return true;}}},_retrieveStopInfo:function(pt,_496,_497,_498,_499){var txt="";if(_496.mxdata!=null&&_496.mxdata.attributes!=null&&_496.mxdata.attributes.formattedaddress!=null&&_496.mxdata.attributes.formattedaddress.length>0){_499[pt]=_496.mxdata.attributes.formattedaddress;txt=_499[pt];}else{var _497=_498.legs.length;var _49a=function(_49b){var _49c=_49b[0].formattedAddress;if(_497>=0){_498.legs[_497].info=_49c;}else{_498.initialLocation.info=_49c;}_499[pt]=_49c;};var _49d=function(_49e){console.error("could not find leg ",_497,"info");};this.map.geocoder.reverseGeocode(pt.lat,pt.lng,dojo.hitch(this,_49a),dojo.hitch(this,_49d));}return txt;},_getLatLngFromStop:function(_49f){var pt={};if(_49f.calculatedStop==true){pt.lat=_49f.lat;pt.lng=_49f.lng;}else{var _4a0=new ibm.tivoli.fwm.mxmap.MXRecord({mboInfo:_49f,map:this.map});if(_4a0.hasAutolocateGISOnlyCoordinates()){pt.lat=_49f.autolocate.gisdata.lat;pt.lng=_49f.autolocate.gisdata.lng;}else{pt.lat=_49f.gisdata.lat;pt.lng=_49f.gisdata.lng;}}return pt;},_showRouteAllPointsWithXY:function(_4a1,_4a2,_4a3){this._routeParams=new esri.tasks.RouteParameters();if(dojo.config.fwm.debug==true){}this._routeParams.outSpatialReference=new esri.SpatialReference({wkid:this._spatialReference});this._routeParams.returnDirections=true;if(this.isOptimizeRoute()){this._routeParams.findBestSequence=true;this._routeParams.preserveFirstStop=true;this._routeParams.preserveLastStop=true;}this._routeParams.directionsLengthUnits="esriKilometers";this._routeParams.returnRoutes=true;this._routeParams.returnStops=true;var _4a4=0;var _4a5={totalDuration:0,totalDistance:0,stops:[],legsData:null,polyline:null,copyrights:"",map:this.map};var _4a6=[];var th=this._startTimer();var _4a7=new ibm.tivoli.fwm.mxmap.routing.itinerary.Itinerary();var _4a8=0;var _4a9=function(_4aa){this._stopTimer(th,_4a1.length);if(_4aa.messages&&_4aa.messages.length>0){console.warn("Route service returend the following messages :");for(var i=0;i<_4aa.messages.length;i++){var msg=_4aa.messages[i];console.warn(msg.description,msg);}if(msg.type==50){this._routeFailed(msg,_4a3,ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.ZERO_RESULTS);return;}}var _4ab=_4aa.routeResults[0].directions;var _4ac=[];var c=1;var _4ad=0;var _4ae=0;var _4af=false;for(var i in _4aa.routeResults[0].directions.features){var _4b0=_4aa.routeResults[0].directions.features[i];var step={distance:_4b0.attributes.length,duration:_4b0.attributes.time,info:_4b0.attributes.text,location:this.map._getLatLngFromFeature(_4b0)};_4ac.push(step);_4ad+=_4b0.attributes.length;_4ae+=_4b0.attributes.time;if(_4af==true&&_4b0.attributes.length==0){var pt=this.map._getLatLngFromFeature(_4b0);var txt=_4b0.attributes.text;var lpos=_4a7.addLeg(pt,txt,_4ad,_4ae,null,_4ac,null);var _4b1=_4a1[lpos+1];var _4b2=true;if(_4b1.mxdata){var _4b3=new ibm.tivoli.fwm.mxmap.MXRecord({mboInfo:_4b1,map:this.map});if(_4b3.hasGISCoordinates()==true||_4b3.hasSPATIALCoordinates()==true){if(_4b3.hasAddress()==true){_4b2=false;_4a7.legs[lpos].info=_4b3.mboInfo.gisdata.address;}}else{if(_4b3.hasAutolocateGISOnlyCoordinates()==true||_4b3.hasAutolocateSpatialData()==true){var _4b4=_4b1.autolocate;if(_4b4.gisdata.address!=null&&_4b4.gisdata.address.length>0){_4b2=false;_4a7.legs[lpos].info=_4b4.gisdata.address;}}}}_4a7.legs[lpos].needsToGeocode=_4b2;_4ac=[];_4ad=0;_4ae=0;c++;_4af=false;}else{if(_4af==false&&_4b0.attributes.length==0){_4af=true;}}}if(_4a8==0){var geom=_4aa.routeResults[0].directions.features[0].geometry;var pt=this.map._getLatLngFromFeature(_4aa.routeResults[0].directions.features[0]);var txt=_4aa.routeResults[0].directions.features[0].attributes.text;_4a7.setInitialLocation(txt,pt,null,null,true);}var pol=new mxn.Polyline();pol.fromProprietary(this.map.getMapstraction().api,_4ab.mergedGeometry);_4a6=_4a6.concat(pol.points);_4a5.totalDistance+=_4ab.totalLength;_4a5.totalDuration+=_4ab.totalTime;if(_4a4<_4a1.length){_4a8=_4a4-1;_4a4=_4a4+this._routeLimits;if(_4a4>_4a1.length){_4a4=_4a1.length;}if((_4a4-_4a8)>=this._routeLimits){_4a4--;}this._prepareParams(_4a8,_4a4,_4a1);th=this._startTimer(th,_4a1.length);var _4b5=function(_4b6){this._routeFailed(_4b6,_4a3);};this.directionsService.solve(this._routeParams,dojo.hitch(this,_4a9),dojo.hitch(this,_4b5));}else{_4a5.itinerary=_4a7;_4a5.inputInfo={stops:_4a1,successCb:_4a2,errorCb:_4a3};_4a5.originalRouter=this;_4a5.distanceUnit=this.getCurrentDistanceUnit();var poly=new mxn.Polyline(_4a6);poly.addData({color:this.routecolor,opacity:this.routeOpacity,width:this.routeLineWidth});_4a5.polyline=poly;_4a5.stops=this._getStops2LatLng(_4a1);var _4b7=new ibm.tivoli.fwm.mxmap.routing.Route(_4a5);_4b7.setSupportAvoidToll(false);_4b7.setSupportAvoidHighway(false);this._onSolveRoute(_4b7,_4a2);if(dojo.config.fwm.debug==true){}this._stopTimer(null,_4a1.length);}};if(_4a1.length>this._routeLimits){_4a4=_4a4+this._routeLimits;}else{_4a4=_4a1.length;}this._prepareParams(_4a8,_4a4,_4a1);if(this._routeParams.stops.features.length>=2){var _4b8=function(_4b9){this._routeFailed(_4b9,_4a3);};this.directionsService.solve(this._routeParams,dojo.hitch(this,_4a9),dojo.hitch(this,_4b8));}},getUserLocation:function(_4ba,_4bb){if(this.myCurrentLocationInstance){var _4bc=function(){if(this.map){this.map.failedToGetLocation();}_4bb();};var _4bd=function(){this._convertToSpatialCoordSystem(_4ba);};this.myCurrentLocationInstance.getUserLocation(dojo.hitch(this,_4bd),dojo.hitch(this,_4bc));}},_convertToSpatialCoordSystem:function(_4be){var _4bf=function(_4c0){this.myCurrentLocationInstance._esriSRLatLng=_4c0;this.myCurrentLocationInstance._oldWGS84Point=this.myCurrentLocationInstance.getPosition();if(_4be){_4be();}};this.myCurrentLocationInstance.convertPositionToMapPoint(this.map,dojo.hitch(this,_4bf));},_isESRIUpToDate:function(){var _4c1=this.myCurrentLocationInstance.getPosition();var _4c2=this.myCurrentLocationInstance._oldWGS84Point;if(_4c2==null){this._convertToSpatialCoordSystem();return false;}if(_4c1.coords!=_4c2.coords){this._convertToSpatialCoordSystem();return false;}return true;},_getUserLocationStop:function(){return this.myCurrentLocationInstance._esriSRLatLng;},isLocationStatusUnassigned:function(){if(this.myCurrentLocationInstance.isStatusHasLocation()){return !this.isLocationStatusHasLocation();}return this.inherited(arguments);},isLocationStatusHasLocation:function(){if(this.myCurrentLocationInstance.isStatusHasLocation()){return this._isESRIUpToDate();}return this.inherited(arguments);}});});},"ibm/tivoli/fwm/mxmap/UserSessionManager":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_4c3,dojo,_4c4){dojo.provide("ibm.tivoli.fwm.mxmap.UserSessionManager");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.UserSessionManager",ibm.tivoli.fwm.mxmap._Base,{map:null,lastUserLocation:null,constructor:function(_4c5){dojo.mixin(this,_4c5);dojo.addOnUnload(dojo.hitch(this,this.onMapExit));if(this.map.getSessionData()&&this.map.getSessionData().lastUserLocation){this.lastUserLocation=dojo.fromJson(this.map.getSessionData().lastUserLocation);}},hasLastUserLocation:function(){if(this.lastUserLocation!=null&&this.lastUserLocation.lat&&this.lastUserLocation.lng){return true;}return false;},getLastUserLocation:function(){return this.lastUserLocation;},onMapExit:function(){var _4c6=this.map.getMapstraction();if(_4c6){var _4c7={lat:_4c6.getCenter().lat,lng:_4c6.getCenter().lng,level:_4c6.getZoom(),customData:this.map.getInitialLocationCustomInfo()};this.map.getMaximo().storeUserLocation(_4c7);}else{}}});});},"ibm/tivoli/fwm/mxmap/MXRecord":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/ImageLibraryManager"],function(_4c8,dojo,_4c9){dojo.provide("ibm.tivoli.fwm.mxmap.MXRecord");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.ImageLibraryManager");dojo.declare("ibm.tivoli.fwm.mxmap.MXRecord",ibm.tivoli.fwm.mxmap._Base,{mboInfo:null,map:null,markerImgUrl:null,markerImgInfo:null,lbsMarker:null,lbsMarkerImgInfo:null,lbsCircle:null,imageLibManager:null,isMboOnMap:false,constructor:function(_4ca){dojo.mixin(this,_4ca);},hasAddress:function(){return (this.mboInfo&&this.mboInfo.gisdata&&this.mboInfo.gisdata.address!=null&&this.mboInfo.gisdata.address!="");},hasGISCoordinates:function(){return (this.mboInfo&&this.mboInfo.gisdata!=null&&this.mboInfo.gisdata.lat!=null&&this.mboInfo.gisdata.lng!=null);},hasAutolocateGISCoordinates:function(){return (this.mboInfo&&this.mboInfo.autolocate!=null&&this.mboInfo.autolocate.gisdata!=null&&this.mboInfo.autolocate.gisdata.lng!=null)||this.hasAutolocateSpatialData();},hasAutolocateGISOnlyCoordinates:function(){return (this.mboInfo&&this.mboInfo.autolocate!=null&&this.mboInfo.autolocate.gisdata!=null&&this.mboInfo.autolocate.gisdata.lng!=null);},hasAutolocateSpatialData:function(){return (this.mboInfo&&this.mboInfo.autolocate!=null&&this.mboInfo.autolocate.gisdata!=null&&this.mboInfo.autolocate.gisdata.PLUSSISGIS!=null&&this.mboInfo.autolocate.gisdata.PLUSSISGIS==true);},hasAnyGISCoordinates:function(){return this.hasGISCoordinates()||this.hasAutolocateGISCoordinates()||this.hasSPATIALCoordinates();},hasLBSCoordinates:function(){return (this.mboInfo&&this.mboInfo.lbsdata&&this.mboInfo.lbsdata.lat!=null);},hasSPATIALCoordinates:function(){return (this.mboInfo&&this.mboInfo.gisdata!=null&&this.mboInfo.gisdata.PLUSSISGIS==true);},_removeMarker:function(){this.map.removeMboMarker(this.mboInfo);this.isMboOnMap=false;},serverUpdated:function(data){this.mboInfo=data;this.isMboOnMap=false;this._updateMarkerLocation(data);},_updateMarkerLocation:function(_4cb,_4cc){this._removeMarker();this.mboInfo=_4cb;if(this.hasAnyGISCoordinates()){this._placeMarker();if(_4cc!=true){this.center();}}},_placeMarker:function(){this.map.addMboToLayerManager(this.mboInfo);this.isMboOnMap=true;},center:function(){this.centerAndZoom();},centerAndZoom:function(_4cd){if(this.hasAnyGISCoordinates()){if(this.isMboOnMap==false){this._placeMarker();}this.map.centerOnMbo(this.mboInfo,_4cd);}},getMXLatLng:function(){return new mxn.LatLonPoint(this.mboInfo.gisdata.lat,this.mboInfo.gisdata.lng);},_isDraggable:function(){if(this.mboInfo.gisdata&&this.mboInfo.gisdata.flags&&this.mboInfo.gisdata.flags.readonly==true){return false;}return (this.draggable&&this.draggable==true);},hide:function(){},remove:function(){this._removeMarker();},show:function(){if(this.isMboOnMap==false){if(this.hasAnyGISCoordinates()==true){this._placeMarker();}}}});});},"dijit/layout/_ContentPaneResizeMixin":function(){define("dijit/layout/_ContentPaneResizeMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/_base/lang","dojo/query","dojo/_base/sniff","dojo/_base/window","../registry","./utils","../_Contained"],function(_4ce,_4cf,_4d0,_4d1,_4d2,lang,_4d3,has,win,_4d4,_4d5,_4d6){return _4cf("dijit.layout._ContentPaneResizeMixin",null,{doLayout:true,isLayoutContainer:true,startup:function(){if(this._started){return;}var _4d7=this.getParent();this._childOfLayoutWidget=_4d7&&_4d7.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);if(this._isShown()){this._onShow();}if(!this._childOfLayoutWidget){this.connect(has("ie")?this.domNode:win.global,"onresize",function(){this._needLayout=!this._childOfLayoutWidget;this.resize();});}},_checkIfSingleChild:function(){var _4d8=_4d3("> *",this.containerNode).filter(function(node){return node.tagName!=="SCRIPT";}),_4d9=_4d8.filter(function(node){return _4d0.has(node,"data-dojo-type")||_4d0.has(node,"dojoType")||_4d0.has(node,"widgetId");}),_4da=_4ce.filter(_4d9.map(_4d4.byNode),function(_4db){return _4db&&_4db.domNode&&_4db.resize;});if(_4d8.length==_4d9.length&&_4da.length==1){this._singleChild=_4da[0];}else{delete this._singleChild;}_4d1.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild);},resize:function(_4dc,_4dd){if(!this._wasShown&&this.open!==false){this._onShow();}this._resizeCalled=true;this._scheduleLayout(_4dc,_4dd);},_scheduleLayout:function(_4de,_4df){if(this._isShown()){this._layout(_4de,_4df);}else{this._needLayout=true;this._changeSize=_4de;this._resultSize=_4df;}},_layout:function(_4e0,_4e1){if(_4e0){_4d2.setMarginBox(this.domNode,_4e0);}var cn=this.containerNode;if(cn===this.domNode){var mb=_4e1||{};lang.mixin(mb,_4e0||{});if(!("h" in mb)||!("w" in mb)){mb=lang.mixin(_4d2.getMarginBox(cn),mb);}this._contentBox=_4d5.marginBox2contentBox(cn,mb);}else{this._contentBox=_4d2.getContentBox(cn);}this._layoutChildren();delete this._needLayout;},_layoutChildren:function(){if(this.doLayout){this._checkIfSingleChild();}if(this._singleChild&&this._singleChild.resize){var cb=this._contentBox||_4d2.getContentBox(this.containerNode);this._singleChild.resize({w:cb.w,h:cb.h});}else{_4ce.forEach(this.getChildren(),function(_4e2){if(_4e2.resize){_4e2.resize();}});}},_isShown:function(){if(this._childOfLayoutWidget){if(this._resizeCalled&&"open" in this){return this.open;}return this._resizeCalled;}else{if("open" in this){return this.open;}else{var node=this.domNode,_4e3=this.domNode.parentNode;return (node.style.display!="none")&&(node.style.visibility!="hidden")&&!_4d1.contains(node,"dijitHidden")&&_4e3&&_4e3.style&&(_4e3.style.display!="none");}}},_onShow:function(){if(this._needLayout){this._layout(this._changeSize,this._resultSize);}this.inherited(arguments);this._wasShown=true;}});});},"dijit/WidgetSet":function(){define("dijit/WidgetSet",["dojo/_base/array","dojo/_base/declare","dojo/_base/window","./registry"],function(_4e4,_4e5,win,_4e6){var _4e7=_4e5("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0;},add:function(_4e8){if(this._hash[_4e8.id]){throw new Error("Tried to register widget with id=="+_4e8.id+" but that id is already registered");}this._hash[_4e8.id]=_4e8;this.length++;},remove:function(id){if(this._hash[id]){delete this._hash[id];this.length--;}},forEach:function(func,_4e9){_4e9=_4e9||win.global;var i=0,id;for(id in this._hash){func.call(_4e9,this._hash[id],i++,this._hash);}return this;},filter:function(_4ea,_4eb){_4eb=_4eb||win.global;var res=new _4e7(),i=0,id;for(id in this._hash){var w=this._hash[id];if(_4ea.call(_4eb,w,i++,this._hash)){res.add(w);}}return res;},byId:function(id){return this._hash[id];},byClass:function(cls){var res=new _4e7(),id,_4ec;for(id in this._hash){_4ec=this._hash[id];if(_4ec.declaredClass==cls){res.add(_4ec);}}return res;},toArray:function(){var ar=[];for(var id in this._hash){ar.push(this._hash[id]);}return ar;},map:function(func,_4ed){return _4e4.map(this.toArray(),func,_4ed);},every:function(func,_4ee){_4ee=_4ee||win.global;var x=0,i;for(i in this._hash){if(!func.call(_4ee,this._hash[i],x++,this._hash)){return false;}}return true;},some:function(func,_4ef){_4ef=_4ef||win.global;var x=0,i;for(i in this._hash){if(func.call(_4ef,this._hash[i],x++,this._hash)){return true;}}return false;}});_4e4.forEach(["forEach","filter","byClass","map","every","some"],function(func){_4e6[func]=_4e7.prototype[func];});return _4e7;});},"dijit/nls/loading":function(){define({root:({loadingState:"Loading...",errorState:"Sorry, an error occurred"}),"zh":true,"zh-tw":true,"tr":true,"th":true,"sv":true,"sl":true,"sk":true,"ru":true,"ro":true,"pt":true,"pt-pt":true,"pl":true,"nl":true,"nb":true,"ko":true,"kk":true,"ja":true,"it":true,"hu":true,"hr":true,"he":true,"fr":true,"fi":true,"es":true,"el":true,"de":true,"da":true,"cs":true,"ca":true,"az":true,"ar":true});},"ibm/tivoli/fwm/mxmap/CurrentMXRecordSet":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/MXRecord"],function(_4f0,dojo,_4f1){dojo.provide("ibm.tivoli.fwm.mxmap.CurrentMXRecordSet");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.MXRecord");dojo.declare("ibm.tivoli.fwm.mxmap.CurrentMXRecordSet",ibm.tivoli.fwm.mxmap._Base,{map:null,records:null,mxRecords:null,mboInfoArray:null,markerImgUrl:null,_hidden:false,constructor:function(_4f2){dojo.mixin(this,_4f2);this.mxRecords=[];this.mboInfoArray=[];this.addSubscription(dojo.subscribe("onCurrentRecordSetUpdated_"+this.map.getId(),dojo.hitch(this,this.updateRecordSetAndRefresh)));if(this.records!=null){this.updateRecordSet(this.records);}},isEmpty:function(){if(this.mxRecords){for(var id in this.mxRecords){return false;}}return true;},centerAndZoom:function(){this.map.zoomToMbos(this.mboInfoArray);},showMXRecordsOnMap:function(_4f3){var _4f4={"enableMapTips":true};this.map.showAllMboRecords(this.mboInfoArray,_4f4,_4f3!=true);this._hidden=false;},updateRecordSetAndRefresh:function(_4f5,_4f6){this.updateRecordSet(_4f5);this.showMXRecordsOnMap(_4f6);},length:function(){return this.mxRecords.length;},updateRecordSet:function(_4f7){while(this.mxRecords.length>0){var _4f8=this.mxRecords.pop();_4f8._removeMarker();}this.records=_4f7;this.mxRecords=[];this.mboInfoArray=[];for(var id in this.records){var _4f8=new ibm.tivoli.fwm.mxmap.MXRecord({mboInfo:this.records[id],map:this.map});if(_4f8.hasAnyGISCoordinates()){this.mxRecords.push(_4f8);this.mboInfoArray.push(this.records[id]);}}},destroyRecursive:function(){this.inherited(arguments);}});});},"dojo/dnd/Moveable":function(){define("dojo/dnd/Moveable",["../main","../Evented","../touch","./Mover"],function(dojo,_4f9,_4fa){dojo.declare("dojo.dnd.Moveable",[_4f9],{handle:"",delay:0,skip:false,constructor:function(node,_4fb){this.node=dojo.byId(node);if(!_4fb){_4fb={};}this.handle=_4fb.handle?dojo.byId(_4fb.handle):null;if(!this.handle){this.handle=this.node;}this.delay=_4fb.delay>0?_4fb.delay:0;this.skip=_4fb.skip;this.mover=_4fb.mover?_4fb.mover:dojo.dnd.Mover;this.events=[dojo.connect(this.handle,_4fa.press,this,"onMouseDown"),dojo.connect(this.handle,"ondragstart",this,"onSelectStart"),dojo.connect(this.handle,"onselectstart",this,"onSelectStart")];},markupFactory:function(_4fc,node,ctor){return new ctor(node,_4fc);},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.events=this.node=this.handle=null;},onMouseDown:function(e){if(this.skip&&dojo.dnd.isFormElement(e)){return;}if(this.delay){this.events.push(dojo.connect(this.handle,_4fa.move,this,"onMouseMove"),dojo.connect(this.handle,_4fa.release,this,"onMouseUp"));this._lastX=e.pageX;this._lastY=e.pageY;}else{this.onDragDetected(e);}dojo.stopEvent(e);},onMouseMove:function(e){if(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay){this.onMouseUp(e);this.onDragDetected(e);}dojo.stopEvent(e);},onMouseUp:function(e){for(var i=0;i<2;++i){dojo.disconnect(this.events.pop());}dojo.stopEvent(e);},onSelectStart:function(e){if(!this.skip||!dojo.dnd.isFormElement(e)){dojo.stopEvent(e);}},onDragDetected:function(e){new this.mover(this.node,e,this);},onMoveStart:function(_4fd){dojo.publish("/dnd/move/start",[_4fd]);dojo.addClass(dojo.body(),"dojoMove");dojo.addClass(this.node,"dojoMoveItem");},onMoveStop:function(_4fe){dojo.publish("/dnd/move/stop",[_4fe]);dojo.removeClass(dojo.body(),"dojoMove");dojo.removeClass(this.node,"dojoMoveItem");},onFirstMove:function(_4ff,e){},onMove:function(_500,_501,e){this.onMoving(_500,_501);var s=_500.node.style;s.left=_501.l+"px";s.top=_501.t+"px";this.onMoved(_500,_501);},onMoving:function(_502,_503){},onMoved:function(_504,_505){}});return dojo.dnd.Moveable;});},"ibm/tivoli/fwm/mxmap/impl/MaximoSpatialMxn":function(){define(["dijit","dojo","dojox"],function(_506,dojo,_507){dojo.provide("ibm.tivoli.fwm.mxmap.impl.MaximoSpatialMxn");dojo.declare("ibm.tivoli.fwm.mxmap.impl.MaximoSpatialMxn",null,{map:null,fullExtent:null,mapstraction:null,numberOfExternalMaps:0,totalLoaded:0,totalMapServices:0,loadList:[],mapInitialExtent:null,bingMapsLayer:null,osmTries:0,constructor:function(_508){dojo.mixin(this,_508);this.loadList=[];fromWebMercatorCache={};toWebMercatorCache={};},checkIfAllLoaded:function(){this.totalLoaded++;if(this.getTotalLayers()==this.totalLoaded){for(var i=0;i<this.loadList.length;i++){dojo.disconnect(this.loadList[i]);}this.mapstraction.loaded[this.api]=true;window.mx={esri:{sr:this.map.spatialReference}};var _509=0;if(this.map.extent){_509=this.map.extent.getWidth();}this.map._maximo={mapStartingWidth:_509,hasCachedMapService:this.hasCachedMapService};var ms=this.mapstraction;ms.state={updating:false,panning:false,zooming:false};dojo.connect(this.map,"onUpdateStart",function(evt){ms.state.updating=true;});dojo.connect(this.map,"onUpdateEnd",function(evt){ms.state.updating=false;});dojo.connect(this.map,"onPanStart",function(evt,_50a){ms.state.updating=true;});dojo.connect(this.map,"onPanEnd",function(evt){ms.endPan.fire();ms.state.updating=false;});dojo.connect(this.map,"onZoomStart",function(_50b,_50c,_50d,_50e){ms.state.updating=true;});dojo.connect(this.map,"onReposition",function(x,y){dojo.publish("onESRIReposition");});dojo.connect(this.map,"onZoomEnd",function(_50f,_510,_511,_512){ms.state.updating=false;ms.changeZoom.fire();});if(this._failedLayers.length>0){console.warn("The following layers failed to load",this._failedLayers);}var fl=this._failedLayers;this.mapstraction.getFailedLayers=function(){return fl;};try{var _513=new esri.dijit.Scalebar({map:this.map,scalebarUnit:this.lenUnit,attachTo:"bottom-left"});}catch(e){console.warn("failed to load scale bar");console.warn(e);}if(!this.mapstraction.optParams.isMobile){try{var _514=new esri.dijit.OverviewMap({map:this.map,color:"#6E6EFF",expandFactor:2.5,maximizeButton:false,visible:false});_514.startup();}catch(e){console.warn("failed to load Overview Map");console.warn(e);}}this.mapstraction.runDeferred();}},_failedLayers:[],_failedToLoadMapService:function(args,_515){args.error=_515;this._failedLayers.push(args);this.handleB4BaseMap(args,null);this.checkIfAllLoaded();},hasCachedMapService:false,determineTypeAndLoadLayer:function(_516,mps,map){var _517;var _518={id:mps.name,opacity:parseFloat(mps.transparency),visible:mps.visible};var _519=function(arg){if(this.fullExtent==null){this.fullExtent=_517.fullExtent;}else{this.fullExtent=this.fullExtent.union(_517.fullExtent);}this.checkIfAllLoaded();};if(_516.tileInfo){_517=new esri.layers.ArcGISTiledMapServiceLayer(mps.url,_518);this.loadList.push(dojo.connect(_517,"onUpdateEnd",dojo.hitch(this,_519)));this.hasCachedMapService=true;}else{if(_516.serviceDataType==="esriImageServiceDataTypeGeneric"){var _51a=new esri.layers.ImageServiceParameters();_518.imageParameters=_51a;_517=new esri.layers.ArcGISImageServiceLayer(mps.url,_518);_517.setDisableClientCaching(true);this.loadList.push(dojo.connect(_517,"onUpdateEnd",dojo.hitch(this,_519)));}else{var _51b=new esri.layers.ImageParameters();_51b.transparent=true;if(mps.visibleLayers&&mps.visibleLayers.length>0&&mps.visibleLayers[0]!=="all"){_51b.layerIds=mps.visibleLayers;_51b.layerOption=esri.layers.ImageParameters.LAYER_OPTION_SHOW;}if(this.mapInitialExtent){_51b.bbox=this.mapInitialExtent;}_518.imageParameters=_51b;_517=new esri.layers.ArcGISDynamicMapServiceLayer(mps.url,_518);_517.setDisableClientCaching(true);this.loadList.push(dojo.connect(_517,"onUpdateEnd",dojo.hitch(this,_519)));dojo.connect(_517,"onLoad",dojo.hitch(this,function(){}));}}if(this.baseMapAdded==true){this.map.addLayer(_517);}else{this.handleB4BaseMap(mps,_517);}},handleB4BaseMap:function(mps,_51c){if(mps.order==this.basemapOrder){this.baseMapAdded=true;if(_51c){this.map.addLayer(_51c);}for(var id in this.buffer){this.map.addLayer(this.buffer[id]);}}else{if(_51c){this.buffer.push(_51c);}}},buffer:[],numberOfBaseMaps:0,getTotalLayers:function(){return this.totalMapServices+this.numberOfExternalMaps;},createOSMLater:function(){try{if(this.osmTries==0){this.numberOfExternalMaps++;}this.openStreetMapLayer=new esri.layers.OpenStreetMapLayer();this.map.addLayer(this.openStreetMapLayer,0);this.loadList.push(dojo.connect(this.openStreetMapLayer,"onUpdate",dojo.hitch(this,"checkIfAllLoaded")));}catch(e){if(this.osmTries<6){this.osmTries++;console.warn("postpone OSM");setTimeout(dojo.hitch(this,this.createOSMLater),500);}else{console.error("failed to load OSM");}}},createBingMapsLayer:function(key){this.numberOfExternalMaps++;this.bingMapsLayer=new esri.virtualearth.VETiledLayer({id:"Bing Maps",bingMapsKey:key,mapStyle:esri.virtualearth.VETiledLayer.MAP_STYLE_ROAD});this.map.addLayer(this.bingMapsLayer);this.loadList.push(dojo.connect(this.bingMapsLayer,"onUpdateEnd",dojo.hitch(this,this.checkIfAllLoaded)));var _51d=dojo.create("div",{id:"bingButtons",className:"bingMapsButtonsDiv"},dojo.byId(this.map.id));var _51e=dojo.hitch(this,function(id){this.bingMapsLayer.setMapStyle(id);});var msg1=ibm.tivoli.fwm.i18n.getMaxMsg("plussmap","bing_button_aerial");var _51f=dojo.create("button",{innerHTML:msg1},_51d);dojo.connect(_51f,"onclick",null,function(){_51e(esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL);});var msg2=ibm.tivoli.fwm.i18n.getMaxMsg("plussmap","bing_button_aerialwithlabels");var _520=dojo.create("button",{innerHTML:msg2},_51d);dojo.connect(_520,"onclick",null,function(){_51e(esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL_WITH_LABELS);});var msg3=ibm.tivoli.fwm.i18n.getMaxMsg("plussmap","bing_button_roads");var _521=dojo.create("button",{innerHTML:msg3},_51d);dojo.connect(_521,"onclick",null,function(){_51e(esri.virtualearth.VETiledLayer.MAP_STYLE_ROAD);});},loadMap:function(_522){this._failedLayers=[];if(_522.bingMaps){this.createBingMapsLayer(_522.bingMapsKey);}if(_522.openStreetMap){this.createOSMLater();}this.totalLoaded=0;if(_522.mapservices[0]){this.basemapOrder=_522.mapservices[0].order;}for(var _523=0;_523<_522.mapservices.length;_523++){var _524=_522.mapservices[_523];var _525={"f":"json"};this.totalMapServices++;esri.request({url:_524.url,load:dojo.hitch(this,function(arg,arg2){this.determineTypeAndLoadLayer(arg,arg2.args.params.mapServiceInfo,this.map);}),error:dojo.hitch(this,function(_526){this._failedToLoadMapService(_524,_526);}),handleAs:"json",callbackParamName:"callback",sync:true,content:_525,params:{"mapServiceInfo":_524},timeout:30000});}},isPointInFullExtent:function(pt){var _527=this.map.extent;if(this.fullExtent){_527=this.fullExtent;}return _527.contains(pt);},toWebMercatorCache:{},projectPointsToWebMercator:function(_528,_529,_52a){var _52b=new esri.SpatialReference({wkid:4326});var _52c=[];var _52d=[];for(var i=0;i<_528.length;i++){if(this.toWebMercatorCache[_528[i]]!=null){_52d.push(this.toWebMercatorCache[_528[i]]);continue;}_52c.push(_528[i].toProprietary("maximospatial"));}if(_52d.length==_528.length){_529(_52d);return;}if(this.esriGeometryService==null){var _52e={message:"Geometry service not found",msggroup:"plussmap",msgkey:"failed_loading_geometry_service"};_52a(_52e);}var _52f=this;this.esriGeometryService.project(_52c,_52b,function(_530){for(var i=0;i<_530.length;i++){var _531=_530[i];var pp=new mxn.LatLonPoint(_531.y,_531.x,_52b.wkid);_52f.toWebMercatorCache[_528[i]]=pp;_52d.push(pp);}_529(_52d);});},fromWebMercatorCache:{},projectPointsFromWebMercator:function(_532,_533,_534){var _535=window.mx.esri.sr;var _536=[];var _537=new esri.SpatialReference({wkid:4326});var _538=[];for(var i=0;i<_532.length;i++){if(this.fromWebMercatorCache[_532[i]]!=null){_538.push(this.fromWebMercatorCache[_532[i]]);continue;}var p=new esri.geometry.Point(_532[i].lng,_532[i].lat,_537);_536.push(p);}if(_538.length==_532.length){_533(_538);return;}if(this.esriGeometryService==null){var _539={message:"Geometry service not found",msggroup:"plussmap",msgkey:"failed_loading_geometry_service"};_534(_539);}var _53a=this;this.esriGeometryService.project(_536,_535,function(_53b){for(var i=0;i<_53b.length;i++){var _53c=_53b[i];var pp=new mxn.LatLonPoint(_53c.y,_53c.x,_535.wkid);_53a.fromWebMercatorCache[_532[i]]=pp;_538.push(pp);}_533(_538);});}});});},"ibm/tivoli/fwm/mxmap/CurrentMXRecManager":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/ImageLibraryManager"],function(_53d,dojo,_53e){dojo.provide("ibm.tivoli.fwm.mxmap.CurrentMXRecManager");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.ImageLibraryManager");dojo.declare("ibm.tivoli.fwm.mxmap.CurrentMXRecManager",ibm.tivoli.fwm.mxmap.MXRecord,{map:null,currentMarker:null,markerImgUrl:null,recordSet:null,currentFromRecSet:false,mbo:null,mboInfo:null,draggable:true,constructor:function(_53f){dojo.mixin(this,_53f);if(!this.markerImgUrl){this.markerImgUrl=ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager().getDefaultMarkerImageInfo().getImageURL();}this.addSubscription(dojo.subscribe("onCurrentRecordUpdate_"+this.map.getId(),dojo.hitch(this,this.serverUpdated)));this.recordSet=this.map.getCurrentRecordSetControl();this.mboInfo=_53f.mbo;},disposeMarker:function(){this._removeMarker();},showCurrentRecord:function(_540){if(this.mbo){this.serverUpdated(this.mbo,_540);}},serverUpdated:function(data,_541){if(this.mboInfo&&this.mboInfo.mxdata){if(this.mboInfo.mxdata.uid.name!=data.mxdata.uid.name||this.mboInfo.mxdata.uid.value!=data.mxdata.uid.value){this.disposeMarker();this.isMboOnMap=false;}}this.currentFromRecSet=false;this.mboInfo=data;this.mbo=data;this._updateMarkerLocation(data,_541);},_placeMarker:function(){var _542={"events":{"onMoveEnd":dojo.hitch(this,this.movedMarker)},"enableMapTips":true};this.map.addMboToLayerManager(this.mboInfo,_542);this.isMboOnMap=true;},_updateMarkerLocation:function(_543,_544){this.inherited(arguments);dojo.publish("onCurrentLocationUpdated_"+this.map.getId());},movedMarker:function(_545,evt,_546){if(dojo.config.fwm.debug==true){}this.reverseGeocodeCurrentRecord(_546.newLocation,false);},setServersCurrentRecordLocation:function(_547){this.map.getMaximo().setCurrentRecordLocation(_547);},reverseGeocodeCurrentRecord:function(_548,_549){if(!_548){if(dojo.config.fwm.debug==true){}_548=this.currentMarker.location;}var _54a=function(_54b){this.reverseGeocodeCallbackError(_54b,_548,_549);};var _54c=function(_54d){this.reverseGeocodeCallback(_54d,_548);};this.map.geocoder.reverseGeocode(_548.lat,_548.lng,dojo.hitch(this,_54c),dojo.hitch(this,_54a));},reverseGeocodeAddressOnly:function(){this.reverseGeocodeCurrentRecord(null,true);},reverseGeocodeCallbackError:function(_54e,_54f,_550){if(dojo.config.fwm.debug==true){}if(_550&&_550==true){if(dojo.config.fwm.debug==true){}this.map.getMaximo().showMessage("mapserver","auto_revgeocode_noresults");return;}else{if(!this.currentMaker||_54f.lat!=this.currentMarker.location.lat||_54f.lng!=this.currentMarker.location.lng){if(dojo.config.fwm.debug==true){}if(_54f.lat&&_54f.lng){this.map.getMaximo().setCurrentRecordLocation({lat:_54f.lat,lng:_54f.lng},"FAILED_REV_GEOCODE");}}}},reverseGeocodeCallback:function(_551,_552){if(dojo.config.fwm.debug==true){}var _553=_552;var _554=_551[0].formattedAddress;this.map.getMaximo().setCurrentRecordLocation({lat:_553.lat,lng:_553.lng,address:_554});}});});},"dijit/typematic":function(){define("dijit/typematic",["dojo/_base/array","dojo/_base/connect","dojo/_base/event","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/_base/sniff","."],function(_555,_556,_557,_558,lang,on,has,_559){var _55a=(_559.typematic={_fireEventAndReload:function(){this._timer=null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(this._currentTimeout<0?this._initialDelay:(this._subsequentDelay>1?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay)),this._minDelay);this._timer=setTimeout(lang.hitch(this,"_fireEventAndReload"),this._currentTimeout);},trigger:function(evt,_55b,node,_55c,obj,_55d,_55e,_55f){if(obj!=this._obj){this.stop();this._initialDelay=_55e||500;this._subsequentDelay=_55d||0.9;this._minDelay=_55f||10;this._obj=obj;this._evt=evt;this._node=node;this._currentTimeout=-1;this._count=-1;this._callback=lang.hitch(_55b,_55c);this._fireEventAndReload();this._evt=lang.mixin({faux:true},evt);}},stop:function(){if(this._timer){clearTimeout(this._timer);this._timer=null;}if(this._obj){this._callback(-1,this._node,this._evt);this._obj=null;}},addKeyListener:function(node,_560,_561,_562,_563,_564,_565){if(_560.keyCode){_560.charOrCode=_560.keyCode;_558.deprecated("keyCode attribute parameter for dijit.typematic.addKeyListener is deprecated. Use charOrCode instead.","","2.0");}else{if(_560.charCode){_560.charOrCode=String.fromCharCode(_560.charCode);_558.deprecated("charCode attribute parameter for dijit.typematic.addKeyListener is deprecated. Use charOrCode instead.","","2.0");}}var _566=[on(node,_556._keypress,lang.hitch(this,function(evt){if(evt.charOrCode==_560.charOrCode&&(_560.ctrlKey===undefined||_560.ctrlKey==evt.ctrlKey)&&(_560.altKey===undefined||_560.altKey==evt.altKey)&&(_560.metaKey===undefined||_560.metaKey==(evt.metaKey||false))&&(_560.shiftKey===undefined||_560.shiftKey==evt.shiftKey)){_557.stop(evt);_55a.trigger(evt,_561,node,_562,_560,_563,_564,_565);}else{if(_55a._obj==_560){_55a.stop();}}})),on(node,"keyup",lang.hitch(this,function(){if(_55a._obj==_560){_55a.stop();}}))];return {remove:function(){_555.forEach(_566,function(h){h.remove();});}};},addMouseListener:function(node,_567,_568,_569,_56a,_56b){var _56c=[on(node,"mousedown",lang.hitch(this,function(evt){_557.stop(evt);_55a.trigger(evt,_567,node,_568,node,_569,_56a,_56b);})),on(node,"mouseup",lang.hitch(this,function(evt){if(this._obj){_557.stop(evt);}_55a.stop();})),on(node,"mouseout",lang.hitch(this,function(evt){_557.stop(evt);_55a.stop();})),on(node,"mousemove",lang.hitch(this,function(evt){evt.preventDefault();})),on(node,"dblclick",lang.hitch(this,function(evt){_557.stop(evt);if(has("ie")){_55a.trigger(evt,_567,node,_568,node,_569,_56a,_56b);setTimeout(lang.hitch(this,_55a.stop),50);}}))];return {remove:function(){_555.forEach(_56c,function(h){h.remove();});}};},addListener:function(_56d,_56e,_56f,_570,_571,_572,_573,_574){var _575=[this.addKeyListener(_56e,_56f,_570,_571,_572,_573,_574),this.addMouseListener(_56d,_570,_571,_572,_573,_574)];return {remove:function(){_555.forEach(_575,function(h){h.remove();});}};}});return _55a;});},"ibm/tivoli/fwm/mxmap/helpers/MapFullScreenHelper":function(){define(["dijit","dojo","dojox","dojo/require!dojo/dom"],function(_576,dojo,_577){dojo.provide("ibm.tivoli.fwm.mxmap.helpers.MapFullScreenHelper");dojo.require("dojo.dom");dojo.declare("ibm.tivoli.fwm.mxmap.helpers.MapFullScreenHelper",ibm.tivoli.fwm.mxmap._Base,{map:null,mapDivElement:null,mapDivWidth:null,mapDivHeight:null,_fullScreenOn:false,_keyHandler:null,_origViewPortContent:null,_oldOverflow:null,_oldBodyParentOverflow:null,_origClientAreaInfo:null,_origOnScrollFunction:null,mapToolbar:null,_isAndroid:false,constructor:function(_578){dojo.mixin(this,_578);this._fullScreenOn=false;this._isAndroid=navigator.userAgent.indexOf("Android")>-1;},_checkForESCKey:function(_579){if(_579.keyCode==dojo.keys.ESCAPE){this.fullScreenModeOff();}},_doPreSetupIfIE:function(_57a){if(dojo.isIE&&true!==this.map.isMobile){if(window.clientAreaId){var _57b=dojo.byId(window.clientAreaId);if(_57b){if(true===_57a){var _57c=(_57b.style.position||"relative");var _57d=(_57b.style.overflow||"auto");this._origClientAreaInfo={height:_57b.style.height,width:_57b.style.width,scrollTop:_57b.scrollTop,scrollLeft:_57b.scrollLeft,position:_57c,overflow:_57d};}else{this._origClientAreaInfo={height:_57b.style.height,width:_57b.style.width,scrollTop:this._origClientAreaInfo.scrollTop,scrollLeft:this._origClientAreaInfo.scrollLeft,position:this._origClientAreaInfo.position,overflow:this._origClientAreaInfo.overflow};}_57b.scrollTop=0;_57b.scrollLeft=0;dojo.style(_57b,{"width":_576.getViewport().w+"px","height":_576.getViewport().h+"px","top":"0px","left":"0px","position":"absolute","overflow":"hidden"});}}var _57e=dojo.byId("calviewAppletDiv");if(_57e!=null){dojo.style(_57e,{"display":"none"});}}},_undoPreSetupIfIE:function(){if(dojo.isIE&&true!==this.map.isMobile){if(window.clientAreaId){var _57f=dojo.byId(window.clientAreaId);if(_57f){dojo.style(_57f,{"width":this._origClientAreaInfo.width,"height":this._origClientAreaInfo.height,"position":this._origClientAreaInfo.position,"overflow":this._origClientAreaInfo.overflow});_57f.scrollTop=this._origClientAreaInfo.scrollTop;_57f.scrollLeft=this._origClientAreaInfo.scrollLeft;}}var _580=dojo.byId("calviewAppletDiv");if(_580!=null){dojo.style(_580,{"display":"block"});}}},fullScreenModeOn:function(){if(this._fullScreenOn==false){this._doPreSetupIfIE(true);this._adjustScrolls();this._setViewPortSettings();this._adjustMapToFullScreen();this._hideElementsHackOn();this._adjustOpacity();this._fullScreenOn=true;this._keyHandler=dojo.connect(document,"onkeypress",dojo.hitch(this,this._checkForESCKey));var _581=0;window.top.scrollTo(_581,0);var _582=0;if(this.map.toolbar){_582=this.map.toolbar.getToolbarHeight();}this.map.getMapstraction().resizeTo(_576.getViewport().w,_576.getViewport().h-_582);dojo.publish("mapFullScreenModeChanged_"+this.map.getId(),[{modeOn:true}]);}else{if(dojo.config.fwm.debug==true){}}},_adjustMapToFullScreen:function(){if(_576.getViewport().w<200||_576.getViewport().h<200){return;}var _583="0px";var _584=0;if(this.mapToolbar){var _585=this.mapToolbar.getToolbarDivElement();if(dojo.isIE&&(this.map.isMobile==true)){dojo.style(_585,{"width":_576.getViewport().w+"px","top":"0px","left":_584+"px","position":"absolute"});}else{dojo.style(_585,{"width":_576.getViewport().w+"px","top":"0px","left":_584+"px","position":"absolute","zIndex":"1001"});}_583=_585.offsetHeight+"px";}var _586=0;if(this.map.toolbar){_586=this.map.toolbar.getToolbarHeight();}if(dojo.isIE&&(this.map.isMobile==true)){dojo.style(this.mapDivElement,{"width":_576.getViewport().w+"px","height":(_576.getViewport().h-_586)+"px","top":_583,"left":_584+"px","position":"absolute"});}else{dojo.style(this.mapDivElement,{"width":_576.getViewport().w+"px","height":(_576.getViewport().h-_586)+"px","top":_583,"left":_584+"px","position":"absolute","zIndex":"1000"});}},_hideElementsHackOn:function(){if(this._isAndroid||dojo.isIE){this.mapParent=this._removeMapFromParent();this._hidePageElements();this._addMapToParent(document.body);}},_hideElementsHackOff:function(){if(this._isAndroid||dojo.isIE){this._removeMapFromParent();this._addMapToParent(this.mapParent);this._showPageElements();}if(dojo.isIE){window.onresize();}},_removeMapFromParent:function(){var _587=this.mapDivElement.parentNode;_587.removeChild(this.mapDivElement);if(this.mapToolbar){_587.removeChild(this.mapToolbar.getToolbarDivElement());}return _587;},_addMapToParent:function(_588){if(this.mapToolbar){_588.appendChild(this.mapToolbar.getToolbarDivElement());}_588.appendChild(this.mapDivElement);},_hidePageElements:function(){var _589=dojo.byId("dialogholder");var _58a=dojo.query(".dijitDialog");var _58b=dojo.byId("wait");var _58c=[_589,_58b].concat(_58a);dojo.query("body *").forEach(function(node,_58d,arr){if(node.style&&!dojo.some(_58c,function(_58e){return dojo.dom.isDescendant(node,_58e);})){node._fwm_display_=node.style.display;node.style.display="none";}});},_showPageElements:function(){dojo.query("body *").forEach(function(node,_58f,arr){if(node.style&&"_fwm_display_" in node){node.style.display=node._fwm_display_;}});},_adjustOpacity:function(){for(var _590=0;_590<100;_590+=5){dojo.query(".opacity_"+_590).style("opacity","1.0");}},_restoreOpacity:function(){for(var _591=0;_591<100;_591+=5){dojo.query(".opacity_"+_591).style("opacity","."+_591);}},_adjustScrolls:function(){var body=dojo.body();if(body.style&&body.style.overflow){this._oldOverflow=dojo.style(body,"overflow");}else{this._oldOverflow="";}if(dojo.isIE){if(body.parentNode&&body.parentNode.style&&body.parentNode.style.overflow){this._oldBodyParentOverflow=body.parentNode.style.overflow;}else{try{this._oldBodyParentOverflow=dojo.style(body.parentNode,"overflow");}catch(e){this._oldBodyParentOverflow="scroll";}}dojo.style(body.parentNode,"overflow","hidden");}dojo.style(body,"overflow","hidden");this._origOnScrollFunction=window.onscroll;window.onscroll=function(e){window.top.scrollTo(0,0);};},_restoreScrolls:function(){var body=dojo.body();if(dojo.isIE&&!dojo.isQuirks){body.parentNode.style.overflow=this._oldBodyParentOverflow;}dojo.style(body,"overflow",this._oldOverflow);window.onscroll=this._origOnScrollFunction;},_setViewPortSettings:function(){var _592=dojo.query("meta[name=\"viewport\"]")[0];if(_592){this._origViewPortContent=dojo.attr(_592,"content");if(this._isAndroid){dojo.attr(_592,"content",null);dojo.attr(_592,"content","initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no,width=device-width");}else{dojo.attr(_592,"content","initial-scale=1.0,user-scalable=no,width=device-width");}}else{var meta=dojo.create("meta",{name:"viewport",content:"initial-scale=1.0, user-scalable=no"});this._origViewPortContent=dojo.create("meta",{name:"viewport",content:"initial-scale=1.0, user-scalable=yes"});document.getElementsByTagName("head")[0].appendChild(meta);}},_removeViewPortSettings:function(){var _593=dojo.query("meta[name=\"viewport\"]")[0];if(_593){dojo.attr(_593,"content",null);dojo.attr(_593,"content",this._origViewPortContent);}},fullScreenModeOff:function(){if(this._fullScreenOn==true){this._hideElementsHackOff();this._undoPreSetupIfIE();this._restoreMapToOriginalSize();this._restoreScrolls();this._restoreOpacity();this._fullScreenOn=false;if(this._keyHandler){dojo.disconnect(this._keyHandler);this._keyHandler=null;}this._removeViewPortSettings();this.map._resize();dojo.publish("mapFullScreenModeChanged_"+this.map.getId(),[{modeOn:false}]);}else{if(dojo.config.fwm.debug==true){console.warn("[MapFullScreenHelper] Full Screen is already off");}}},_restoreMapToOriginalSize:function(){dojo.style(this.mapDivElement,{"width":this.mapDivWidth,"height":this.mapDivHeight,"top":"0px","left":"0px","position":"relative","zIndex":""});if(this.mapToolbar){var _594=this.mapToolbar.getToolbarDivElement();dojo.style(_594,{"width":this.mapDivWidth,"top":this.mapDivElement.style.top,"left":this.mapDivElement.style.left,"position":"relative","zIndex":""});}},updateMapDimensions:function(_595,_596){this.mapDivWidth=_595;this.mapDivHeight=_596;if(this._fullScreenOn==true){this._doPreSetupIfIE(false);this._adjustMapToFullScreen();}}});});},"dijit/MenuItem":function(){require({cache:{"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\"\n\t\tdata-dojo-attach-event=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"}});define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/event","dojo/_base/kernel","dojo/_base/sniff","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_597,dom,_598,_599,_59a,_59b,has,_59c,_59d,_59e,_59f,_5a0){return _597("dijit.MenuItem",[_59c,_59d,_59e,_59f],{templateString:_5a0,baseClass:"dijitMenuItem",label:"",_setLabelAttr:{node:"containerNode",type:"innerHTML"},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_5a1){if(_5a1&&!("label" in this.params)){this.set("label",_5a1.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _5a2=this.id+"_text";_598.set(this.containerNode,"id",_5a2);if(this.accelKeyNode){_598.set(this.accelKeyNode,"id",this.id+"_accel");_5a2+=" "+this.id+"_accel";}this.domNode.setAttribute("aria-labelledby",_5a2);dom.setSelectable(this.domNode,false);},_onHover:function(){this.getParent().onItemHover(this);},_onUnhover:function(){this.getParent().onItemUnhover(this);this._set("hovering",false);},_onClick:function(evt){this.getParent().onItemClick(this,evt);_59a.stop(evt);},onClick:function(){},focus:function(){try{if(has("ie")==8){this.containerNode.focus();}this.focusNode.focus();}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_5a3){_599.toggle(this.domNode,"dijitMenuItemSelected",_5a3);},setLabel:function(_5a4){_59b.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_5a4);},setDisabled:function(_5a5){_59b.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_5a5);},_setDisabledAttr:function(_5a6){this.focusNode.setAttribute("aria-disabled",_5a6?"true":"false");this._set("disabled",_5a6);},_setAccelKeyAttr:function(_5a7){this.accelKeyNode.style.display=_5a7?"":"none";this.accelKeyNode.innerHTML=_5a7;_598.set(this.containerNode,"colSpan",_5a7?"1":"2");this._set("accelKey",_5a7);}});});},"ibm/tivoli/fwm/mxmap/routing/impl/gmaps":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/routing/Router,ibm/tivoli/fwm/mxmap/routing/Route"],function(_5a8,dojo,_5a9){dojo.provide("ibm.tivoli.fwm.mxmap.routing.impl.gmaps");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.routing.Router");dojo.require("ibm.tivoli.fwm.mxmap.routing.Route");dojo.declare("ibm.tivoli.fwm.mxmap.routing.impl.gmaps",[ibm.tivoli.fwm.mxmap.routing.Router,ibm.tivoli.fwm.mxmap._Base],{directionsService:null,_routeLimits:25,_markerHost:"http://maps.gstatic.com/mapfiles/markers2/",constructor:function(_5aa){dojo.mixin(this,_5aa);this.directionsService=new google.maps.DirectionsService();if(this.map.mapConf.key==null||this.map.mapConf.key.length==0){this._routeLimits=10;}},_getPathCoords:function(r){var _5ab=[];for(var k in r.overview_path){var p=r.overview_path[k];var _5ac=new mxn.LatLonPoint();_5ac.fromProprietary(this.map.getMapstraction().api,p);_5ab.push(_5ac);}return _5ab;},_iterateOverLegs:function(_5ad,_5ae,map){var _5af={distance:0,duration:0,legData:[],markers:[],stops:[],polyline:[]};var _5b0=null;var _5b1="";for(var k in _5ad.legs){var leg=_5ad.legs[k];_5af.distance+=leg.distance.value;_5af.duration+=leg.duration.value;var _5b2=this._getStepsData(leg.steps);var _5b3=_5b2.stepData;var _5b4=new mxn.LatLonPoint();_5b4.fromProprietary(this.map.getMapstraction().api,leg.start_location);var ep=new mxn.LatLonPoint();ep.fromProprietary(this.map.getMapstraction().api,leg.end_location);_5af.legData.push({distance:leg.distance.value,duration:leg.duration.value,startAddress:leg.start_address,endAddress:leg.end_address,endLatLng:ep,startLatLng:_5b4,steps:_5b3});_5af.polyline=_5af.polyline.concat(_5b2.polyStops);_5af.stops.push(_5b4);_5b0=leg.end_location;_5b1=leg.end_address;}var _5b5=new mxn.LatLonPoint();_5b5.fromProprietary(this.map.getMapstraction().api,_5b0);_5af.stops.push(_5b5);return _5af;},_getStepsData:function(_5b6){var data=[];var _5b7=[];if(_5b6){for(var _5b8 in _5b6){var step=_5b6[_5b8];var _5b9=step.distance.value;var loc=new mxn.LatLonPoint();loc.fromProprietary(this.map.getMapstraction().api,step.start_location);_5b9/=1000;data.push({distance:_5b9,duration:step.duration.value,info:step.instructions,location:loc});_5b7=_5b7.concat(step.path);}}return {stepData:data,polyStops:_5b7};},ccs:["#ff0000","#00ff00","#ffffff"],co:0,_multipleRouteSuccess:function(_5ba,_5bb,_5bc,_5bd){var map=this.map.getMapstraction().getProviderMap();var _5be={totalDistance:0,totalDuration:0,legsData:[],polyline:null,stops:[],copyrights:null};var _5bf=[];for(var _5c0=0;_5c0<_5ba.length;_5c0++){var r=_5ba[_5c0].routes[0];if(_5be.copyrights==null){_5be.copyrights=r.copyrights;}else{_5be.copyrights+=", "+r.copyrights;}var rd=this._iterateOverLegs(r,true,map);for(var k in rd.polyline){var p=rd.polyline[k];var _5c1=new mxn.LatLonPoint();_5c1.fromProprietary(this.map.getMapstraction().api,p);_5bf.push(_5c1);}_5be.totalDistance+=rd.distance;_5be.totalDuration+=rd.duration;_5be.legsData=_5be.legsData.concat(rd.legData);var _5c2=rd.stops;if(_5ba[_5c0].overlapPrevious==true){_5c2=_5c2.slice(1,_5c2.length);}_5be.stops=_5be.stops.concat(_5c2);}var poly=new mxn.Polyline();poly.points=_5bf;poly.color=this.routecolor;poly.setOpacity(this.routeOpacity);poly.setWidth(this.routeLineWidth);if(dojo.config.fwm.debug==true){}_5be.polyline=poly;_5be.map=this.map;var _5c3=function(_5c4){this._markerHost=_5c4;this._counter=0;this.getNext=function(){return {icon:this._generateMarkerImageUrl(),size:[20,34],anchor:[10,34]};};this._generateMarkerImageUrl=function(){var _5c5="_green";var _5c6=(this._counter%26);var _5c7=String.fromCharCode(65+_5c6);if(dojo.config.fwm.debug==true){}this._counter++;return this._markerHost+"marker"+_5c5+_5c7+".png";};};_5be.customMarkerOptions=new _5c3(this._markerHost);var _5c8=new ibm.tivoli.fwm.mxmap.routing.itinerary.Itinerary();var _5c9=false;if(_5bd[0].calculatedStop==true){_5c9=true;}_5c8.setInitialLocation(_5be.legsData[0].startAddress,_5be.legsData[0].startLatLng,null,null,_5c9);if(_5be.legsData&&_5be.legsData.length>0){for(var _5c0=0;_5c0<_5be.legsData.length;_5c0++){var loc=_5be.legsData[_5c0].endLatLng;var info=_5be.legsData[_5c0].endAddress;var _5ca=_5be.legsData[_5c0].distance;var _5cb=_5be.legsData[_5c0].duration/60;var _5cc=_5be.legsData[_5c0].steps;_5ca/=1000;_5c8.addLeg(loc,info,_5ca,_5cb,null,_5cc,null,null);}}if(_5bd[_5bd.length-1].calculatedStop==true){_5c8.legs[_5c8.legs.length-1].needsToGeocode=true;}_5be.itinerary=_5c8;_5be.inputInfo={stops:_5bd,successCb:_5bb,errorCb:_5bc};_5be.originalRouter=this;_5be.distanceUnit=this.getCurrentDistanceUnit();var _5cd=new ibm.tivoli.fwm.mxmap.routing.Route(_5be);if(_5bb){_5bb(_5cd);}},distanceUnit:null,showRoute:function(_5ce,_5cf,_5d0){this._counter=0;var _5d1=0;var _5d2=0;var _5d3=[];var th=this._startTimer();this.distanceUnit=google.maps.UnitSystem.IMPERIAL;if(this.getCurrentDistanceUnit()==ibm.tivoli.fwm.mxmap.routing.DistanceUnit.KM){this.distanceUnit=google.maps.UnitSystem.METRIC;}var _5d4=0;var _5d5=false;var _5d6=function(_5d7){_5d7.overlapPrevious=_5d5;_5d5=false;_5d3.push(_5d7);if(dojo.config.fwm.debug==true){}if(_5d1<_5ce.length){_5d4=_5d1;_5d1+=this._routeLimits;if(_5d1>=_5ce.length){_5d1=_5ce.length;}if(_5d4>0){_5d4--;if((_5d1-_5d4)>=this._routeLimits){_5d1--;}_5d5=true;}var _5d8=_5ce.slice(_5d4,_5d1);if(dojo.config.fwm.debug==true){}this._calculateRoute(_5d8,dojo.hitch(this,_5d6),_5d0);}else{this._multipleRouteSuccess(_5d3,_5cf,_5d0,_5ce);this._stopTimer(null,_5ce.length);}};_5d1+=this._routeLimits;if(_5d1>=_5ce.length){_5d1=_5ce.length;}th=this._startTimer();if(dojo.config.fwm.debug==true){}this._calculateRoute(_5ce.slice(_5d4,_5d1),dojo.hitch(this,_5d6),_5d0);},__convertMboToGmapsLatLng:function(_5d9){var _5da=null;if(_5d9.hasOwnProperty("gisdata")){if(_5d9.gisdata.lat!=null&&_5d9.gisdata.lng!=null){_5da=new google.maps.LatLng(parseFloat(_5d9.gisdata.lat),parseFloat(_5d9.gisdata.lng));}else{if(_5d9.autolocate!=null&&_5d9.autolocate.gisdata!=null){_5da=new google.maps.LatLng(parseFloat(_5d9.autolocate.gisdata.lat),parseFloat(_5d9.autolocate.gisdata.lng));}else{if(_5d9.hasOwnProperty("lat")&&_5d9!=null){_5da=new google.maps.LatLng(parseFloat(_5d9.lat),parseFloat(_5d9.lng));}else{console.warn("Stop doesn't have gis coords",_5d9);}}}}else{_5da=new google.maps.LatLng(parseFloat(_5d9.lat),parseFloat(_5d9.lng));}return _5da;},_calculateRoute:function(_5db,_5dc,_5dd){var _5de=this.__convertMboToGmapsLatLng(_5db[0]);var end=this.__convertMboToGmapsLatLng(_5db[_5db.length-1]);var _5df={origin:_5de,destination:end,travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,waypoints:[]};_5df.avoidHighways=this.getAvoidHighways();_5df.avoidTolls=this.getAvoidTolls();for(var i=1;i<_5db.length-1;i++){var stop=_5db[i];var ll=this.__convertMboToGmapsLatLng(stop);var wp={location:ll,stopover:true};_5df.waypoints.push(wp);}if(this.isOptimizeRoute()){_5df.optimizeWaypoints=true;}if(dojo.config.fwm.debug==true){}var th=this._startTimer();var me=this;this.directionsService.route(_5df,function(_5e0,_5e1){if(dojo.config.fwm.debug==true){}me._stopTimer(th,_5db.length);if(_5e1==google.maps.DirectionsStatus.OK){if(_5dc){_5dc(_5e0);}}else{if(_5dd){switch(_5e1){case google.maps.DirectionsStatus.ZERO_RESULTS:_5dd(ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.ZERO_RESULTS,_5e1);break;case google.maps.DirectionsStatus.OVER_QUERY_LIMIT:_5dd(ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.OVER_LIMIT,_5e1);break;case google.maps.DirectionsStatus.REQUEST_DENIED:_5dd(ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.REQUEST_DENIED,_5e1);break;default:_5dd(ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.UNKNOWN_ERROR,_5e1);break;}}}});}});});},"ibm/tivoli/fwm/mxmap/panels/MobileInfoPanelDialog":function(){define(["dijit","dojo","dojox","dojo/require!dijit/Dialog,dijit/form/Button"],function(_5e2,dojo,_5e3){dojo.provide("ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog");dojo.require("dijit.Dialog");dojo.require("dijit.form.Button");dojo.declare("ibm.tivoli.fwm.mxmap.panels.MobileInfoPanelDialog",null,{map:null,title:null,_theDialog:null,_content:null,mainSec:null,undercontent:null,fitHeight:false,constructor:function(_5e4){dojo.mixin(this,_5e4);},createDialog:function(){var _5e5=this.getCalculatedHeight();var _5e6=this.getCalculatedWidth();var _5e7=this.title||"";var _5e8={title:_5e7,draggable:this.map.isMobile?false:true,closable:false,style:"width: "+(_5e6)+"px; max-height: "+(_5e5)+"px; overflow-y: auto;"};this._theDialog=new _5e2.Dialog(_5e8);this._cancelHandler=dojo.connect(this._theDialog,"onCancel",dojo.hitch(this,this._resetMaximoDialogStates));dojo.connect(window,"onresize",this,this._onResize);},full:null,center:null,bottom:null,_createContentSection:function(_5e9){if(this.center!=null&&false){dojo.place(_5e9,this.center,"first");return this.full;}else{var _5ea=dojo.create("div",{style:{width:(this.getCalculatedWidth()-this.fixedpaddingw)+"px"}});this.full=_5ea;var _5eb=dojo.create("div",{style:{overflowY:"auto",overflowX:"auto",maxHeight:(this.getCalculatedHeight()-this.fixedpaddingh)+"px",width:(this.getCalculatedWidth()-this.fixedpaddingw)+"px"}},_5ea);if(dojo.isIE&&this.fitHeight){_5eb.style.height=(this.getCalculatedHeight()-this.fixedpaddingh)+"px";}this.center=_5eb;dojo.place(_5e9,_5eb,"only");var _5ec=dojo.create("div",{"mxnId":"btnDiv","class":"infoPanelCloseBtn","style":{"textAlign":(document.body.dir=="rtl")?"left":"right"}},_5ea);this.btnDiv=_5ec;var btn2=dojo.create("div",{"mxnId":"btn"},_5ec);var _5ed=ibm.tivoli.fwm.i18n.getMaxMsg("map","infopaneldialogclose");this.closeBtn=new _5e2.form.Button({label:_5ed,onClick:dojo.hitch(this,function(){this.close();})},btn2);return _5ea;}},_myFct:function(){},setContent:function(_5ee){this.createDialog();this._theDialog._myFct=function(){};this._theDialog.set("content",this._createContentSection(_5ee));},_onResize:function(){if(this._theDialog&&this._theDialog.get("open")){this._recalculateDimensions();}},_recalculateDimensions:function(){var _5ef=this.getCalculatedWidth();if(this.fitHeight){var _5f0=this.getCalculatedHeight();this._theDialog.resize({w:_5ef,h:_5f0});this.center.style.height=(_5f0-this.fixedpaddingh);}else{this._theDialog.resize({w:_5ef});}this.center.style.width=(_5ef-this.fixedpaddingw);this.btnDiv.style.width=(_5ef-this.fixedpaddingw);this._theDialog.show();},getCalculatedWidth:function(){var _5f1=navigator.userAgent.indexOf("Android")>-1;if(_5f1){this.map._resize();}var _5f2=310;var _5f3=this.map.getWidthInPixels();if(this.map.isMobile){var _5f4=Math.ceil(_5f3*0.4);}else{var _5f4=Math.ceil(_5f3*0.5);}if(_5f4>_5f2){return _5f4;}if(_5f2>_5f3){return _5f3;}return _5f2;},getCalculatedHeight:function(){var _5f5=Math.min(dojo.window.getBox().h,dojo.marginBox(this.map.getMapstraction().currentElement).h);var _5f6=Math.ceil(_5f5*0.85);if(this.map.isMobile){return _5f6;}var _5f7=400;if(_5f6>_5f7){return _5f6;}return _5f7;},close:function(){if(this._theDialog){this._theDialog.hide();}this._resetMaximoDialogStates();},_resetMaximoDialogStates:function(){dialogCount--;showObjs();},fixedpaddingw:25,fixedpaddingh:80,show:function(){this._recalculateDimensions();this._theDialog.show();hideObjs();dialogCount++;},closeBtn:null,onCancel:function(){this.close();}});});},"dijit/ToolbarSeparator":function(){define("dijit/ToolbarSeparator",["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(_5f8,dom,_5f9,_5fa){return _5f8("dijit.ToolbarSeparator",[_5f9,_5fa],{templateString:"<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>",buildRendering:function(){this.inherited(arguments);dom.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});});},"dijit/layout/_LayoutWidget":function(){define("dijit/layout/_LayoutWidget",["dojo/_base/lang","../_Widget","../_Container","../_Contained","dojo/_base/declare","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/sniff","dojo/_base/window"],function(lang,_5fb,_5fc,_5fd,_5fe,_5ff,_600,_601,has,win){return _5fe("dijit.layout._LayoutWidget",[_5fb,_5fc,_5fd],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,buildRendering:function(){this.inherited(arguments);_5ff.add(this.domNode,"dijitContainer");},startup:function(){if(this._started){return;}this.inherited(arguments);var _602=this.getParent&&this.getParent();if(!(_602&&_602.isLayoutContainer)){this.resize();this.connect(win.global,"onresize",function(){this.resize();});}},resize:function(_603,_604){var node=this.domNode;if(_603){_600.setMarginBox(node,_603);}var mb=_604||{};lang.mixin(mb,_603||{});if(!("h" in mb)||!("w" in mb)){mb=lang.mixin(_600.getMarginBox(node),mb);}var cs=_601.getComputedStyle(node);var me=_600.getMarginExtents(node,cs);var be=_600.getBorderExtents(node,cs);var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});var pe=_600.getPadExtents(node,cs);this._contentBox={l:_601.toPixelValue(node,cs.paddingLeft),t:_601.toPixelValue(node,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};this.layout();},layout:function(){},_setupChild:function(_605){var cls=this.baseClass+"-child "+(_605.baseClass?this.baseClass+"-"+_605.baseClass:"");_5ff.add(_605.domNode,cls);},addChild:function(_606,_607){this.inherited(arguments);if(this._started){this._setupChild(_606);}},removeChild:function(_608){var cls=this.baseClass+"-child"+(_608.baseClass?" "+this.baseClass+"-"+_608.baseClass:"");_5ff.remove(_608.domNode,cls);this.inherited(arguments);}});});},"ibm/tivoli/fwm/mxmap/factories/bingmaps":function(){define(["dijit","dojo","dojox","dojo/require!dojo/io/script,ibm/tivoli/fwm/mxmap/impl/BingMaps"],function(_609,dojo,_60a){dojo.provide("ibm.tivoli.fwm.mxmap.factories.bingmaps");dojo.require("dojo.io.script");dojo.require("ibm.tivoli.fwm.mxmap.impl.BingMaps");ibm.tivoli.fwm.mxmap.factories.bingmaps={loaded:false,apiLoaded:function(){ibm.tivoli.fwm.mxmap.factories.bingmaps.loaded=true;ibm.tivoli.fwm.mxmap.factory.apiInitialized("ibm.tivoli.fwm.mxmap.impl.BingMaps","bingmaps");},init:function(_60b){this._loadJSApi(_60b.mapConf.key,_60b.mapConf.https,_60b.mapConf.locale);},_loadJSApi:function(key,_60c,_60d){var _60e="";var _60f="http";var _610="";if(_60c){_60f="https";_60e+="&s=1";}if(key){_610="&key="+key;_60e+=_610;}else{console.warn("no bing maps key was set.");}if(_60d){var _611="&mkt="+_60d.locStr;_60e+=_611;}else{console.warn("no locale was set.");}dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/ibm/tivoli/fwm/mxn/mxn.microsoftv7.core.js","js");dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/ibm/tivoli/fwm/mxn/mxn.microsoftv7.geocoder.js","js");window.fwmBingMapsLoaded=function(){ibm.tivoli.fwm.mxmap.factories.bingmaps.apiLoaded();};_60e+="&onscriptload=fwmBingMapsLoaded";dojo.io.script.get({url:_60f+"://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"+_60e,timeout:30000,error:function(){console.error("Failed to load bing apis");alert("Failed to load bing maps api");}});},apiPooler:function(){try{if(Microsoft&&Microsoft.Maps){ibm.tivoli.fwm.mxmap.factories.bingmaps.apiLoaded();return;}}catch(e){}if(ibm.tivoli.fwm.mxmap.factories.bingmaps.loaded!=true){setTimeout("ibm.tivoli.fwm.mxmap.factories.bingmaps.apiPooler",500);}}};});},"dijit/popup":function(){define("dijit/popup",["dojo/_base/array","dojo/aspect","dojo/_base/connect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/on","dojo/_base/sniff","dojo/_base/window","./place","./BackgroundIframe","."],function(_612,_613,_614,_615,dom,_616,_617,_618,_619,_61a,keys,lang,on,has,win,_61b,_61c,_61d){var _61e=_615(null,{_stack:[],_beginZIndex:1000,_idGen:1,_createWrapper:function(_61f){var _620=_61f._popupWrapper,node=_61f.domNode;if(!_620){_620=_617.create("div",{"class":"dijitPopup",style:{display:"none"},role:"presentation"},win.body());_620.appendChild(node);var s=node.style;s.display="";s.visibility="";s.position="";s.top="0px";_61f._popupWrapper=_620;_613.after(_61f,"destroy",function(){_617.destroy(_620);delete _61f._popupWrapper;});}return _620;},moveOffScreen:function(_621){var _622=this._createWrapper(_621);_619.set(_622,{visibility:"hidden",top:"-9999px",display:""});},hide:function(_623){var _624=this._createWrapper(_623);_619.set(_624,"display","none");},getTopPopup:function(){var _625=this._stack;for(var pi=_625.length-1;pi>0&&_625[pi].parent===_625[pi-1].widget;pi--){}return _625[pi];},open:function(args){var _626=this._stack,_627=args.popup,_628=args.orient||["below","below-alt","above","above-alt"],ltr=args.parent?args.parent.isLeftToRight():_618.isBodyLtr(),_629=args.around,id=(args.around&&args.around.id)?(args.around.id+"_dropdown"):("popup_"+this._idGen++);while(_626.length&&(!args.parent||!dom.isDescendant(args.parent.domNode,_626[_626.length-1].widget.domNode))){this.close(_626[_626.length-1].widget);}var _62a=this._createWrapper(_627);_616.set(_62a,{id:id,style:{zIndex:this._beginZIndex+_626.length},"class":"dijitPopup "+(_627.baseClass||_627["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:args.parent?args.parent.id:""});if(has("ie")||has("mozilla")){if(!_627.bgIframe){_627.bgIframe=new _61c(_62a);}}var best=_629?_61b.around(_62a,_629,_628,ltr,_627.orient?lang.hitch(_627,"orient"):null):_61b.at(_62a,args,_628=="R"?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],args.padding);_62a.style.display="";_62a.style.visibility="visible";_627.domNode.style.visibility="visible";var _62b=[];_62b.push(on(_62a,_614._keypress,lang.hitch(this,function(evt){if(evt.charOrCode==keys.ESCAPE&&args.onCancel){_61a.stop(evt);args.onCancel();}else{if(evt.charOrCode===keys.TAB){_61a.stop(evt);var _62c=this.getTopPopup();if(_62c&&_62c.onCancel){_62c.onCancel();}}}})));if(_627.onCancel&&args.onCancel){_62b.push(_627.on("cancel",args.onCancel));}_62b.push(_627.on(_627.onExecute?"execute":"change",lang.hitch(this,function(){var _62d=this.getTopPopup();if(_62d&&_62d.onExecute){_62d.onExecute();}})));_626.push({widget:_627,parent:args.parent,onExecute:args.onExecute,onCancel:args.onCancel,onClose:args.onClose,handlers:_62b});if(_627.onOpen){_627.onOpen(best);}return best;},close:function(_62e){var _62f=this._stack;while((_62e&&_612.some(_62f,function(elem){return elem.widget==_62e;}))||(!_62e&&_62f.length)){var top=_62f.pop(),_630=top.widget,_631=top.onClose;if(_630.onClose){_630.onClose();}var h;while(h=top.handlers.pop()){h.remove();}if(_630&&_630.domNode){this.hide(_630);}if(_631){_631();}}}});return (_61d.popup=new _61e());});},"dijit/_base/manager":function(){define("dijit/_base/manager",["dojo/_base/array","dojo/_base/config","../registry",".."],function(_632,_633,_634,_635){_632.forEach(["byId","getUniqueId","findWidgets","_destroyAll","byNode","getEnclosingWidget"],function(name){_635[name]=_634[name];});_635.defaultDuration=_633["defaultDuration"]||200;return _635;});},"dojo/dnd/Mover":function(){define("dojo/dnd/Mover",["../main","../Evented","../touch","./common","./autoscroll"],function(dojo,_636,_637){dojo.declare("dojo.dnd.Mover",[_636],{constructor:function(node,e,host){this.node=dojo.byId(node);this.marginBox={l:e.pageX,t:e.pageY};this.mouseButton=e.button;var h=(this.host=host),d=node.ownerDocument;this.events=[dojo.connect(d,_637.move,this,"onFirstMove"),dojo.connect(d,_637.move,this,"onMouseMove"),dojo.connect(d,_637.release,this,"onMouseUp"),dojo.connect(d,"ondragstart",dojo.stopEvent),dojo.connect(d.body,"onselectstart",dojo.stopEvent)];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){dojo.dnd.autoScroll(e);var m=this.marginBox;this.host.onMove(this,{l:m.l+e.pageX,t:m.t+e.pageY},e);dojo.stopEvent(e);},onMouseUp:function(e){if(dojo.isWebKit&&dojo.isMac&&this.mouseButton==2?e.button==0:this.mouseButton==e.button){this.destroy();}dojo.stopEvent(e);},onFirstMove:function(e){var s=this.node.style,l,t,h=this.host;switch(s.position){case "relative":case "absolute":l=Math.round(parseFloat(s.left))||0;t=Math.round(parseFloat(s.top))||0;break;default:s.position="absolute";var m=dojo.marginBox(this.node);var b=dojo.doc.body;var bs=dojo.getComputedStyle(b);var bm=dojo._getMarginBox(b,bs);var bc=dojo._getContentBox(b,bs);l=m.l-(bc.l-bm.l);t=m.t-(bc.t-bm.t);break;}this.marginBox.l=l-this.marginBox.l;this.marginBox.t=t-this.marginBox.t;if(h&&h.onFirstMove){h.onFirstMove(this,e);}dojo.disconnect(this.events.shift());},destroy:function(){dojo.forEach(this.events,dojo.disconnect);var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.node=this.host=null;}});return dojo.dnd.Mover;});},"dijit/BackgroundIframe":function(){define("dijit/BackgroundIframe",["require",".","dojo/_base/config","dojo/dom-construct","dojo/dom-style","dojo/_base/lang","dojo/on","dojo/_base/sniff","dojo/_base/window"],function(_638,_639,_63a,_63b,_63c,lang,on,has,win){var _63d=new function(){var _63e=[];this.pop=function(){var _63f;if(_63e.length){_63f=_63e.pop();_63f.style.display="";}else{if(has("ie")<9){var burl=_63a["dojoBlankHtmlUrl"]||_638.toUrl("dojo/resources/blank.html")||"javascript:\"\"";var html="<iframe src='"+burl+"' role='presentation'"+" style='position: absolute; left: 0px; top: 0px;"+"z-index: -1; filter:Alpha(Opacity=\"0\");'>";_63f=win.doc.createElement(html);}else{_63f=_63b.create("iframe");_63f.src="javascript:\"\"";_63f.className="dijitBackgroundIframe";_63f.setAttribute("role","presentation");_63c.set(_63f,"opacity",0.1);}_63f.tabIndex=-1;}return _63f;};this.push=function(_640){_640.style.display="none";_63e.push(_640);};}();_639.BackgroundIframe=function(node){if(!node.id){throw new Error("no id");}if(has("ie")||has("mozilla")){var _641=(this.iframe=_63d.pop());node.appendChild(_641);if(has("ie")<7||has("quirks")){this.resize(node);this._conn=on(node,"resize",lang.hitch(this,function(){this.resize(node);}));}else{_63c.set(_641,{width:"100%",height:"100%"});}}};lang.extend(_639.BackgroundIframe,{resize:function(node){if(this.iframe){_63c.set(this.iframe,{width:node.offsetWidth+"px",height:node.offsetHeight+"px"});}},destroy:function(){if(this._conn){this._conn.remove();this._conn=null;}if(this.iframe){_63d.push(this.iframe);delete this.iframe;}}});return _639.BackgroundIframe;});},"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n","ibm/tivoli/fwm/mxmap/routing/Router":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/geolocation/MyCurrentLocation,ibm/tivoli/fwm/mxmap/MXRecord"],function(_642,dojo,_643){dojo.provide("ibm.tivoli.fwm.mxmap.routing.Router");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation");dojo.require("ibm.tivoli.fwm.mxmap.MXRecord");ibm.tivoli.fwm.mxmap.routing.CalculatedStops={CONF_START_STOP:"ConfiguredStartLocation",CONF_END_STOP:"ConfiguredEndLocation",USER_LOCATION_STOP:"UserGeoLocation"};ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes={ZERO_RESULTS:"ZERO_RESULTS",INVALID_REQUEST:"INVALID_REQUEST",REQUEST_DENIED:"REQUEST_DENIED",OVER_LIMIT:"OVER_LIMIT",MIN_STOPS_REQ:"MIN_STOPS_REQ",TIMEOUT:"TIMEOUT",UNKNOWN:"UNKNOWN"};ibm.tivoli.fwm.mxmap.routing.DistanceUnit={KM:0,MILES:1,getLabel:function(_644){if(_644==this.KM){return ibm.tivoli.fwm.i18n.getMaxMsg("map","distancekm");}else{return ibm.tivoli.fwm.i18n.getMaxMsg("map","distancemi");}},getBy1000Label:function(_645){if(_645==this.KM){return ibm.tivoli.fwm.i18n.getMaxMsg("map","distancemeters");}else{return ibm.tivoli.fwm.i18n.getMaxMsg("map","distanceft");}},formatDistance:function(_646,unit){var val=0;var _647="";var _648="";if(unit==this.MILES){_646=_646/1.6;}if(_646<=0.1){val=(_646*10000);_647=this.getBy1000Label(unit);}else{val=_646*10;_647=this.getLabel(unit);}val=Math.round(val);val=val/10;_648=_647.replace("{0}",val.toString());return _648;},formatTime:function(time){var _649="";var _64a="";var hr=Math.floor(time/60),min=Math.round(time%60);if(hr<1&&min<1){return _64a;}else{if(hr<1){_649=ibm.tivoli.fwm.i18n.getMaxMsg("map","timemin");_64a=_649.replace("{0}",min.toString());}else{_649=ibm.tivoli.fwm.i18n.getMaxMsg("map","timehmin");_64a=_649.replace("{0}",hr.toString());_64a=_64a.replace("{1}",min.toString());}}return _64a;}};dojo.declare("ibm.tivoli.fwm.mxmap.routing.Router",ibm.tivoli.fwm.mxmap._Base,{routecolor:null,endLocation:null,startLocation:null,optimizeroute:false,myCurrentLocationInstance:null,constructor:function(_64b){dojo.mixin(this,_64b);this.myCurrentLocationInstance=ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation.getMyCurrentLocationInstance();},getUserLocation:function(_64c,_64d){if(this.myCurrentLocationInstance){var _64e=function(){if(this.map){this.map.failedToGetLocation();}_64d();};this.myCurrentLocationInstance.getUserLocation(_64c,dojo.hitch(this,_64e));}},_getUserLocationStop:function(){var _64f=null;if(this.myCurrentLocationInstance){var _650=this.myCurrentLocationInstance.getPosition();_64f={name:"currentLocation",lat:_650.coords.latitude,lng:_650.coords.longitude};}return _64f;},isLocationStatusUnassigned:function(){var _651=false;if(this.myCurrentLocationInstance){_651=this.myCurrentLocationInstance.isStatusUnassigned();}return _651;},isLocationStatusHasLocation:function(){var _652=false;if(this.myCurrentLocationInstance){_652=this.myCurrentLocationInstance.isStatusHasLocation();}return _652;},_checkForCalculatedStops:function(_653){if(_653&&_653.length>0){if(_653[0].calculatedStop==true){_653=_653.slice(1,_653.length);}if(dojo.config.fwm.debug==true){}var _654=0;if(_653.length==0){return _653;}if(_653.length>0){_654=_653.length-1;}if(_653[_653.length-1].calculatedStop==true){_653=_653.slice(0,_653.length-1);}}var i=0;while(i<_653.length){var stop=_653[i];var _655=new ibm.tivoli.fwm.mxmap.MXRecord({mboInfo:stop,map:this.map});if(_655.hasAnyGISCoordinates()==false){console.warn("Stop",stop,"Has no GIS info",_653.length);_653=_653.slice(0,i).concat(_653.slice(i+1));console.warn("Stop",_653.length);}else{i++;}}return _653;},drawRoute:function(_656,_657,_658,_659){_656=this._checkForCalculatedStops(_656);if(this.isStartWithCurrentLocation(_659)&&this.isLocationStatusUnassigned()){var fct=function(){this.drawRoute(_656,_657,_658);};var _65a=function(){this.drawRoute(_656,_657,_658);};this.getUserLocation(dojo.hitch(this,fct),dojo.hitch(this,_65a));}else{var _65b=[];if(this.isStartWithCurrentLocation(_659)&&this.isLocationStatusHasLocation()){var ul=this._getUserLocationStop(_659);ul.calculatedStop=true;ul.calculatedStopType=ibm.tivoli.fwm.mxmap.routing.CalculatedStops.USER_LOCATION_STOP;_65b.push(ul);}else{var _65c=this.startLocation;if(_659&&_659.startLocation!=null){_65c=_659.startLocation;}if(_65c&&_65c.hasOwnProperty("lat")&&_65c.lat!=null){_65c.calculatedStop=true;_65c.calculatedStopType=ibm.tivoli.fwm.mxmap.routing.CalculatedStops.CONF_START_STOP;_65b.push(_65c);}}_65b=_65b.concat(_656);var _65d=this.endLocation;if(_659&&_659.endLocation!=null){_65d=_659.endLocation;}if(_65d&&_65d.hasOwnProperty("lat")&&_65d.lat!=null){_65d.calculatedStop=true;_65d.calculatedStopType=ibm.tivoli.fwm.mxmap.routing.CalculatedStops.CONF_END_STOP;_65b.push(_65d);}if(_65b.length<2){console.warn("at least 2 stops are needed");_658(ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.MIN_STOPS_REQ,"at least 2 stops are needed");return;}this.showRoute(_65b,_657,_658,true,_659);}},showRoute:function(_65e,cb,_65f,_660){throw "No showRoute implementation";},isStartWithCurrentLocation:function(_661){if(_661&&_661.startithcurrentlocation){return _661.startwithcurrentlocation=="true";}else{return this.startwithcurrentlocation=="true";}},isOptimizeRoute:function(){return this.optimizeroute=="true";},destroyRecursive:function(){this.inherited(arguments);},getCurrentDistanceUnit:function(){if(this.customConf){return this.customConf.distanceUnit;}else{return ibm.tivoli.fwm.mxmap.routing.DistanceUnit.KM;}},getAvoidHighways:function(){if(this.customConf){return this.customConf.avoidHighway;}return false;},getAvoidTolls:function(){if(this.customConf){return this.customConf.avoidToll;}return false;},timers:null,_startTimer:function(){try{if(dojo.config.fwm.debug==true){if(this.timers==null){this.timers=[];}this.timers.push(new Date().getTime());return this.timers.length-1;}return -1;}catch(e){}},_stopTimer:function(h,_662){try{if(dojo.config.fwm.debug==true){var endt=new Date().getTime();if(h==null){this.timers=null;}else{}}}catch(e){}}});});},"dijit/form/Button":function(){require({cache:{"url:dijit/form/templates/Button.html":"<span class=\"dijit dijitReset dijitInline\" role=\"presentation\"\n\t><span class=\"dijitReset dijitInline dijitButtonNode\"\n\t\tdata-dojo-attach-event=\"ondijitclick:_onClick\" role=\"presentation\"\n\t\t><span class=\"dijitReset dijitStretch dijitButtonContents\"\n\t\t\tdata-dojo-attach-point=\"titleNode,focusNode\"\n\t\t\trole=\"button\" aria-labelledby=\"${id}_label\"\n\t\t\t><span class=\"dijitReset dijitInline dijitIcon\" data-dojo-attach-point=\"iconNode\"></span\n\t\t\t><span class=\"dijitReset dijitToggleButtonIconChar\">&#x25CF;</span\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"\n\t\t\t\tid=\"${id}_label\"\n\t\t\t\tdata-dojo-attach-point=\"containerNode\"\n\t\t\t></span\n\t\t></span\n\t></span\n\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" class=\"dijitOffScreen\"\n\t\ttabIndex=\"-1\" role=\"presentation\" data-dojo-attach-point=\"valueNode\"\n/></span>\n"}});define("dijit/form/Button",["require","dojo/_base/declare","dojo/dom-class","dojo/_base/kernel","dojo/_base/lang","dojo/ready","./_FormWidget","./_ButtonMixin","dojo/text!./templates/Button.html"],function(_663,_664,_665,_666,lang,_667,_668,_669,_66a){if(!_666.isAsync){_667(0,function(){var _66b=["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"];_663(_66b);});}return _664("dijit.form.Button",[_668,_669],{showLabel:true,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:_66a,_setValueAttr:"valueNode",_onClick:function(e){var ok=this.inherited(arguments);if(ok){if(this.valueNode){this.valueNode.click();e.preventDefault();}}return ok;},_fillContent:function(_66c){if(_66c&&(!this.params||!("label" in this.params))){var _66d=lang.trim(_66c.innerHTML);if(_66d){this.label=_66d;}}},_setShowLabelAttr:function(val){if(this.containerNode){_665.toggle(this.containerNode,"dijitDisplayNone",!val);}this._set("showLabel",val);},setLabel:function(_66e){_666.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_66e);},_setLabelAttr:function(_66f){this.inherited(arguments);if(!this.showLabel&&!("title" in this.params)){this.titleNode.title=lang.trim(this.containerNode.innerText||this.containerNode.textContent||"");}}});});},"dijit/_WidgetBase":function(){define("dijit/_WidgetBase",["require","dojo/_base/array","dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/ready","dojo/Stateful","dojo/topic","dojo/_base/window","./registry"],function(_670,_671,_672,_673,_674,_675,dom,_676,_677,_678,_679,_67a,_67b,lang,on,_67c,_67d,_67e,win,_67f){if(!_67b.isAsync){_67c(0,function(){var _680=["dijit/_base/manager"];_670(_680);});}var _681={};function _682(obj){var ret={};for(var attr in obj){ret[attr.toLowerCase()]=true;}return ret;};function _683(attr){return function(val){_676[val?"set":"remove"](this.domNode,attr,val);this._set(attr,val);};};return _675("dijit._WidgetBase",_67d,{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:_683("lang"),dir:"",_setDirAttr:_683("dir"),textDir:"","class":"",_setClassAttr:{node:"domNode",type:"class"},style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,attributeMap:{},_blankGif:_673.blankGif||_670.toUrl("dojo/resources/blank.gif"),postscript:function(_684,_685){this.create(_684,_685);},create:function(_686,_687){this.srcNodeRef=dom.byId(_687);this._connects=[];this._supportingWidgets=[];if(this.srcNodeRef&&(typeof this.srcNodeRef.id=="string")){this.id=this.srcNodeRef.id;}if(_686){this.params=_686;lang.mixin(this,_686);}this.postMixInProperties();if(!this.id){this.id=_67f.getUniqueId(this.declaredClass.replace(/\./g,"_"));}_67f.add(this);this.buildRendering();if(this.domNode){this._applyAttributes();var _688=this.srcNodeRef;if(_688&&_688.parentNode&&this.domNode!==_688){_688.parentNode.replaceChild(this.domNode,_688);}}if(this.domNode){this.domNode.setAttribute("widgetId",this.id);}this.postCreate();if(this.srcNodeRef&&!this.srcNodeRef.parentNode){delete this.srcNodeRef;}this._created=true;},_applyAttributes:function(){var ctor=this.constructor,list=ctor._setterAttrs;if(!list){list=(ctor._setterAttrs=[]);for(var attr in this.attributeMap){list.push(attr);}var _689=ctor.prototype;for(var _68a in _689){if(_68a in this.attributeMap){continue;}var _68b="_set"+_68a.replace(/^[a-z]|-[a-zA-Z]/g,function(c){return c.charAt(c.length-1).toUpperCase();})+"Attr";if(_68b in _689){list.push(_68a);}}}_671.forEach(list,function(attr){if(this.params&&attr in this.params){}else{if(this[attr]){this.set(attr,this[attr]);}}},this);for(var _68c in this.params){this.set(_68c,this[_68c]);}},postMixInProperties:function(){},buildRendering:function(){if(!this.domNode){this.domNode=this.srcNodeRef||_678.create("div");}if(this.baseClass){var _68d=this.baseClass.split(" ");if(!this.isLeftToRight()){_68d=_68d.concat(_671.map(_68d,function(name){return name+"Rtl";}));}_677.add(this.domNode,_68d);}},postCreate:function(){},startup:function(){if(this._started){return;}this._started=true;_671.forEach(this.getChildren(),function(obj){if(!obj._started&&!obj._destroyed&&lang.isFunction(obj.startup)){obj.startup();obj._started=true;}});},destroyRecursive:function(_68e){this._beingDestroyed=true;this.destroyDescendants(_68e);this.destroy(_68e);},destroy:function(_68f){this._beingDestroyed=true;this.uninitialize();var c;while(c=this._connects.pop()){c.remove();}var w;while(w=this._supportingWidgets.pop()){if(w.destroyRecursive){w.destroyRecursive();}else{if(w.destroy){w.destroy();}}}this.destroyRendering(_68f);_67f.remove(this.id);this._destroyed=true;},destroyRendering:function(_690){if(this.bgIframe){this.bgIframe.destroy(_690);delete this.bgIframe;}if(this.domNode){if(_690){_676.remove(this.domNode,"widgetId");}else{_678.destroy(this.domNode);}delete this.domNode;}if(this.srcNodeRef){if(!_690){_678.destroy(this.srcNodeRef);}delete this.srcNodeRef;}},destroyDescendants:function(_691){_671.forEach(this.getChildren(),function(_692){if(_692.destroyRecursive){_692.destroyRecursive(_691);}});},uninitialize:function(){return false;},_setStyleAttr:function(_693){var _694=this.domNode;if(lang.isObject(_693)){_67a.set(_694,_693);}else{if(_694.style.cssText){_694.style.cssText+="; "+_693;}else{_694.style.cssText=_693;}}this._set("style",_693);},_attrToDom:function(attr,_695,_696){_696=arguments.length>=3?_696:this.attributeMap[attr];_671.forEach(lang.isArray(_696)?_696:[_696],function(_697){var _698=this[_697.node||_697||"domNode"];var type=_697.type||"attribute";switch(type){case "attribute":if(lang.isFunction(_695)){_695=lang.hitch(this,_695);}var _699=_697.attribute?_697.attribute:(/^on[A-Z][a-zA-Z]*$/.test(attr)?attr.toLowerCase():attr);_676.set(_698,_699,_695);break;case "innerText":_698.innerHTML="";_698.appendChild(win.doc.createTextNode(_695));break;case "innerHTML":_698.innerHTML=_695;break;case "class":_677.replace(_698,_695,this[attr]);break;}},this);},get:function(name){var _69a=this._getAttrNames(name);return this[_69a.g]?this[_69a.g]():this[name];},set:function(name,_69b){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _69c=this._getAttrNames(name),_69d=this[_69c.s];if(lang.isFunction(_69d)){var _69e=_69d.apply(this,Array.prototype.slice.call(arguments,1));}else{var _69f=this.focusNode&&!lang.isFunction(this.focusNode)?"focusNode":"domNode",tag=this[_69f].tagName,_6a0=_681[tag]||(_681[tag]=_682(this[_69f])),map=name in this.attributeMap?this.attributeMap[name]:_69c.s in this?this[_69c.s]:((_69c.l in _6a0&&typeof _69b!="function")||/^aria-|^data-|^role$/.test(name))?_69f:null;if(map!=null){this._attrToDom(name,_69b,map);}this._set(name,_69b);}return _69e||this;},_attrPairNames:{},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.replace(/^[a-z]|-[a-zA-Z]/g,function(c){return c.charAt(c.length-1).toUpperCase();});return (apn[name]={n:name+"Node",s:"_set"+uc+"Attr",g:"_get"+uc+"Attr",l:uc.toLowerCase()});},_set:function(name,_6a1){var _6a2=this[name];this[name]=_6a1;if(this._watchCallbacks&&this._created&&_6a1!==_6a2){this._watchCallbacks(name,_6a2,_6a1);}},on:function(type,func){return _672.after(this,this._onMap(type),func,true);},_onMap:function(type){var ctor=this.constructor,map=ctor._onMap;if(!map){map=(ctor._onMap={});for(var attr in ctor.prototype){if(/^on/.test(attr)){map[attr.replace(/^on/,"").toLowerCase()]=attr;}}}return map[type.toLowerCase()];},toString:function(){return "[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]";},getChildren:function(){return this.containerNode?_67f.findWidgets(this.containerNode):[];},getParent:function(){return _67f.getEnclosingWidget(this.domNode.parentNode);},connect:function(obj,_6a3,_6a4){var _6a5=_674.connect(obj,_6a3,this,_6a4);this._connects.push(_6a5);return _6a5;},disconnect:function(_6a6){var i=_671.indexOf(this._connects,_6a6);if(i!=-1){_6a6.remove();this._connects.splice(i,1);}},subscribe:function(t,_6a7){var _6a8=_67e.subscribe(t,lang.hitch(this,_6a7));this._connects.push(_6a8);return _6a8;},unsubscribe:function(_6a9){this.disconnect(_6a9);},isLeftToRight:function(){return this.dir?(this.dir=="ltr"):_679.isBodyLtr();},isFocusable:function(){return this.focus&&(_67a.get(this.domNode,"display")!="none");},placeAt:function(_6aa,_6ab){if(_6aa.declaredClass&&_6aa.addChild){_6aa.addChild(this,_6ab);}else{_678.place(this.domNode,_6aa,_6ab);}return this;},getTextDir:function(text,_6ac){return _6ac;},applyTextDir:function(){}});});},"ibm/tivoli/fwm/mxmap/factory":function(){define(["dijit","dojo","dojox","dojo/require!dojo/io/script"],function(_6ad,dojo,_6ae){dojo.provide("ibm.tivoli.fwm.mxmap.factory");dojo.require("dojo.io.script");ibm.tivoli.fwm.mxmap.stack={};ibm.tivoli.fwm.mxmap.factory={events:{mapImplLoaded:"mxmap.mapImplLoaded"},options:null,initialized:false,tries:10,registry:{},ieWait:function(){ibm.tivoli.fwm.mxmap.factory.tries--;if(ibm.tivoli.fwm.mxmap.factory.tries>0){ibm.tivoli.fwm.mxmap.factory.init();}else{throw "Cannot load MXN...";}},init:function(){dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/ibm/tivoli/fwm/mxn/mxn.js","js");if(dojo.isIE){if(!window.mxn){setTimeout("ibm.tivoli.fwm.mxmap.factory.ieWait()",100);return;}}dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/ibm/tivoli/fwm/mxn/mxn.core.js","js");dojohelper.loadfile(dojo.config.fwm.ctxRoot+"/webclient/javascript/ibm/tivoli/fwm/mxn/mxn.geocoder.js","js");this.initialized=true;},createMap:function(_6af){if(_6af.mapConf.error&&_6af.mapConf.error==true){addCommInput("msgKey",_6af.mapConf.key);addCommInput("msgGroup",_6af.mapConf.group);sendEvent("showErrors",_6af.compId,_6af.mapConf.key);return;}if(this.initialized!=true){this.init();}if(this.mapExists(_6af.compId)){this.destroyCurrentMap(_6af.compId);}var _6b0=_6af.mapConf.provider;if(!this.loaded[_6b0]){ibm.tivoli.fwm.mxmap.stack[_6b0]=[];ibm.tivoli.fwm.mxmap.stack[_6b0].push(_6af);this.loaded[_6b0]=-1;var _6b1="ibm.tivoli.fwm.mxmap.factories."+_6b0;var _6b2="dojo."+"require('"+_6b1+"')";dojo.eval(_6b2);this.options=_6af;eval(_6b1+".init(this.options)");}else{if(this.loaded[_6b0]==-1){ibm.tivoli.fwm.mxmap.stack[_6b0].push(_6af);}else{dojo.publish(ibm.tivoli.fwm.mxmap.factory.events.mapImplLoaded,[this.loaded[_6b0],_6b0]);this._createProviderMap(_6af,this.loaded[_6b0]);}}},mapExists:function(_6b3){return this.registry[_6b3]&&this.registry[_6b3].currentMap;},destroyCurrentMap:function(_6b4){try{if(this.registry[_6b4]&&this.registry[_6b4].currentMap){this.registry[_6b4].currentMap.destroyRecursive();}}catch(e){}this.registry[_6b4]=null;},loaded:{},apiInitialized:function(_6b5,_6b6){this.loaded[_6b6]=_6b5;dojo.publish(ibm.tivoli.fwm.mxmap.factory.events.mapImplLoaded,[_6b5,_6b6]);this.executeStack(_6b5,_6b6);},executeStack:function(_6b7,_6b8){if(ibm.tivoli.fwm.mxmap.stack[_6b8]){var _6b9=ibm.tivoli.fwm.mxmap.stack[_6b8];for(var id in _6b9){var _6ba=_6b9[id];this._createProviderMap(_6ba,_6b7);}}},_createProviderMap:function(_6bb,_6bc){var _6bd=null;eval("this._instance = new "+_6bc+"();");_6bd=this._instance;_6bd.createMap(_6bb);this.registry[_6bb.compId]={currentMap:_6bd};}};});},"ibm/tivoli/fwm/mxmap/layers/TrafficLayer":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_6be,dojo,_6bf){dojo.provide("ibm.tivoli.fwm.mxmap.layers.TrafficLayer");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.layers.TrafficLayer",[ibm.tivoli.fwm.mxmap.layers.Layer],{enable:function(){this.inherited(arguments);this._map.enableTraffic();},disable:function(){this.inherited(arguments);this._map.disableTraffic();}});});},"ibm/tivoli/fwm/mxmap/layers/RouteLayer":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_6c0,dojo,_6c1){dojo.provide("ibm.tivoli.fwm.mxmap.layers.RouteLayer");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.layers.RouteLayer",[ibm.tivoli.fwm.mxmap.layers.Layer],{init:function(){this.inherited(arguments);this.enable();},enable:function(){this.inherited(arguments);this._map.enableRoutes();},disable:function(){this.inherited(arguments);this._map.disableRoutes();}});});},"ibm/tivoli/fwm/mxmap/symbology/SymbologyManager":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_6c2,dojo,_6c3){dojo.provide("ibm.tivoli.fwm.mxmap.symbology.SymbologyManager");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.symbology.SymbologyManager",[ibm.tivoli.fwm.mxmap._Base],{_mapSymbologyJson:null,_map:null,_objectMap:null,_defaultSymbologyConfig:null,constructor:function(_6c4){dojo.mixin(this,_6c4);this._map=_6c4.map;this._mapSymbologyJson=this._map.mapConf.symbologyConfig;this._objectMap=this._buildObjectMap(this._mapSymbologyJson);this._defaultSymbologyConfig=_6c4.defaultSymbologyConfig;},_buildObjectMap:function(_6c5){var _6c6={};if((this._mapSymbologyJson!=null)&&(this._mapSymbologyJson.layers!=null)){for(id in this._mapSymbologyJson.layers){var _6c7=this._mapSymbologyJson.layers[id];_6c6[_6c7.id]=_6c7;this.setActiveSymbologyForLayer(_6c7,_6c7.symbologies[0]);}}return _6c6;},getDefaultLayerConfigFor:function(_6c8){this._layerIdXlation[_6c8]="others";return this.getLayerConfigById(_6c8);},getLayerConfigById:function(id2){var _6c9=id2.toLowerCase();if(this._layerIdXlation[_6c9]!=null){_6c9=this._layerIdXlation[_6c9];}return this._objectMap[_6c9];},getSymbologyConfigArrayByLayer:function(_6ca){var _6cb={};if((_6ca!=null)&&(_6ca.symbologies!=null)){dojo.forEach(_6ca.symbologies,function(_6cc){if(_6cc.id!=null&&_6cc.id!=""){_6cb[_6cc.id]=_6cc;}});}return _6cb;},getLegendConfigArrayBySymbology:function(_6cd){var _6ce={};if((_6cd!=null)&&(_6cd.legends!=null)){dojo.forEach(_6cd.legends,function(_6cf){if(_6cf.id!=null&&_6cf.id!=""){_6ce[_6cf.id]=_6cf;}});}return _6ce;},_layerIdXlation:{},setActiveSymbology:function(_6d0,_6d1){var _6d2=this.getLayerConfigById(_6d0);this.setActiveSymbologyForLayer(_6d2,_6d1);},setActiveSymbologyForLayer:function(_6d3,_6d4){_6d3.activeSymbology=_6d4;},getActiveSymbology:function(_6d5){return this.getLayerConfigById(_6d5).activeSymbology;},getLegendForObject:function(_6d6,_6d7){var _6d8=this.getLayerConfigById(_6d6.mxdata.mboName);return this.getLegendForObjectAndLayer(_6d8,_6d6,_6d7);},getLegendForObjectAndLayer:function(_6d9,_6da,_6db){var _6dc=_6d9.activeSymbology;if(_6dc==null){return ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager().getDefaultMarkerImageInfo();}if(_6dc.id=="resource"){if(_6da.routedata==null){if(_6da.ownDefaultMarker!=null){return _6da.ownDefaultMarker;}else{return this._getDefaultSymbol(_6dc);}}else{var _6dd="";if(document.body.dir=="rtl"){_6dd="/rtl";}return {"url":"../webclient/javascript/ibm/tivoli/fwm/mxmap/resources"+_6dd+"/symbology/workorder/map_WO_"+_6db.replace("#","").toLowerCase()+".png","color":"","offsetx":24,"offsety":36,"width":47,"height":36};}}else{if(_6dc.id=="fwm_default"){if(_6da.ownDefaultMarker!=null){return _6da.ownDefaultMarker;}else{return _6dc.legends[0].symbol;}}else{if(_6dc.type=="numeric"){return this._getNumericSymbol(_6da,_6dc);}else{if(_6dc.type=="domainvalue"||_6dc.type=="tablevalue"){return this._getDomainSymbol(_6da,_6dc);}}return this._getDefaultSymbol(_6dc);}}},_getDefaultSymbol:function(_6de){var _6df=dojo.filter(_6de.legends,function(_6e0){return _6e0.isDefault==true;});return _6df.length>0?_6df[0].symbol:null;},_getNumericSymbol:function(_6e1,_6e2){var val=_6e1.mxdata.attributes[_6e2.id];if(val==""){val="null";var _6e3=dojo.filter(_6e2.legends,function(_6e4){return (_6e4.id==val);});return (_6e3.length>0?_6e3[0].symbol:this._getDefaultSymbol(_6e2));}else{if(!val){return this._getDefaultSymbol(_6e2);}else{var _6e5=parseInt(val);var _6e3=dojo.filter(_6e2.legends,function(_6e6){return (_6e5>=parseInt(_6e6.minValue)&&_6e5<=parseInt(_6e6.maxValue));});return (_6e3.length>0?_6e3[0].symbol:this._getDefaultSymbol(_6e2));}}},_getDomainSymbol:function(_6e7,_6e8){var _6e9=String(_6e7.mxdata.attributes[_6e8.id]).toLowerCase();if(_6e9==""){_6e9="null";}var _6ea=dojo.filter(_6e8.legends,function(_6eb){return (_6eb.id==_6e9);});return (_6ea.length>0?_6ea[0].symbol:this._getDefaultSymbol(_6e8));},getDefaultSymbologyForLayer:function(_6ec){var _6ed=null;if(this._defaultSymbologyConfig!=null){var _6ee=null;_6ee=dojo.filter(this._defaultSymbologyConfig,function(pair){return (pair.layer==_6ec);});if(_6ee.length>0){_6ed=_6ee[0].symbology;}}return _6ed;}});});},"url:dijit/templates/Tooltip.html":"<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\"\n\t><div class=\"dijitTooltipContainer dijitTooltipContents\" data-dojo-attach-point=\"containerNode\" role='alert'></div\n\t><div class=\"dijitTooltipConnector\" data-dojo-attach-point=\"connectorNode\"></div\n></div>\n","dijit/_base/sniff":function(){define("dijit/_base/sniff",["dojo/uacss"],function(){});},"ibm/tivoli/fwm/mxmap/geolocation/LocationMonitor":function(){define(["dijit","dojo","dojox","dojo/require!dojox/timing/_base,ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/geolocation/MyCurrentLocation"],function(_6ef,dojo,_6f0){dojo.provide("ibm.tivoli.fwm.mxmap.geolocation.LocationMonitor");dojo.require("dojox.timing._base");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation");ibm.tivoli.fwm.mxmap.geolocation.LocationMonitor._instance=null;dojo.declare("ibm.tivoli.fwm.mxmap.geolocation.LocationMonitor",ibm.tivoli.fwm.mxmap._Base,{interval:0,_timer:null,compId:null,_myCurrentLocation:null,constructor:function(_6f1){dojo.mixin(this,_6f1);this._myCurrentLocation=ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation.getMyCurrentLocationInstance();},start:function(){if(this._timer==null){if(this.interval>0){this._doStart();}else{}}else{}},stop:function(){if(this._timer==null){if(dojo.config.fwm.debug==true){}}else{if(dojo.config.fwm.debug==true){}this._timer.stop();this._timer=null;}},started:function(){return (this._timer!=null);},_doStart:function(){this._myCurrentLocation.getUserLocation(dojo.hitch(this,this._updateMaximoRecord),dojo.hitch(this,this._failedToGetCurrentLocation));this._timer=new _6f0.timing.Timer(this.interval*1000);this._timer.onTick=dojo.hitch(this,function(){if(this._myCurrentLocation){this._myCurrentLocation.getUserLocation(dojo.hitch(this,this._updateMaximoRecord),dojo.hitch(this,this._failedToGetCurrentLocation));}});this._timer.onStart=dojo.hitch(this,function(){});this._timer.onStop=dojo.hitch(this,function(){});this._timer.start();},_updateMaximoRecord:function(_6f2){if(_6f2&&_6f2.coords){var _6f3=_6f2.coords;var _6f4=new Event("loadLaborLBS",this.compId,{lat:_6f3.latitude,lng:_6f3.longitude,locationAccuracy:_6f3.accuracy,altitudeAccuracy:_6f3.altitudeAccuracy,altitude:_6f3.altitude,heading:_6f3.heading,speed:_6f3.speed},REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_6f4,"text/html","text",dojo.hitch(this,this._messageSuccessfullySentToMaximo),dojo.hitch(this,this._failedToSendMessageToMaximo));}},_failedToGetCurrentLocation:function(){if(this._myCurrentLocation){switch(this._myCurrentLocation.getStatus()){case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.PERMISSION_DENIED:this.stop();console.warn("[LocationMonitor] Could not retrieve current location (PERMISSION_DENIED). LBS data collection stopped.");this._logPermissionDenied();break;case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.GEOLOCATION_NOT_SUPPORTED:this.stop();console.warn("[LocationMonitor] Could not retrieve current location (GEOLOCATION_NOT_SUPPORTED). LBS data collection stopped.");this._logNotSupported();break;case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.TIMEOUT:console.warn("[LocationMonitor] Could not retrieve current location (TIMEOUT).");break;case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.POSITION_UNAVAILABLE:console.warn("[LocationMonitor] Could not retrieve current location (POSITION_UNAVAILABLE).");break;default:break;}}},_failedToSendMessageToMaximo:function(){console.error("[LocationMonitor] Failed to send current location to Maximo");},_messageSuccessfullySentToMaximo:function(){},_logPermissionDenied:function(){sendEvent("logLBSCollectionPermissionDenied",this.compId,"");},_logNotSupported:function(){sendEvent("logLBSCollectionNotSupported",this.compId,"");},destroyRecursive:function(){this.stop();this.inherited(arguments);}});ibm.tivoli.fwm.mxmap.geolocation.LocationMonitor.getLocationMonitorInstance=function(_6f5){if(!ibm.tivoli.fwm.mxmap.geolocation.LocationMonitor._instance){ibm.tivoli.fwm.mxmap.geolocation.LocationMonitor._instance=new ibm.tivoli.fwm.mxmap.geolocation.LocationMonitor(_6f5);}return ibm.tivoli.fwm.mxmap.geolocation.LocationMonitor._instance;};});},"dijit/Toolbar":function(){define("dijit/Toolbar",["require","dojo/_base/declare","dojo/_base/kernel","dojo/keys","dojo/ready","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_6f6,_6f7,_6f8,keys,_6f9,_6fa,_6fb,_6fc){if(!_6f8.isAsync){_6f9(0,function(){var _6fd=["dijit/ToolbarSeparator"];_6f6(_6fd);});}return _6f7("dijit.Toolbar",[_6fa,_6fc,_6fb],{templateString:"<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">"+"</div>",baseClass:"dijitToolbar",postCreate:function(){this.inherited(arguments);this.connectKeyNavHandlers(this.isLeftToRight()?[keys.LEFT_ARROW]:[keys.RIGHT_ARROW],this.isLeftToRight()?[keys.RIGHT_ARROW]:[keys.LEFT_ARROW]);}});});},"ibm/tivoli/fwm/mxmap/routing/impl/bingmaps":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/routing/Router,ibm/tivoli/fwm/mxmap/routing/Route"],function(_6fe,dojo,_6ff){dojo.provide("ibm.tivoli.fwm.mxmap.routing.impl.bingmaps");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.routing.Router");dojo.require("ibm.tivoli.fwm.mxmap.routing.Route");ibm.tivoli.fwm.mxmap.routing.impl.bcc=0;ibm.tivoli.fwm.mxmap.routing.impl.bingmapsId=function(){return ibm.tivoli.fwm.mxmap.routing.impl.bcc++;};dojo.declare("ibm.tivoli.fwm.mxmap.routing.impl.bingmaps",[ibm.tivoli.fwm.mxmap.routing.Router,ibm.tivoli.fwm.mxmap._Base],{directionsService:null,map:null,conf:null,_isLoaded:false,_routeQueue:[],_msHandlers:[],_routeLimits:10,c:0,constructor:function(_700){this.id=ibm.tivoli.fwm.mxmap.routing.impl.bingmapsId();this._msHandlers=[];this._routeQueueParalel=[];this._isLoaded=false;dojo.mixin(this,_700);this.c=0;var _701=dojo.hitch(this,this._loaded);if(Microsoft.Maps.Directions){this.directionsService=new Microsoft.Maps.Directions.DirectionsManager(this.map.getMapstraction().getProviderMap());this._isLoaded=true;}else{Microsoft.Maps.loadModule("Microsoft.Maps.Directions",{callback:_701});}},_loaded:function(){this.directionsService=new Microsoft.Maps.Directions.DirectionsManager(this.map.getMapstraction().getProviderMap());this._isLoaded=true;this._executeQueue();},_routedOk:function(_702,_703){_702.totalDistance=_702.distance;_702.totalDuration=_702.time;_702.map=this.map;var _704=new ibm.tivoli.fwm.mxmap.routing.itinerary.Itinerary();var _705=_702.inputInfo.stops;if(_702.itineraryLegInfo.length>0){var _706=false;if(_705[0].calculatedStop==true){_706=true;}_704.setInitialLocation(_702.itineraryLegInfo[0].startAddress,_702.itineraryLegInfo[0].startLoc,null,null,_706);}_704.addAllLegs(_702.itineraryLegInfo);if(_705[_705.length-1].calculatedStop==true){_704.legs[_704.legs.length-1].needsToGeocode=true;}_702.itinerary=_704;_702.distanceUnit=this.getCurrentDistanceUnit();if(_703){var _707=new ibm.tivoli.fwm.mxmap.routing.Route(_702);_703(_707);}this.isExecuting=false;this.executeQueuedParalel();},_routeError:function(_708,_709){console.error("route failed",_708,_709);if(_709){switch(_708.responseCode){case 2:case 3:case 4:case 5:case 8:case 15:_709(ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.ZERO_RESULTS,_708);break;case 13:case 16:case 18:case 17:_709(ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.REQUEST_DENIED,_708);break;case 11:_709(ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.TIMEOUT,_708);break;default:_709(ibm.tivoli.fwm.mxmap.routing.RoutingErrorCodes.UNKNOWN_ERROR,_708);break;}}this.executeQueuedParalel();},_executeQueue:function(){for(var i=0;i<this._routeQueue.length;i++){var obj=this._routeQueue[i];this.showRoute(obj.stops,obj.callback,obj.errCb,null,obj.instanceConf);}},executeQueuedParalel:function(){if(this._routeQueueParalel.length>0){var obj=this._routeQueueParalel.pop();this.showRoute(obj.stops,obj.callback,obj.errCb,null,obj.instanceConf);}},_extractItinerarySteps:function(_70a){var _70b=[];var _70c=0;for(var id in _70a){var item=_70a[id];var loc=new mxn.LatLonPoint(item.coordinate.latitude,item.coordinate.longitude);var step={distance:_70c,duration:item.durationInSeconds,info:item.formattedText,location:loc};_70b.push(step);_70c=item.distance;}return _70b;},_extractRouteInfo:function(resp,map){var _70d=null;var _70e=[];var _70f=[];var _710=[];for(var j in resp.route){var _711=resp.route[j];for(var k in _711){var leg=_711[k];for(var l in leg){var st=leg[l];if(!st){continue;}var _712=new mxn.LatLonPoint();_712.fromProprietary(this.map.getMapstraction().api,st.startWaypointLocation);_70e.push(_712);var _713=new mxn.LatLonPoint();_713.fromProprietary(this.map.getMapstraction().api,st.endWaypointLocation);var _714={location:_713,startLoc:_712,distanceToLeg:st.summary.distance,durationToLeg:Math.round(st.summary.time/6)/10,info:null,startAddress:null,marker:null,steps:null,onclick:null};for(var m in st.subLegs){var sleg=st.subLegs[m];if(_714.startAddress==null){_714.startAddress=sleg.startDescription;}_70f=_70f.concat(this._getPolylineVertices(sleg,map));_714.info=sleg.endDescription;}_714.steps=this._extractItinerarySteps(st.itineraryItems);_710.push(_714);_70d=new mxn.LatLonPoint();_70d.fromProprietary(this.map.getMapstraction().api,st.endWaypointLocation);}}}return {lastWayPoint:_70d,locations:_70e,itineraryInfo:_710,polylineVertices:_70f};},_getPolylineVertices:function(_715){var _716=[];if(_715&&_715.routePath){var _717=_715.routePath;for(var i in _717.decodedLatitudes){var lat=_717.decodedLatitudes[i];var lng=_717.decodedLongitudes[i];_716.push(new mxn.LatLonPoint(lat,lng));}}return _716;},_routeQueueParalel:null,showRoute:function(_718,_719,_71a,a,_71b){if(this.isExecuting==true){console.warn("there's a execution going on");this._routeQueueParalel.push({stops:_718,callback:_719,errCb:_71a,instanceConf:_71b});return;}if(this._isLoaded==true){this.isExecuting=true;var _71c=function(_71d){this.isExecuting=false;this._routeError(_71d,_71a);};var map=this.map.getMapstraction().getProviderMap();var _71e={distance:0,time:0};if(_71b!=null&&_71b.routecolor){this.routecolor=_71b.routecolor;}var _71f=0;var _720=[];var _721=[];var _722=[];var th=this._startTimer();var _723=function(_724){for(var j in _724.routeSummary){_71e.distance+=_724.routeSummary[j].distance;_71e.time+=_724.routeSummary[j].time;}var _725=this._extractRouteInfo(_724,map);_720=_720.concat(_725.polylineVertices);_722=_722.concat(_725.itineraryInfo);_721=_721.concat(_725.locations);this._stopTimer(th,_721.length);var _726=_725.lastWayPoint;if(_71f<_718.length){var _727=_71f;_71f+=this._routeLimits;if(_71f>=_718.length){_71f=_718.length;}if(_727>0){_727=_727-1;}th=this._startTimer();this._calculateRoute(_718.slice(_727,_71f),dojo.hitch(this,_723),_71a);}else{_721.push(_726);console.warn("final resetDirections");this.directionsService.resetDirections();this._renderRoute(_721,_720,_71e,map,_719,_71a,_722,_718);}};if(_71f<_718.length){var _728=_71f;_71f+=this._routeLimits;if(_71f>=_718.length){_71f=_718.length;}if(_728>0){_728=_728-1;}this._calculateRoute(_718.slice(_728,_71f),dojo.hitch(this,_723),dojo.hitch(this,_71c));}return;}else{console.warn("wait");this._routeQueue.push({stops:_718,callback:_719,errCb:_71a,instanceConf:_71b});}},_renderRoute:function(_729,_72a,_72b,map,_72c,_72d,_72e,_72f){var poly=new mxn.Polyline();poly.points=_72a;poly.color=this.routecolor;poly.setOpacity(this.routeOpacity);poly.setWidth(this.routeLineWidth);_72b.stops=_729;_72b.polyline=poly;var wp=this.directionsService.getRenderOptions().waypointPushpinOptions;wp.draggable=false;var _730=function(opts){this.wp=opts;this._counter=0;this.getNext=function(){this.wp.text=this._generateMarkerText();return this.wp;};this._generateMarkerText=function(){var _731=(this._counter%26);var dis=parseInt(this._counter/26);var _732=String.fromCharCode(65+_731);this._counter++;if(dis>0){_732+=dis;}return _732;};};_72b.customMarkerOptions=new _730(wp);_72b.itineraryLegInfo=_72e;this._stopTimer(null,_72b.stops.length);_72b.inputInfo={stops:_72f,successCb:_72c,errorCb:_72d};_72b.originalRouter=this;this._routedOk(_72b,_72c);},_convertMboToMSLocation:function(_733){var _734;if(_733.hasOwnProperty("gisdata")){if(_733.gisdata.lat!=null&&_733.gisdata.lng!=null){_734=new Microsoft.Maps.Location(_733.gisdata.lat,_733.gisdata.lng);}else{if(_733.autolocate!=null&&_733.autolocate.gisdata!=null){_734=new Microsoft.Maps.Location(_733.autolocate.gisdata.lat,_733.autolocate.gisdata.lng);}else{if(_733.hasOwnProperty("lat")&&_733!=null){_734=new Microsoft.Maps.Location(_733.lat,_733.lng);}else{console.warn("Stop doesn't have gis coords",_733);}}}}else{_734=new Microsoft.Maps.Location(_733.lat,_733.lng);}return _734;},_calculateRoute:function(_735,_736,_737){var _738=null;var _739=null;var _73a=function(arg){if(_738){Microsoft.Maps.Events.removeHandler(_738);}if(_736){_736(arg);}};var _73b=function(_73c){if(_739){Microsoft.Maps.Events.removeHandler(_739);}if(_737){_737(_73c);}};_739=Microsoft.Maps.Events.addHandler(this.directionsService,"directionsError",dojo.hitch(this,_73b));_738=Microsoft.Maps.Events.addHandler(this.directionsService,"directionsUpdated",dojo.hitch(this,_73a));console.warn("resetDirections in _calculateRoute",this.c++);this.directionsService.resetDirections();var _73d={routeMode:Microsoft.Maps.Directions.RouteMode.driving,distanceUnit:Microsoft.Maps.Directions.DistanceUnit.kilometers,routeDraggable:false};if(this.getAvoidHighways()==true&&this.getAvoidTolls()==true){_73d.routeAvoidance=12;}else{if(this.getAvoidTolls()==true){_73d.routeAvoidance=8;}else{if(this.getAvoidHighways()==true){_73d.routeAvoidance=4;}else{_73d.routeAvoidance=0;}}}if(_73d.routeAvoidance&&_73d.routeAvoidance==0&&this.isOptimizeRoute()){_73d.routeOptimization=Microsoft.Maps.Directions.RouteOptimization.shortestDistance;}this.directionsService.setRequestOptions(_73d);for(var i=0;i<_735.length;i++){var stop=_735[i];var loc=this._convertMboToMSLocation(stop);var _73e=new Microsoft.Maps.Directions.Waypoint({location:loc});this.directionsService.addWaypoint(_73e);}var _73f=this.routecolor;var _740=this.routeLineWidth;var _741=this.routeOpacity;if(_73f.indexOf("#")!=0){_73f="#"+_73f;}var _742=Microsoft.Maps.Color.fromHex(_73f);this.directionsService.setRenderOptions({waypointPushpinOptions:{draggable:false},drivingPolylineOptions:{strokeColor:new Microsoft.Maps.Color(_741*255,_742.r,_742.g,_742.b),strokeThickness:_740},autoUpdateMapView:false});this.directionsService.calculateDirections();},destroyRecursive:function(){this.inherited(arguments);for(var hid in this._msHandlers){var _743=this._msHandlers[hid];Microsoft.Maps.Events.removeHandler(_743);}this.directionsService.dispose();}});});},"ibm/tivoli/fwm/mxmap/routing/itinerary/Itinerary":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_744,dojo,_745){dojo.provide("ibm.tivoli.fwm.mxmap.routing.itinerary.Itinerary");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.routing.itinerary.Itinerary",ibm.tivoli.fwm.mxmap._Base,{initialLocation:null,legs:null,constructor:function(_746){dojo.mixin(this,_746);this.legs=[];this.initialLocation={};},setInitialLocation:function(info,_747,_748,_749,_74a){this.initialLocation={location:_747,info:info,needsToGeocode:_74a,marker:_748,onclick:_749};},addAllLegs:function(legs){this.legs=this.legs.concat(legs);},addLeg:function(_74b,info,_74c,_74d,_74e,_74f,_750,pos){var leg={location:_74b,distanceToLeg:_74c,durationToLeg:_74d,info:info,needsToGeocode:false,marker:_74e,steps:_74f,onclick:_750};if(!pos){this.legs.push(leg);return this.legs.length-1;}else{this.legs[pos]=leg;return pos;}},getInitialLocation:function(){return this.initialLocation;},clearAll:function(){this.legs=[];this.initialLocation={};}});});},"ibm/tivoli/fwm/mxmap/impl/MaximoSpatialMover":function(){define(["dijit","dojo","dojox"],function(_751,dojo,_752){dojo.provide("ibm.tivoli.fwm.mxmap.impl.MaximoSpatialMover");dojo.declare("ibm.tivoli.fwm.mxmap.impl.MaximoSpatialMover",null,{isMouseOver:false,isMouseDown:false,originX:0,originY:0,_wasDragged:false,_graphic:null,map:null,_LIMIT_TO_PAN_PXS:40,_connections:[],constructor:function(_753){dojo.mixin(this,_753);this._connections=[];this._wasDragged=false;},_isGraphicDraggable:function(_754){return (_754!=null&&_754.mapstraction_marker!=null&&_754.mapstraction_marker.draggable==true);},_onMouseOver:function(e){dojo.stopEvent(e);e.target.style.cursor="pointer";},_onMouseDown:function(e){if(this._isGraphicDraggable(e.graphic)==true){dojo.publish("startedUserInteractionOnMap",[{objectSource:this,objectSourceName:"MaximoSpatialMover",eventName:"mousedown"}]);e.target.style.cursor="move";this.map.disableMapNavigation();this.isMouseDown=true;this._graphic=e.graphic;this.originX=e.mapPoint.x;this.originY=e.mapPoint.y;this._LIMIT_TO_PAN_VERTICAL=Math.ceil(this.map.height*0.03)+32;this._LIMIT_TO_PAN_HORIZONTAL=Math.ceil(this.map.width*0.02)+32;}},_onMouseDrag:function(e){if(this.isMouseDown==true){dojo.stopEvent(e);this._move(e);this._ensureInsideMap(e);this._wasDragged=true;}},_ensureInsideMap:function(e){var x=e.screenPoint.x;var y=e.screenPoint.y;var _755=this.map.toScreen(this.map.extent.getCenter());var newX=_755.x;var newY=_755.y;var _756=newX;var _757=newY;if(this.map.width-x<=this._LIMIT_TO_PAN_HORIZONTAL){_756=newX+(this._LIMIT_TO_PAN_HORIZONTAL*4);}else{if(x<=this._LIMIT_TO_PAN_HORIZONTAL){_756=newX-(this._LIMIT_TO_PAN_HORIZONTAL*4);}}if(this.map.height-y<=this._LIMIT_TO_PAN_VERTICAL){_757=newY+(this._LIMIT_TO_PAN_VERTICAL*4);}else{if(y<=this._LIMIT_TO_PAN_VERTICAL){_757=newY-(this._LIMIT_TO_PAN_VERTICAL*4);}}if(newX!=_756||newY!=_757){var _758=this._calculateShiftForMarker(_756-newX,_757-newY);this._shiftMapCenter(_756,_757);this._shiftMarker(_758);}},_shiftMarker:function(_759){this._doMove(_759.x,_759.y);},_move:function(e){this._doMove(e.mapPoint.x,e.mapPoint.y);},_calculateShiftForMarker:function(_75a,_75b){var _75c=new esri.geometry.Point(this.originX,this.originY,this.map.sr);var _75d=this.map.toScreen(_75c);if(dojo.config.fwm.debug==true){}var _75e=new esri.geometry.Point(_75d.x+_75a,_75d.y+_75b,this.map.sr);if(dojo.config.fwm.debug==true){}return this.map.toMap(_75e);},_shiftMapCenter:function(_75f,_760){var _761=new esri.geometry.Point(_75f,_760);var _762=this.map.toMap(_761);this.map.centerAt(_762);},_doMove:function(_763,_764){var _765=(_763-this.originX);var _766=(_764-this.originY);var _767=this._graphic.geometry.offset(_765,_766);this.originX=_763;this.originY=_764;this._graphic.setGeometry(_767);},_onMouseUp:function(e){if(this._isGraphicDraggable(e.graphic)==true){dojo.stopEvent(e);this.isMouseDown=false;this._wasDragged=false;this.originX=0;this.originY=0;this.map.enableMapNavigation();e.target.style.cursor="pointer";this._graphic=null;}},_onMapMouseOut:function(e){if(this.isMouseDown==true){this._onMouseDragEnd(e);this._onMouseUp(e);}},_onMouseDragEnd:function(e){if(this.isMouseDown==true&&this._wasDragged==true){if(dojo.config.fwm.debug==true){}var _768=this._graphic.mapstraction_marker;_768.dragend.fire({marker:_768,newLocation:{lng:this._graphic.geometry.x,lat:this._graphic.geometry.y}});}dojo.publish("endedUserInteractionOnMap",[{objectSource:this,objectSourceName:"MaximoSpatialMover",eventName:"mouseDragEnd"}]);},installListenersOn:function(_769){if(dojo.config.fwm.debug==true){}this._connections.push(dojo.connect(_769,"onMouseDown",dojo.hitch(this,this._onMouseDown)));this._connections.push(dojo.connect(_769,"onMouseUp",dojo.hitch(this,this._onMouseDragEnd)));this._connections.push(dojo.connect(_769,"onMouseUp",dojo.hitch(this,this._onMouseUp)));this._connections.push(dojo.connect(_769,"onMouseDrag",dojo.hitch(this,this._onMouseDrag)));this._connections.push(dojo.connect(this.map,"onMouseDrag",dojo.hitch(this,this._onMouseDrag)));this._connections.push(dojo.connect(this.map,"onMouseOut",dojo.hitch(this,this._onMapMouseOut)));this._connections.push(dojo.connect(this.map,"onMouseUp",dojo.hitch(this,this._onMapMouseOut)));},disconnectInstalledListeners:function(){if(dojo.config.fwm.debug==true){}for(var link in this._connections){dojo.disconnect(this._connections[link]);}this._connections=[];}});});},"dijit/DropDownMenu":function(){require({cache:{"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n"}});define("dijit/DropDownMenu",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(_76a,_76b,keys,_76c,_76d,_76e){return _76a("dijit.DropDownMenu",[_76e,_76d],{templateString:_76c,baseClass:"dijitMenu",postCreate:function(){var l=this.isLeftToRight();this._openSubMenuKey=l?keys.RIGHT_ARROW:keys.LEFT_ARROW;this._closeSubMenuKey=l?keys.LEFT_ARROW:keys.RIGHT_ARROW;this.connectKeyNavHandlers([keys.UP_ARROW],[keys.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_76b.stop(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_76b.stop(evt);}break;}}});});},"dijit/form/_FormMixin":function(){define("dijit/form/_FormMixin",["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/window"],function(_76f,_770,_771,lang,_772){return _770("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(_773){var res=[];_76f.forEach(_773||this.getChildren(),function(_774){if("value" in _774){res.push(_774);}else{res=res.concat(this._getDescendantFormWidgets(_774.getChildren()));}},this);return res;},reset:function(){_76f.forEach(this._getDescendantFormWidgets(),function(_775){if(_775.reset){_775.reset();}});},validate:function(){var _776=false;return _76f.every(_76f.map(this._getDescendantFormWidgets(),function(_777){_777._hasBeenBlurred=true;var _778=_777.disabled||!_777.validate||_777.validate();if(!_778&&!_776){_772.scrollIntoView(_777.containerNode||_777.domNode);_777.focus();_776=true;}return _778;}),function(item){return item;});},setValues:function(val){_771.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",val);},_setValueAttr:function(obj){var map={};_76f.forEach(this._getDescendantFormWidgets(),function(_779){if(!_779.name){return;}var _77a=map[_779.name]||(map[_779.name]=[]);_77a.push(_779);});for(var name in map){if(!map.hasOwnProperty(name)){continue;}var _77b=map[name],_77c=lang.getObject(name,false,obj);if(_77c===undefined){continue;}if(!lang.isArray(_77c)){_77c=[_77c];}if(typeof _77b[0].checked=="boolean"){_76f.forEach(_77b,function(w){w.set("value",_76f.indexOf(_77c,w.value)!=-1);});}else{if(_77b[0].multiple){_77b[0].set("value",_77c);}else{_76f.forEach(_77b,function(w,i){w.set("value",_77c[i]);});}}}},getValues:function(){_771.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value");},_getValueAttr:function(){var obj={};_76f.forEach(this._getDescendantFormWidgets(),function(_77d){var name=_77d.name;if(!name||_77d.disabled){return;}var _77e=_77d.get("value");if(typeof _77d.checked=="boolean"){if(/Radio/.test(_77d.declaredClass)){if(_77e!==false){lang.setObject(name,_77e,obj);}else{_77e=lang.getObject(name,false,obj);if(_77e===undefined){lang.setObject(name,null,obj);}}}else{var ary=lang.getObject(name,false,obj);if(!ary){ary=[];lang.setObject(name,ary,obj);}if(_77e!==false){ary.push(_77e);}}}else{var prev=lang.getObject(name,false,obj);if(typeof prev!="undefined"){if(lang.isArray(prev)){prev.push(_77e);}else{lang.setObject(name,[prev,_77e],obj);}}else{lang.setObject(name,_77e,obj);}}});return obj;},isValid:function(){return this.state=="";},onValidStateChange:function(){},_getState:function(){var _77f=_76f.map(this._descendants,function(w){return w.get("state")||"";});return _76f.indexOf(_77f,"Error")>=0?"Error":_76f.indexOf(_77f,"Incomplete")>=0?"Incomplete":"";},disconnectChildren:function(){_76f.forEach(this._childConnections||[],lang.hitch(this,"disconnect"));_76f.forEach(this._childWatches||[],function(w){w.unwatch();});},connectChildren:function(_780){var _781=this;this.disconnectChildren();this._descendants=this._getDescendantFormWidgets();var set=_780?function(name,val){_781[name]=val;}:lang.hitch(this,"_set");set("value",this.get("value"));set("state",this._getState());var _782=(this._childConnections=[]),_783=(this._childWatches=[]);_76f.forEach(_76f.filter(this._descendants,function(item){return item.validate;}),function(_784){_76f.forEach(["state","disabled"],function(attr){_783.push(_784.watch(attr,function(){_781.set("state",_781._getState());}));});});var _785=function(){if(_781._onChangeDelayTimer){clearTimeout(_781._onChangeDelayTimer);}_781._onChangeDelayTimer=setTimeout(function(){delete _781._onChangeDelayTimer;_781._set("value",_781.get("value"));},10);};_76f.forEach(_76f.filter(this._descendants,function(item){return item.onChange;}),function(_786){_782.push(_781.connect(_786,"onChange",_785));_783.push(_786.watch("disabled",_785));});},startup:function(){this.inherited(arguments);this.connectChildren(true);this.watch("state",function(attr,_787,_788){this.onValidStateChange(_788=="");});},destroy:function(){this.disconnectChildren();this.inherited(arguments);}});});},"dijit/Menu":function(){define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/_base/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(_789,_78a,_78b,_78c,dom,_78d,_78e,_78f,_790,keys,lang,on,has,win,_791,pm,_792,_793){if(!_790.isAsync){_793(0,function(){var _794=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];_789(_794);});}return _78b("dijit.Menu",_792,{constructor:function(){this._bindings=[];},targetNodeIds:[],contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(win.body());}else{_78a.forEach(this.targetNodeIds,this.bindDomNode,this);}this.inherited(arguments);},_iframeContentWindow:function(_795){return _791.get(this._iframeContentDocument(_795))||this._iframeContentDocument(_795)["__parent__"]||(_795.name&&win.doc.frames[_795.name])||null;},_iframeContentDocument:function(_796){return _796.contentDocument||(_796.contentWindow&&_796.contentWindow.document)||(_796.name&&win.doc.frames[_796.name]&&win.doc.frames[_796.name].document)||null;},bindDomNode:function(node){node=dom.byId(node);var cn;if(node.tagName.toLowerCase()=="iframe"){var _797=node,_798=this._iframeContentWindow(_797);cn=win.withGlobal(_798,win.body);}else{cn=(node==win.body()?win.doc.documentElement:node);}var _799={node:node,iframe:_797};_78d.set(node,"_dijitMenu"+this.id,this._bindings.push(_799));var _79a=lang.hitch(this,function(cn){return [on(cn,this.leftClickToOpen?"click":"contextmenu",lang.hitch(this,function(evt){_78c.stop(evt);this._scheduleOpen(evt.target,_797,{x:evt.pageX,y:evt.pageY});})),on(cn,"keydown",lang.hitch(this,function(evt){if(evt.shiftKey&&evt.keyCode==keys.F10){_78c.stop(evt);this._scheduleOpen(evt.target,_797);}}))];});_799.connects=cn?_79a(cn):[];if(_797){_799.onloadHandler=lang.hitch(this,function(){var _79b=this._iframeContentWindow(_797);cn=win.withGlobal(_79b,win.body);_799.connects=_79a(cn);});if(_797.addEventListener){_797.addEventListener("load",_799.onloadHandler,false);}else{_797.attachEvent("onload",_799.onloadHandler);}}},unBindDomNode:function(_79c){var node;try{node=dom.byId(_79c);}catch(e){return;}var _79d="_dijitMenu"+this.id;if(node&&_78d.has(node,_79d)){var bid=_78d.get(node,_79d)-1,b=this._bindings[bid],h;while(h=b.connects.pop()){h.remove();}var _79e=b.iframe;if(_79e){if(_79e.removeEventListener){_79e.removeEventListener("load",b.onloadHandler,false);}else{_79e.detachEvent("onload",b.onloadHandler);}}_78d.remove(node,_79d);delete this._bindings[bid];}},_scheduleOpen:function(_79f,_7a0,_7a1){if(!this._openTimer){this._openTimer=setTimeout(lang.hitch(this,function(){delete this._openTimer;this._openMyself({target:_79f,iframe:_7a0,coords:_7a1});}),1);}},_openMyself:function(args){var _7a2=args.target,_7a3=args.iframe,_7a4=args.coords;if(_7a4){if(_7a3){var ifc=_78e.position(_7a3,true),_7a5=this._iframeContentWindow(_7a3),_7a6=win.withGlobal(_7a5,"_docScroll",dojo);var cs=_78f.getComputedStyle(_7a3),tp=_78f.toPixelValue,left=(has("ie")&&has("quirks")?0:tp(_7a3,cs.paddingLeft))+(has("ie")&&has("quirks")?tp(_7a3,cs.borderLeftWidth):0),top=(has("ie")&&has("quirks")?0:tp(_7a3,cs.paddingTop))+(has("ie")&&has("quirks")?tp(_7a3,cs.borderTopWidth):0);_7a4.x+=ifc.x+left-_7a6.x;_7a4.y+=ifc.y+top-_7a6.y;}}else{_7a4=_78e.position(_7a2,true);_7a4.x+=10;_7a4.y+=10;}var self=this;var _7a7=this._focusManager.get("prevNode");var _7a8=this._focusManager.get("curNode");var _7a9=!_7a8||(dom.isDescendant(_7a8,this.domNode))?_7a7:_7a8;function _7aa(){if(self.refocus&&_7a9){_7a9.focus();}pm.close(self);};pm.open({popup:this,x:_7a4.x,y:_7a4.y,onExecute:_7aa,onCancel:_7aa,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);pm.close(this);};},uninitialize:function(){_78a.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});});},"dijit/form/_CheckBoxMixin":function(){define("dijit/form/_CheckBoxMixin",["dojo/_base/declare","dojo/dom-attr","dojo/_base/event"],function(_7ab,_7ac,_7ad){return _7ab("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:false,_aria_attr:"aria-checked",_setReadOnlyAttr:function(_7ae){this._set("readOnly",_7ae);_7ac.set(this.focusNode,"readOnly",_7ae);this.focusNode.setAttribute("aria-readonly",_7ae);},_setLabelAttr:undefined,postMixInProperties:function(){if(this.value==""){this.value="on";}this.inherited(arguments);},reset:function(){this.inherited(arguments);this._set("value",this.params.value||"on");_7ac.set(this.focusNode,"value",this.value);},_onClick:function(e){if(this.readOnly){_7ad.stop(e);return false;}return this.inherited(arguments);}});});},"dijit/layout/ContentPane":function(){define("dijit/layout/ContentPane",["dojo/_base/kernel","dojo/_base/lang","../_Widget","./_ContentPaneResizeMixin","dojo/string","dojo/html","dojo/i18n!../nls/loading","dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/_base/window","dojo/_base/xhr","dojo/i18n"],function(_7af,lang,_7b0,_7b1,_7b2,html,_7b3,_7b4,_7b5,_7b6,dom,_7b7,win,xhr,i18n){return _7b5("dijit.layout.ContentPane",[_7b0,_7b1],{href:"",content:"",extractContent:false,parseOnLoad:true,parserScope:_7af._scopeName,preventCache:false,preload:false,refreshOnShow:false,loadingMessage:"<span class='dijitContentPaneLoading'><span class='dijitInline dijitIconLoading'></span>${loadingState}</span>",errorMessage:"<span class='dijitContentPaneError'><span class='dijitInline dijitIconError'></span>${errorState}</span>",isLoaded:false,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:true,template:false,create:function(_7b8,_7b9){if((!_7b8||!_7b8.template)&&_7b9&&!("href" in _7b8)&&!("content" in _7b8)){var df=win.doc.createDocumentFragment();_7b9=dom.byId(_7b9);while(_7b9.firstChild){df.appendChild(_7b9.firstChild);}_7b8=lang.delegate(_7b8,{content:df});}this.inherited(arguments,[_7b8,_7b9]);},postMixInProperties:function(){this.inherited(arguments);var _7ba=i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_7b2.substitute(this.loadingMessage,_7ba);this.errorMessage=_7b2.substitute(this.errorMessage,_7ba);},buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}this.domNode.title="";if(!_7b7.get(this.domNode,"role")){this.domNode.setAttribute("role","group");}},startup:function(){this.inherited(arguments);if(this._contentSetter){_7b4.forEach(this._contentSetter.parseResults,function(obj){if(!obj._started&&!obj._destroyed&&lang.isFunction(obj.startup)){obj.startup();obj._started=true;}},this);}},setHref:function(href){_7af.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.","","2.0");return this.set("href",href);},_setHrefAttr:function(href){this.cancel();this.onLoadDeferred=new _7b6(lang.hitch(this,"cancel"));this.onLoadDeferred.addCallback(lang.hitch(this,"onLoad"));this._set("href",href);if(this.preload||(this._created&&this._isShown())){this._load();}else{this._hrefChanged=true;}return this.onLoadDeferred;},setContent:function(data){_7af.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",data);},_setContentAttr:function(data){this._set("href","");this.cancel();this.onLoadDeferred=new _7b6(lang.hitch(this,"cancel"));if(this._created){this.onLoadDeferred.addCallback(lang.hitch(this,"onLoad"));}this._setContent(data||"");this._isDownloaded=false;return this.onLoadDeferred;},_getContentAttr:function(){return this.containerNode.innerHTML;},cancel:function(){if(this._xhrDfd&&(this._xhrDfd.fired==-1)){this._xhrDfd.cancel();}delete this._xhrDfd;this.onLoadDeferred=null;},uninitialize:function(){if(this._beingDestroyed){this.cancel();}this.inherited(arguments);},destroyRecursive:function(_7bb){if(this._beingDestroyed){return;}this.inherited(arguments);},_onShow:function(){this.inherited(arguments);if(this.href){if(!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow)){return this.refresh();}}},refresh:function(){this.cancel();this.onLoadDeferred=new _7b6(lang.hitch(this,"cancel"));this.onLoadDeferred.addCallback(lang.hitch(this,"onLoad"));this._load();return this.onLoadDeferred;},_load:function(){this._setContent(this.onDownloadStart(),true);var self=this;var _7bc={preventCache:(this.preventCache||this.refreshOnShow),url:this.href,handleAs:"text"};if(lang.isObject(this.ioArgs)){lang.mixin(_7bc,this.ioArgs);}var hand=(this._xhrDfd=(this.ioMethod||xhr.get)(_7bc));hand.addCallback(function(html){try{self._isDownloaded=true;self._setContent(html,false);self.onDownloadEnd();}catch(err){self._onError("Content",err);}delete self._xhrDfd;return html;});hand.addErrback(function(err){if(!hand.canceled){self._onError("Download",err);}delete self._xhrDfd;return err;});delete this._hrefChanged;},_onLoadHandler:function(data){this._set("isLoaded",true);try{this.onLoadDeferred.callback(data);}catch(e){console.error("Error "+this.widgetId+" running custom onLoad code: "+e.message);}},_onUnloadHandler:function(){this._set("isLoaded",false);try{this.onUnload();}catch(e){console.error("Error "+this.widgetId+" running custom onUnload code: "+e.message);}},destroyDescendants:function(_7bd){if(this.isLoaded){this._onUnloadHandler();}var _7be=this._contentSetter;_7b4.forEach(this.getChildren(),function(_7bf){if(_7bf.destroyRecursive){_7bf.destroyRecursive(_7bd);}});if(_7be){_7b4.forEach(_7be.parseResults,function(_7c0){if(_7c0.destroyRecursive&&_7c0.domNode&&_7c0.domNode.parentNode==win.body()){_7c0.destroyRecursive(_7bd);}});delete _7be.parseResults;}if(!_7bd){html._emptyNode(this.containerNode);}delete this._singleChild;},_setContent:function(cont,_7c1){this.destroyDescendants();var _7c2=this._contentSetter;if(!(_7c2&&_7c2 instanceof html._ContentSetter)){_7c2=this._contentSetter=new html._ContentSetter({node:this.containerNode,_onError:lang.hitch(this,this._onError),onContentError:lang.hitch(this,function(e){var _7c3=this.onContentError(e);try{this.containerNode.innerHTML=_7c3;}catch(e){console.error("Fatal "+this.id+" could not change content due to "+e.message,e);}})});}var _7c4=lang.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!cont.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:false,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{});_7c2.set((lang.isObject(cont)&&cont.domNode)?cont.domNode:cont,_7c4);delete this._contentSetterParams;if(this.doLayout){this._checkIfSingleChild();}if(!_7c1){if(this._started){delete this._started;this.startup();this._scheduleLayout();}this._onLoadHandler(cont);}},_onError:function(type,err,_7c5){this.onLoadDeferred.errback(err);var _7c6=this["on"+type+"Error"].call(this,err);if(_7c5){console.error(_7c5,err);}else{if(_7c6){this._setContent(_7c6,true);}}},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage;},onContentError:function(){},onDownloadError:function(){return this.errorMessage;},onDownloadEnd:function(){}});});},"dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_7c7,_7c8,_7c9,_7ca,keys,_7cb,_7cc,_7cd,lang){return _7cb("dijit._KeyNavContainer",[_7c9,_7c8],{tabIndex:"0",connectKeyNavHandlers:function(_7ce,_7cf){var _7d0=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_7ca.forEach(_7ce,function(code){_7d0[code]=prev;});_7ca.forEach(_7cf,function(code){_7d0[code]=next;});_7d0[keys.HOME]=lang.hitch(this,"focusFirstChild");_7d0[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_7c7.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_7ca.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_7d1,_7d2){this.inherited(arguments);this._startupChild(_7d1);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_7d3,last){if(!_7d3){return;}if(this.focusedChild&&_7d3!==this.focusedChild){this._onChildBlur(this.focusedChild);}_7d3.set("tabIndex",this.tabIndex);_7d3.focus(last?"end":"start");this._set("focusedChild",_7d3);},_startupChild:function(_7d4){_7d4.set("tabIndex","-1");this.connect(_7d4,"_onFocus",function(){_7d4.set("tabIndex",this.tabIndex);});this.connect(_7d4,"_onBlur",function(){_7d4.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_7cd.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_7cd.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_7cc.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_7d5,dir){if(_7d5){_7d5=this._getSiblingOfChild(_7d5,dir);}var _7d6=this.getChildren();for(var i=0;i<_7d6.length;i++){if(!_7d5){_7d5=_7d6[(dir>0)?0:(_7d6.length-1)];}if(_7d5.isFocusable()){return _7d5;}_7d5=this._getSiblingOfChild(_7d5,dir);}return null;}});});},"dijit/layout/utils":function(){define("dijit/layout/utils",["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang",".."],function(_7d7,_7d8,_7d9,_7da,lang,_7db){var _7dc=lang.getObject("layout",true,_7db);_7dc.marginBox2contentBox=function(node,mb){var cs=_7da.getComputedStyle(node);var me=_7d9.getMarginExtents(node,cs);var pb=_7d9.getPadBorderExtents(node,cs);return {l:_7da.toPixelValue(node,cs.paddingLeft),t:_7da.toPixelValue(node,cs.paddingTop),w:mb.w-(me.w+pb.w),h:mb.h-(me.h+pb.h)};};function _7dd(word){return word.substring(0,1).toUpperCase()+word.substring(1);};function size(_7de,dim){var _7df=_7de.resize?_7de.resize(dim):_7d9.setMarginBox(_7de.domNode,dim);if(_7df){lang.mixin(_7de,_7df);}else{lang.mixin(_7de,_7d9.getMarginBox(_7de.domNode));lang.mixin(_7de,dim);}};_7dc.layoutChildren=function(_7e0,dim,_7e1,_7e2,_7e3){dim=lang.mixin({},dim);_7d8.add(_7e0,"dijitLayoutContainer");_7e1=_7d7.filter(_7e1,function(item){return item.region!="center"&&item.layoutAlign!="client";}).concat(_7d7.filter(_7e1,function(item){return item.region=="center"||item.layoutAlign=="client";}));_7d7.forEach(_7e1,function(_7e4){var elm=_7e4.domNode,pos=(_7e4.region||_7e4.layoutAlign);if(!pos){throw new Error("No region setting for "+_7e4.id);}var _7e5=elm.style;_7e5.left=dim.l+"px";_7e5.top=dim.t+"px";_7e5.position="absolute";_7d8.add(elm,"dijitAlign"+_7dd(pos));var _7e6={};if(_7e2&&_7e2==_7e4.id){_7e6[_7e4.region=="top"||_7e4.region=="bottom"?"h":"w"]=_7e3;}if(pos=="top"||pos=="bottom"){_7e6.w=dim.w;size(_7e4,_7e6);dim.h-=_7e4.h;if(pos=="top"){dim.t+=_7e4.h;}else{_7e5.top=dim.t+dim.h+"px";}}else{if(pos=="left"||pos=="right"){_7e6.h=dim.h;size(_7e4,_7e6);dim.w-=_7e4.w;if(pos=="left"){dim.l+=_7e4.w;}else{_7e5.left=dim.l+dim.w+"px";}}else{if(pos=="client"||pos=="center"){size(_7e4,dim);}}}});};return {marginBox2contentBox:_7dc.marginBox2contentBox,layoutChildren:_7dc.layoutChildren};});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_7e7,_7e8){return _7e7("dijit._Contained",null,{_getSibling:function(_7e9){var node=this.domNode;do{node=node[_7e9+"Sibling"];}while(node&&node.nodeType!=1);return node&&_7e8.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"ibm/tivoli/fwm/mxmap/MaximoIntegration":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base"],function(_7ea,dojo,_7eb){dojo.provide("ibm.tivoli.fwm.mxmap.MaximoIntegration");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap.MaximoIntegration",ibm.tivoli.fwm.mxmap._Base,{compId:null,constructor:function(_7ec){dojo.mixin(this,_7ec);this.addSubscription(dojo.subscribe("mxmap_onServerData_"+this.compId,dojo.hitch(this,this.handleServer)));},resetMaximoTimeout:function(_7ed){try{if(!_7ed){_7ed=false;}resetLogoutTimer(_7ed);}catch(e){}},handleServer:function(_7ee){var _7ef=null;try{this.resetMaximoTimeout(true);if(_7ee){for(var id in _7ee){_7ef=_7ee[id];switch(_7ef.action){case "updatedCurrentRecordLocation":undefined;dojo.publish("onCurrentRecordUpdate_"+this.compId,[_7ef.data.currentMbo]);break;case "updatedRecordSetLocation":if(_7ef.data.currentMbo){dojo.publish("onCurrentRecordUpdate_"+this.compId,[_7ef.data.currentMbo]);}dojo.publish("onCurrentRecordSetUpdated_"+this.compId,[_7ef.data.records]);break;case "addRecordsToLayer":undefined;dojo.publish("addRecordsToLayer_"+this.compId,[_7ef.layerName,_7ef.data.records,_7ef.cleanBeforeAdd]);break;case "removeRecordsFromLayer":undefined;dojo.publish("removeRecordsFromLayer_"+this.compId,[_7ef.layerName,_7ef.data.records]);break;case "exception":dojo.publish("onServerException_"+this.compId,[_7ef.data.failedAction]);console.warn("An exception was thrown from server",_7ef.data);break;case "refreshroute":console.warn("refreshroute",_7ef);dojo.publish("refreshroute_"+this.compId,[_7ef.data]);break;case "refreshdatasource":console.warn("refreshdatasource",_7ef);this.refreshDatasource(dojo.hitch(this,function(_7f0){this.handleServer(_7f0);}),function(){});break;case "noop":sendEvent("NOOP",this.compId,"");break;default:dojo.publish(_7ef.action+"_"+this.compId,[_7ef.data]);break;}}}}catch(e){if(_7ef){console.error("Failed executing server action: ",_7ef,e);}else{console.error("Failed executing server actions: ",_7ee,e);}}},storeUserLocation:function(_7f1){var _7f2=new Event("storeUserLocation",this.compId,dojo.toJson(_7f1),REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_7f2,"application/json","json",function(){},function(){console.error("failed to save user context.");});},getRouteStops:function(_7f3,_7f4,_7f5,_7f6){if(_7f5==null){_7f5=false;}var _7f7=function(data){if(data.error){_7f4(data);}else{if(data.forceUIRefresh==true){data.hasRoute=false;sendEvent("NOOP",this.compId,"");}_7f3(data);}};if(!_7f6){_7f6=false;}var _7f8=new Event("getRouteStops",this.compId+"_router",{forceRefresh:_7f5,serverCallback:_7f6},REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_7f8,"application/json","json",dojo.hitch(this,_7f7),_7f4);},loadMapTipTemplate:function(_7f9,_7fa,_7fb){var _7fc=new Event("loadMapTipTemplate",this.compId,{objectName:_7f9.mboName,objectId:_7f9.uid.value},REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_7fc,"text/html","text",_7fa,_7fb);},loadMapTipItems:function(_7fd,_7fe){var _7ff=new Event("loadMenuItems",this.compId,"",REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_7ff,"application/json","json",_7fd,_7fe);},setCurrentRecordLocation:function(_800,_801){var _802={lat:_800.lat,lng:_800.lng,formattedaddress:_800.address,status:_801};var _803=new Event("setCurrentSALocation",this.compId,_802,REQUESTTYPE_SYNC);queueManager.queueEvent(_803,"text/xml","xml",processXHR,function(err){});},showMessage:function(_804,_805,_806){var _807=new Event("showMaxMessage",this.compId,{msgKey:_805,msgGroup:_804,params:_806},REQUESTTYPE_SYNC);queueManager.queueEvent(_807,"text/xml","xml",processXHR,function(err){});},showMaximoDialog:function(_808,_809,_80a,_80b){addCommInput("dialogid",_808);if(_809&&_80a){addCommInput("objectname",_809);addCommInput("objectid",_80a);}if(_80b){addCommInput("relationship",_80b);}dojo.publish("onDialogRequested_"+this.compId,[]);sendEvent("showDialog",this.compId,"");},showQueryUnassignedWorkDialog:function(_80c){if(_80c){addCommInput("mapbounds_sw_latitudey",_80c.sw.lat);addCommInput("mapbounds_sw_longitudex",_80c.sw.lon);addCommInput("mapbounds_ne_latitudey",_80c.ne.lat);addCommInput("mapbounds_ne_longitudex",_80c.ne.lon);}else{console.warn("No bounds specified for query unassigned work");}this.showMaximoDialog("map_wo_query_unassigned_work",null,null);},queryUnassignedWorkDispatcher:function(_80d,_80e,_80f){if(_80d){var _810=new Event("queryUnassignedWorkDispatcher",this.compId,_80d,REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_810,"application/json","json",_80e,_80f);}else{console.warn("No bounds specified for query unassigned work");}},refreshQueryUnassignedWork:function(_811,_812,_813,_814){if(_811){var _815={"bounds":_811,"queryData":_812};var _816=new Event("queryUnassignedWorkDispatcher",this.compId,_815,REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_816,"application/json","json",_813,_814);}else{console.warn("No bounds specified for query unassigned work");}},getCrewLaborByCoords:function(_817,_818,_819){var _81a=new Event("getCrewLaborByCoords",this.compId,_819,REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_81a,"application/json","json",_817,_818);},_refreshDSRunning:false,refreshDatasource:function(_81b,_81c){if(this._refreshDSRunning==true){return;}var _81d=function(_81e){_81b(_81e);if(_81e.action.data.error){this.showMessage(_81e.action.data.error.group,_81e.action.data.error.key,[_81e.action.data.error.params]);}this._refreshDSRunning=false;};var _81f=function(){console.error("Failed to refresh marker position");_81c();this._refreshDSRunning=false;};var _820=new Event("refreshMarkersPositions",this.compId,{},REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_820,"application/json","json",dojo.hitch(this,_81d),dojo.hitch(this,_81f));},loadSymbologyConfigFile:function(_821,_822){var _823=new Event("loadSymbologyConfig",this.compId,"",REQUESTTYPE_HIGHASYNC);queueManager.queueEvent(_823,"application/json","json",_821,_822);}});});},"dojox/timing/_base":function(){define("dojox/timing/_base",["dojo/_base/kernel","dojo/_base/lang"],function(dojo){dojo.experimental("dojox.timing");dojo.getObject("timing",true,dojox);dojox.timing.Timer=function(_824){this.timer=null;this.isRunning=false;this.interval=_824;this.onStart=null;this.onStop=null;};dojo.extend(dojox.timing.Timer,{onTick:function(){},setInterval:function(_825){if(this.isRunning){window.clearInterval(this.timer);}this.interval=_825;if(this.isRunning){this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);}},start:function(){if(typeof this.onStart=="function"){this.onStart();}this.isRunning=true;this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);},stop:function(){if(typeof this.onStop=="function"){this.onStop();}this.isRunning=false;window.clearInterval(this.timer);}});return dojox.timing;});},"ibm/tivoli/fwm/mxmap/actions/Actions":function(){define(["dijit","dojo","dojox","dojo/require!dijit/Menu"],function(_826,dojo,_827){dojo.provide("ibm.tivoli.fwm.mxmap.actions.Actions");dojo.require("dijit.Menu");dojo.declare("ibm.tivoli.fwm.mxmap.actions.Actions",null,{divId:null,map:null,label:null,constructor:function(_828){dojo.mixin(this,_828);},execute:function(args){}});});},"url:dijit/templates/Dialog.html":"<div class=\"dijitDialog\" role=\"dialog\" aria-labelledby=\"${id}_title\">\n\t<div data-dojo-attach-point=\"titleBar\" class=\"dijitDialogTitleBar\">\n\t<span data-dojo-attach-point=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\"></span>\n\t<span data-dojo-attach-point=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" data-dojo-attach-event=\"ondijitclick: onCancel\" title=\"${buttonCancel}\" role=\"button\" tabIndex=\"-1\">\n\t\t<span data-dojo-attach-point=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\n\t</span>\n\t</div>\n\t\t<div data-dojo-attach-point=\"containerNode\" class=\"dijitDialogPaneContent\"></div>\n</div>\n","dijit/form/CheckBox":function(){require({cache:{"url:dijit/form/templates/CheckBox.html":"<div class=\"dijit dijitReset dijitInline\" role=\"presentation\"\n\t><input\n\t \t${!nameAttrSetting} type=\"${type}\" ${checkedAttrSetting}\n\t\tclass=\"dijitReset dijitCheckBoxInput\"\n\t\tdata-dojo-attach-point=\"focusNode\"\n\t \tdata-dojo-attach-event=\"onclick:_onClick\"\n/></div>\n"}});define("dijit/form/CheckBox",["require","dojo/_base/declare","dojo/dom-attr","dojo/_base/kernel","dojo/query","dojo/ready","./ToggleButton","./_CheckBoxMixin","dojo/text!./templates/CheckBox.html","dojo/NodeList-dom"],function(_829,_82a,_82b,_82c,_82d,_82e,_82f,_830,_831){if(!_82c.isAsync){_82e(0,function(){var _832=["dijit/form/RadioButton"];_829(_832);});}return _82a("dijit.form.CheckBox",[_82f,_830],{templateString:_831,baseClass:"dijitCheckBox",_setValueAttr:function(_833,_834){if(typeof _833=="string"){this._set("value",_833);_82b.set(this.focusNode,"value",_833);_833=true;}if(this._created){this.set("checked",_833,_834);}},_getValueAttr:function(){return (this.checked?this.value:false);},_setIconClassAttr:null,postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=this.checked?"checked":"";},_fillContent:function(){},_onFocus:function(){if(this.id){_82d("label[for='"+this.id+"']").addClass("dijitFocusedLabel");}this.inherited(arguments);},_onBlur:function(){if(this.id){_82d("label[for='"+this.id+"']").removeClass("dijitFocusedLabel");}this.inherited(arguments);}});});},"dijit/_Container":function(){define("dijit/_Container",["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","./registry"],function(_835,_836,_837,_838){return _836("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}},addChild:function(_839,_83a){var _83b=this.containerNode;if(_83a&&typeof _83a=="number"){var _83c=this.getChildren();if(_83c&&_83c.length>=_83a){_83b=_83c[_83a-1].domNode;_83a="after";}}_837.place(_839.domNode,_83b,_83a);if(this._started&&!_839._started){_839.startup();}},removeChild:function(_83d){if(typeof _83d=="number"){_83d=this.getChildren()[_83d];}if(_83d){var node=_83d.domNode;if(node&&node.parentNode){node.parentNode.removeChild(node);}}},hasChildren:function(){return this.getChildren().length>0;},_getSiblingOfChild:function(_83e,dir){var node=_83e.domNode,_83f=(dir>0?"nextSibling":"previousSibling");do{node=node[_83f];}while(node&&(node.nodeType!=1||!_838.byNode(node)));return node&&_838.byNode(node);},getIndexOfChild:function(_840){return _835.indexOf(this.getChildren(),_840);}});});},"dojo/html":function(){define("dojo/html",["./_base/kernel","./_base/lang","./_base/array","./_base/declare","./dom","./dom-construct","./parser"],function(dojo,lang,_841,_842,dom,_843,_844){lang.getObject("html",true,dojo);var _845=0;dojo.html._secureForInnerHtml=function(cont){return cont.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"");};dojo.html._emptyNode=_843.empty;dojo.html._setNodeContent=function(node,cont){_843.empty(node);if(cont){if(typeof cont=="string"){cont=_843.toDom(cont,node.ownerDocument);}if(!cont.nodeType&&lang.isArrayLike(cont)){for(var _846=cont.length,i=0;i<cont.length;i=_846==cont.length?i+1:0){_843.place(cont[i],node,"last");}}else{_843.place(cont,node,"last");}}return node;};_842("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:false,extractContent:false,parseContent:false,parserScope:dojo._scopeName,startup:true,constructor:function(_847,node){lang.mixin(this,_847||{});node=this.node=dom.byId(this.node||node);if(!this.id){this.id=["Setter",(node)?node.id||node.tagName:"",_845++].join("_");}},set:function(cont,_848){if(undefined!==cont){this.content=cont;}if(_848){this._mixin(_848);}this.onBegin();this.setContent();this.onEnd();return this.node;},setContent:function(){var node=this.node;if(!node){throw new Error(this.declaredClass+": setContent given no node");}try{node=dojo.html._setNodeContent(node,this.content);}catch(e){var _849=this.onContentError(e);try{node.innerHTML=_849;}catch(e){console.error("Fatal "+this.declaredClass+".setContent could not change content due to "+e.message,e);}}this.node=node;},empty:function(){if(this.parseResults&&this.parseResults.length){_841.forEach(this.parseResults,function(w){if(w.destroy){w.destroy();}});delete this.parseResults;}dojo.html._emptyNode(this.node);},onBegin:function(){var cont=this.content;if(lang.isString(cont)){if(this.cleanContent){cont=dojo.html._secureForInnerHtml(cont);}if(this.extractContent){var _84a=cont.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);if(_84a){cont=_84a[1];}}}this.empty();this.content=cont;return this.node;},onEnd:function(){if(this.parseContent){this._parse();}return this.node;},tearDown:function(){delete this.parseResults;delete this.node;delete this.content;},onContentError:function(err){return "Error occured setting content: "+err;},_mixin:function(_84b){var _84c={},key;for(key in _84b){if(key in _84c){continue;}this[key]=_84b[key];}},_parse:function(){var _84d=this.node;try{var _84e={};_841.forEach(["dir","lang","textDir"],function(name){if(this[name]){_84e[name]=this[name];}},this);this.parseResults=_844.parse({rootNode:_84d,noStart:!this.startup,inherited:_84e,scope:this.parserScope});}catch(e){this._onError("Content",e,"Error parsing in _ContentSetter#"+this.id);}},_onError:function(type,err,_84f){var _850=this["on"+type+"Error"].call(this,err);if(_84f){console.error(_84f,err);}else{if(_850){dojo.html._setNodeContent(this.node,_850,true);}}}});dojo.html.set=function(node,cont,_851){if(undefined==cont){console.warn("dojo.html.set: no cont argument provided, using empty string");cont="";}if(!_851){return dojo.html._setNodeContent(node,cont,true);}else{var op=new dojo.html._ContentSetter(lang.mixin(_851,{content:cont,node:node}));return op.set();}};return dojo.html;});},"ibm/tivoli/fwm/mxmap/Map":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/ContextMenu,ibm/tivoli/fwm/mxmap/CurrentMXRecordSet,ibm/tivoli/fwm/mxmap/MaximoIntegration,ibm/tivoli/fwm/mxmap/Geocoder,ibm/tivoli/fwm/mxmap/UserSessionManager,ibm/tivoli/fwm/mxmap/MapTipsManager,ibm/tivoli/fwm/mxmap/helpers/MapMarkersRefresher,ibm/tivoli/fwm/mxmap/toolbar/ToolbarManager,ibm/tivoli/fwm/mxmap/CurrentMXRecManager,ibm/tivoli/fwm/mxmap/helpers/MapFullScreenHelper,ibm/tivoli/fwm/mxmap/layers/LayersManager,ibm/tivoli/fwm/mxmap/symbology/SymbologyManager,dijit/dijit,dijit/Tooltip,ibm/tivoli/fwm/mxmap/routing/MultipleRoutesManager,ibm/tivoli/fwm/mxmap/actions/SetRecordLocation"],function(_852,dojo,_853){dojo.provide("ibm.tivoli.fwm.mxmap.Map");dojo.require("ibm.tivoli.fwm.mxmap.ContextMenu");dojo.require("ibm.tivoli.fwm.mxmap.CurrentMXRecordSet");dojo.require("ibm.tivoli.fwm.mxmap.MaximoIntegration");dojo.require("ibm.tivoli.fwm.mxmap.Geocoder");dojo.require("ibm.tivoli.fwm.mxmap.UserSessionManager");dojo.require("ibm.tivoli.fwm.mxmap.MapTipsManager");dojo.require("ibm.tivoli.fwm.mxmap.helpers.MapMarkersRefresher");dojo.require("ibm.tivoli.fwm.mxmap.toolbar.ToolbarManager");dojo.require("ibm.tivoli.fwm.mxmap.CurrentMXRecManager");dojo.require("ibm.tivoli.fwm.mxmap.helpers.MapFullScreenHelper");dojo.require("ibm.tivoli.fwm.mxmap.layers.LayersManager");dojo.require("ibm.tivoli.fwm.mxmap.symbology.SymbologyManager");dojo.require("dijit.dijit");dojo.require("dijit.Tooltip");dojo.require("ibm.tivoli.fwm.mxmap.routing.MultipleRoutesManager");dojo.declare("ibm.tivoli.fwm.mxmap.Map",ibm.tivoli.fwm.mxmap._Base,{events:{mapLoaded:"mxmap.mapLoaded"},map:null,_actionsAreEnabled:true,routeManager:null,divId:null,height:null,width:null,heightPx:null,widthPx:null,compId:null,mapConf:null,routeConf:null,providerName:null,isMobile:false,router:null,isFullScreen:false,customInitialMapOptions:{},fullScreenHelper:null,geocoder:null,maximo:null,currentRecordSetControl:null,userSessionManager:null,initialized:false,markerRefresher:null,toolbar:null,currentRecordMgr:null,maptips:null,contextMenu:null,layersManager:null,symbologyManager:null,mapOffsetTop:null,getId:function(){return this.compId;},constructor:function(_854){this._datasources=[];},getMaximo:function(){return this.maximo;},getSessionData:function(){if(this.mapConf){return this.mapConf.sessionData;}return {};},_getDefaultInitialLocation:function(){return {lat:0,lng:0,level:3};},_getInitialLocation:function(_855){var loc=this._getDefaultInitialLocation();if(this.userSessionManager!=null&&this.userSessionManager.hasLastUserLocation()){_855=this.userSessionManager.getLastUserLocation();}if(_855&&_855.lat&&_855.lng){loc.lat=_855.lat;loc.lng=_855.lng;}if(_855&&_855.level){loc.level=_855.level;}return loc;},getMapTipsManager:function(){return this.maptips;},createMap:function(_856){this.refreshListener=[];this.compId=_856.compId;this._sectionExpaded=false;try{if(this.initialized===true){console.warn("already created!");return;}if(_856.isInExpanded==false){this.disableActions();}dojo.mixin(this,_856);if(dojo.isIE>0){this._dueDistances=84;}var _857=dojo.byId(this.divId);this.mapOffsetTop=_857.offsetTop;this._resize();this.userSessionManager=new ibm.tivoli.fwm.mxmap.UserSessionManager({map:this,persistence:this.mapConf.inputConfs.contextpersistent});this.map=new mxn.Mapstraction(this.divId,this.providerName,false,this.mapConf.key,this.getInitOptions(),this.getId());if(this.isMobile==true){this.map.addControls({pan:true,zoom:"small",scale:true,enableScrollWheelZoom:true,map_type:true});}else{this.map.addControls({pan:true,zoom:"large",scale:true,enableScrollWheelZoom:true,map_type:true});}this.map.applyOptions();if(_856.isTesting==true){this.maximo=_856.maximoImpl;}else{this.maximo=new ibm.tivoli.fwm.mxmap.MaximoIntegration(_856);}this.maptips=new ibm.tivoli.fwm.mxmap.MapTipsManager({maximo:this.maximo});this.mapConf.inputConfs.defaultsymbology=dojo.fromJson(this.mapConf.inputConfs.defaultsymbology);this.symbologyManager=new ibm.tivoli.fwm.mxmap.symbology.SymbologyManager({map:this,defaultSymbologyConfig:this.mapConf.inputConfs.defaultsymbology});this.layersManager=new ibm.tivoli.fwm.mxmap.layers.LayersManager({symbManager:this.symbologyManager,layerType:ibm.tivoli.fwm.mxmap.layers.LayerType.LAYER,map:this});if(this.allowsTrafficLayer()==true){var _858={layerName:ibm.tivoli.fwm.i18n.getMaxMsg("map","traffic"),layerId:"traffic",map:this};var _859=new ibm.tivoli.fwm.mxmap.layers.TrafficLayer(_858);this.layersManager.addLayer(_859,false);}var _85a={layerName:ibm.tivoli.fwm.i18n.getMaxMsg("map","routelayer"),layerId:"route",map:this};var _85b=new ibm.tivoli.fwm.mxmap.layers.RouteLayer(_85a);this.layersManager.addLayer(_85b,false);var _85c=this.mapConf.inputConfs.refreshmapinterval;if(_85c!=null&&_85c>0){this.markerRefresher=new ibm.tivoli.fwm.mxmap.helpers.MapMarkersRefresher({map:this,maximo:this.maximo,interval:_85c});}var me=this;this.currentRecordSetControl=new ibm.tivoli.fwm.mxmap.CurrentMXRecordSet({records:me.mapConf.records,markerImgUrl:me.mapConf.inputConfs.markerimgurl,map:me});if(me.mapConf.error){this.maximo.showMessage(me.mapConf.error.group,me.mapConf.error.key,[me.mapConf.error.params]);}this.currentRecordMgr=new ibm.tivoli.fwm.mxmap.CurrentMXRecManager({mbo:me.mapConf.currentMbo,map:me,draggable:(me.isMapViewOnly()==false),markerImgUrl:me.mapConf.inputConfs.markerimgurl});this.geocoder=new ibm.tivoli.fwm.mxmap.Geocoder({map:me,key:this.mapConf.key});this.map.setMapType(mxn.Mapstraction.ROAD);if(this.mapConf.inputConfs.toolbarenabled==1||this.mapConf.inputConfs.toolbarenabled==true||this.mapConf.inputConfs.toolbarenabled=="true"){if(dojo.config.fwm.debug==true){}var _85d=[];if(this.mapConf.inputConfs.toolitems){_85d=dojo.fromJson(this.mapConf.inputConfs.toolitems);}this.toolbar=new ibm.tivoli.fwm.mxmap.toolbar.ToolbarManager({gisdata:this.mapConf.gisdata,mxdata:this.mapConf.mxdata,items:_85d,map:me});this.toolbar.startup();this.mapOffsetTop=_857.offsetTop;}this.isFullScreen=(this.mapConf.inputConfs.fullscreenmode=="true");this.fullScreenHelper=new ibm.tivoli.fwm.mxmap.helpers.MapFullScreenHelper({map:me,mapToolbar:me.toolbar,mapDivElement:dojo.byId(me.divId),mapDivWidth:me.widthPx,mapDivHeight:me.heightPx});if(!this.map.isLoaded()){this.map.addOnload(dojo.hitch(this,this._completeInitAfterMapLoads));this.map.addOnload(dojo.hitch(this,this._resize));}else{this._completeInitAfterMapLoads();}if(this.mapConf.isInMapManager){var _85e=dojo.hitch(this,function(_85f,args){var _860={lat:this.map.getCenter().lat,lng:this.map.getCenter().lng,level:this.map.getZoom()};this.getMaximo().storeUserLocation(_860);});this.map.changeZoom.addHandler(_85e,"");this.map.endPan.addHandler(_85e,"");}this.map.endPan.addHandler(function(){this.resetMaximoTimeout(false);},this.maximo);}catch(e){console.error("Error in map creation",e,dojo.toJson(e));sendEvent("showErrors",_856.compId,"unknown");}},centerAndZoomMap:function(){if(this.routerManager!=null&&this.routeConf.hasRoute==true){return;}var _861=this._getInitialLocation(this.mapConf.initialLocation);if(this.mapConf.zoomToDataInput==true){if(this.currentRecordSetControl.isEmpty()==true&&this.currentRecordMgr.hasAnyGISCoordinates()!=true){this._setDefaultLocation(_861);}else{if(this.currentRecordMgr.hasAnyGISCoordinates()==true){this._zoomToCurrentMboRec(_861);}else{this.zoomToMbos(this.currentRecordSetControl.mboInfoArray);}}}else{this._setDefaultLocation(_861);}},_zoomToCurrentMboRec:function(_862){this.currentRecordMgr.centerAndZoom(_862.level);},_completeInitAfterMapLoads:function(){this._checkMapLoadedCorrectly();if(dojo.config.fwm.debug==true){}if(this.mapConf.action){switch(this.mapConf.action){case "showMBOLocation":if(dojo.config.fwm.debug==true){}this.currentRecordSetControl.showMXRecordsOnMap();if(this.currentRecordMgr.hasAnyGISCoordinates()){this.currentRecordMgr.showCurrentRecord(true);}this.centerAndZoomMap();break;case "noAction":var _863=this._getInitialLocation(this.mapConf.initialLocation);this._setDefaultLocation(_863);break;default:console.error("[Map] Unknown initial action",this.mapConf.action);break;}}dojo.connect(window,"onresize",this,this._resize);if(this.isMobile==true){var res=function(){var rr=function(){this._resize();};setTimeout(dojo.hitch(this,rr),200);};dojo.connect(window,"onorientationchange",this,res);}this.addSubscription(dojo.subscribe("mxmap_section_expanded_"+this.getId(),dojo.hitch(this,this._mapSectionExpanded)));if(this.isMapViewOnly()==false){this.contextMenu=new ibm.tivoli.fwm.mxmap.ContextMenu({divId:this.divId,compId:this.getId(),map:this.map});dojo.require("ibm.tivoli.fwm.mxmap.actions.SetRecordLocation");var _864={map:this,compId:this.getId(),label:"Set record location"};this.contextMenu.addChild(new ibm.tivoli.fwm.mxmap.actions.SetRecordLocation(_864));this.contextMenu.serverUpdated(this.currentRecordMgr.mboInfo);}if(this.markerRefresher){this.markerRefresher.start();}if(this.routeConf){var _865={routeUrl:this.mapConf.route,map:this,provider:this.mapConf.provider,routeConf:this.routeConf};this.routeManager=new ibm.tivoli.fwm.mxmap.routing.MultipleRoutesManager(_865);if(this.routeConf.error){this.maximo.showMessage(this.routeConf.error.group,this.routeConf.error.key,[this.routeConf.error.params]);}else{if(this.routeConf.hasRoute==true){var _866=this.routeConf.showdirectionsonload;this.refreshRoute(true,_866);}}var fctR=function(){this.refreshRoute(true,false,true);};this.addSubscription(dojo.subscribe("refreshroute_"+this.getId(),dojo.hitch(this,fctR)));}if(this.isFullScreen==true){this.fullScreenOn();}this.initialized=true;dojo.publish(this.events.mapLoaded,[this.map,this.getId(),this]);if(this.isMobile==true){var _867=function(){if(this.fullScreenHelper._fullScreenOn==true){this.fullScreenOff();this._mustResetFullScreen=true;}else{this._mustResetFullScreen=false;}};var _868=function(){if(this._mustResetFullScreen==true){this.fullScreenOn();this._mustResetFullScreen=false;}};this.addSubscription(dojo.subscribe("onDialogRequested_"+this.getId(),dojo.hitch(this,_867)));this.addSubscription(dojo.subscribe("onDialogClosed_"+this.getId(),dojo.hitch(this,_868)));}},getMapConfiguration:function(){return this.mapConf;},getMapstraction:function(){return this.map;},getSymbologyManager:function(){return this.symbologyManager;},_routeRefreshRunning:false,refreshRoute:function(_869,_86a,_86b,_86c,_86d,_86e){if(this._actionsAreEnabled==false){return;}if(this.routeManager){if(this._routeRefreshRunning==true){console.warn("Route is already being refreshed");return;}this._routeRefreshRunning=true;var fct=function(data){this.routeManager.clearAll();if(data.hasRoute==true){var _86f=dojo.hitch(this,function(){this._routeRefreshRunning=false;if(_86d){_86d(this.routeManager);}});if(_86a=="true"){_86f=dojo.hitch(this,function(){dojo.publish("showItinerary_"+this.getId());this._routeRefreshRunning=false;});}var _870=dojo.hitch(this,function(_871,_872){this._routeRefreshRunning=false;if(_86e){_86e(_871,_872);}else{this.routeManager.routingError(_871,_872);}});this.routeManager.createRoute(data.stops,this.routeConf,_86f,_870,_86c);}else{if(_86d){_86d();}this._routeRefreshRunning=false;}};var _873=function(data){console.warn("[Map] Error refreshing route",data);this._routeRefreshRunning=false;if(_86e){_86e(data);}else{if(data.error){this.maximo.showMessage(data.error.group,data.error.key,[data.error.params]);}else{this.maximo.showMessage("mapserver","route_unknown_failure",[data]);}}};this.maximo.getRouteStops(dojo.hitch(this,fct),dojo.hitch(this,_873),_869,_86b);}else{console.warn("[Map] No route manager on map - could not refresh route.",this.compId);}},refreshDatasource:function(_874,_875){if(this._actionsAreEnabled==false){return;}var _876=dojo.hitch(this,function(_877){var _878=true;var _879=null;if(_877.action.data.currentMbo){this.currentRecordMgr.serverUpdated(_877.action.data.currentMbo,_878);_879=this.currentRecordMgr;}else{this.currentRecordSetControl.updateRecordSetAndRefresh(_877.action.data.records,_878);_879=this.currentRecordSetControl;}if(_874){_874(_879);}});var _87a=dojo.hitch(this,function(){if(_875){_875(response);}});this.maximo.refreshDatasource(_876,_87a);},_datasources:[],registerDatasourceRefresh:function(_87b){this._datasources.push(_87b);},_refreshEntireMapRunning:null,refreshMap:function(_87c){if(this._actionsAreEnabled==false){return;}if(this._refreshEntireMapRunning==true){console.warn("[Map] refresh going on, ignoring second request");return;}this._refreshEntireMapRunning=true;var _87d=null;var _87e=dojo.hitch(this,function(_87f){var i=-1;var _880=true;if(_87c&&_87c.zoom==false){_880=false;}var fct=dojo.hitch(this,function(_881){i++;if(_881){_87d=_881;}if(i<this._datasources.length){this._datasources[i](fct,null,!_880);}else{if(_87d!=null&&_880){_87d.centerAndZoom();}this._refreshEntireMapRunning=false;dojo.publish("onMapRefresh_"+this.getId(),[_87c]);}});fct(_87f);});if(this._datasources.length>0&&(this.mapConf.inputConfs.datasrc=="MAINRECORD"&&this.currentRecordMgr.hasAnyGISCoordinates()==false)||this.mapConf.inputConfs.datasrc==null||this.mapConf.inputConfs.datasrc.length==0){_87e();}else{var _882=dojo.hitch(this,function(_883){_87d=_883;var _884=dojo.hitch(this,function(_885,_886){if(_87c.automatic==false){this.routeManager.routingError(_885,_886);}_87e();});this.refreshRoute(true,false,false,true,_87e,_884);});this.refreshDatasource(_882);}},setRecordLocation:function(){_852.popup.close(this.contextMenu);},clearMarkers:function(){this.map.removeAllMarkers();},getMultipleRoutesManager:function(){return this.routeManager;},getInitOptions:function(){var _887=this._getInitOptions();var _888=this._getCustomInitOptions(this.mapConf.mapoptions);for(var _889 in _888){if(_888.hasOwnProperty(_889)){var _88a=_888[_889];_887[_889]=_88a;}}return _887;},_getCustomInitOptions:function(){throw "Cannot find custom init options";},_getInitOptions:function(){console.warn("No implementation found");return {};},getGeoCoderConf:function(){return {};},_setLocation:function(lat,lng,_88b){var _88c=new mxn.LatLonPoint(lat,lng);this.map.setCenterAndZoom(_88c,_88b);},_setDefaultLocation:function(_88d){if(_88d&&_88d.lat&&_88d.lng){var _88e=new mxn.LatLonPoint(_88d.lat,_88d.lng);this.map.setCenterAndZoom(_88e,_88d.level);}else{this.map.setCenterAndZoom(new mxn.LatLonPoint(0,0),3);}},_resize:function(){var _88f=dojo.byId(this.divId);var h=this.height;var w=this.width;if(!this.height){h="100%";}if(!this.width){w="100%";}if(h.substr(h.length-1,1)=="%"){h=this._getHeightInPixels(h,_88f);if(h<=0){h=200;}}dojo.style(_88f,{"width":w,"height":h});if(this.toolbar){this.toolbar.updateToolbarWidth(w);}this.heightPx=parseInt((""+h).match(/\d+/)||0);this.widthPx=this._getWidthInPixels(w);if(this.map){this.map.resizeTo(w,h,this.widthPx,this.heightPx);if(this.fullScreenHelper){this.fullScreenHelper.updateMapDimensions(w,h);}}},_dueToolbarHeight:35,_dueDistances:15,_getHeightInPixels:function(_890,_891){var h=_890.substr(0,_890.length-1);var _892=parseInt(_852.getViewport().h-this.mapOffsetTop);var pct=parseInt(h);h=(_892*(pct/100));h-=(this._dueDistances+this._dueToolbarHeight);this._dueToolbarHeight=0;return h;},_getWidthInPixels:function(w){if(w.substr(w.length-1,1)=="%"){var _893=dojo.byId(this.divId);var _894=w.substr(0,w.length-1);var _895=parseInt(_852.getViewport().w-this._getMapOffsetLeft());var _896=parseInt(_894);var _897=(_895*(_896/100));_897-=15;return parseInt((""+_897).match(/\d+/)||0);}else{return parseInt((""+w).match(/\d+/)||0);}},getCurrentRecordSetControl:function(){return this.currentRecordSetControl;},destroyRecursive:function(){this.userSessionManager.onMapExit();this.map.endPan.removeHandler(this.maximo.resetMaximoTimeout,this.maximo);if(this.markerRefresher){this.markerRefresher.destroyRecursive();this.markerRefresher=null;}if(this.routeManager){this.routeManager.destroyRecursive();}if(this.getMapstraction()!=null){this.destroyMap();}if(this.maximo){this.maximo.destroyRecursive();}if(this.geocoder){this.geocoder.destroyRecursive();}if(this.currentRecordSetControl){this.currentRecordSetControl.destroyRecursive();}if(this.currentRecordMgr){this.currentRecordMgr.destroyRecursive();}if(this.contextMenu){this.contextMenu.destroyRecursive();}if(this.maptips){this.maptips.destroyRecursive();}if(this.toolbar){this.toolbar.destroyRecursive();}if(this.fullScreenHelper){this.fullScreenHelper.destroyRecursive();}if(this.layersManager){this.layersManager.destroyRecursive();}this.inherited(arguments);},destroyMap:function(){throw "To be implemented by provider";},fullScreenOn:function(){this.fullScreenHelper.fullScreenModeOn();},fullScreenOff:function(){this.fullScreenHelper.fullScreenModeOff();},getWidthInPixels:function(){var w=this.width;if(!this.width){w="100%";}this.widthPx=this._getWidthInPixels(w);return this.widthPx;},getHeightInPixels:function(){return this.heightPx;},failedToGetLocation:function(){var _898=this.getMaximo();var _899=ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation.getMyCurrentLocationInstance();switch(_899.getStatus()){case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.PERMISSION_DENIED:_898.showMessage("map","curr_loc_perm_denied");break;case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.TIMEOUT:_898.showMessage("map","curr_loc_timeout");break;case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.POSITION_UNAVAILABLE:_898.showMessage("map","curr_loc_position_unavailable");break;case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.GEOLOCATION_NOT_SUPPORTED:_898.showMessage("map","curr_loc_not_supported");break;default:_898.showMessage("mapserver","current_loc_failure",[error.code]);}},failedToGetLocationStatusMessages:function(){var _89a=this.getMaximo();var _89b=ibm.tivoli.fwm.mxmap.geolocation.MyCurrentLocation.getMyCurrentLocationInstance();switch(_89b.getStatus()){case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.PERMISSION_DENIED:_89a.showMessage("map","curr_loc_perm_denied_statusmsg");break;case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.TIMEOUT:_89a.showMessage("map","curr_loc_timeout_statusmsg");break;case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.POSITION_UNAVAILABLE:_89a.showMessage("map","curr_loc_position_unavailable_statusmsg");break;case ibm.tivoli.fwm.mxmap.geolocation.GeoLocationStatus.GEOLOCATION_NOT_SUPPORTED:_89a.showMessage("map","curr_loc_not_supported_statusmsg");break;default:_89a.showMessage("mapserver","current_loc_failure",[error.code]);}},getLayersManager:function(){return this.layersManager;},_checkMapLoadedCorrectly:function(){},handlerMapping:{"onMoveEnd":"dragend"},centerOnMbo:function(_89c,_89d){var _89e=_89c.gisdata;if(_89c.autolocate!=null){_89e=_89c.autolocate.gisdata;}if(dojo.config.fwm.debug==true){}var _89f=new mxn.LatLonPoint(_89e.lat,_89e.lng);if(_89c.gisdata.islbs==true){_89f.sr=mxn.util.getWGS84WKID();var _8a0=function(_8a1){this._centerOnPoint(_8a1[0],_89d);};this.getMapstraction().getAllPointsFromWGS84([_89f],dojo.hitch(this,_8a0));}else{this._centerOnPoint(_89f,_89d);}},_centerOnPoint:function(cp,_8a2){if(_8a2){this.getMapstraction().setCenterAndZoom(cp,_8a2);}else{this.getMapstraction().setCenter(cp);}},removeMboMarker:function(_8a3,_8a4){var info=this._getMboMarkerInfo(_8a3,_8a4);if(info!=null){if(!_8a4){_8a4=this.layersManager.getLayerIdForMbo(_8a3);this.layersManager.removeRecord(_8a3);}else{this.removeMboMarkerFromMap(_8a3,_8a4);}}else{console.warn("There was no marker for ",_8a3);}},removeMboMarkerFromMap:function(_8a5,_8a6){var info=this._getMboMarkerInfo(_8a5,_8a6);if(info!=null){info.isOnMap=false;this.getMapstraction().removeMarker(info.marker);if(info.lbsCircle||info.lbsMarker){this.getMapstraction().removePolyline(info.lbsCircle);this.getMapstraction().removeMarker(info.lbsMarker);}info={};}else{console.warn("no marker for ",_8a5);}},showMboMarker:function(_8a7,_8a8){var info=this._getMboMarkerInfo(_8a7,_8a8);if(info!=null){info.isOnMap=true;this.addMboMarker(_8a7,info.markerOptions,_8a8);}},addMboToLayerManager:function(_8a9,_8aa){this.layersManager.addRecord(_8a9,_8aa);},removeMboFromLayerManager:function(_8ab){this.layersManager.removeRecord(_8ab);},addMboMarker:function(_8ac,_8ad,_8ae){var _8af=_8ac.gisdata;if(_8ac.autolocate!=null){_8af=_8ac.autolocate.gisdata;}var _8b0=new mxn.LatLonPoint(_8af.lat,_8af.lng);if(_8af.islbs==true){_8b0.sr=mxn.util.getWGS84WKID();var _8b1=function(_8b2){this._createMarker(_8ac,_8ad,_8b2[0],_8ae);};var _8b3=function(err){console.error("Error converting point to current SR",err);};this.getMapstraction().getAllPointsFromWGS84([_8b0],dojo.hitch(this,_8b1),dojo.hitch(this,_8b3));}else{this._createMarker(_8ac,_8ad,_8b0,_8ae);}},_createMarker:function(_8b4,_8b5,_8b6,_8b7){if(dojo.config.fwm.debug==true){}var _8b8=new mxn.Marker(_8b6);if(_8b5&&_8b5.events){for(var _8b9 in _8b5.events){var _8ba=_8b5.events[_8b9];var _8bb=this.handlerMapping[_8b9];_8b8[_8bb].addHandler(_8ba);}}var _8bc=true;if(_8b4.gisdata.flags.readonly==true){_8bc=false;}else{if(this.isMapViewOnly()==true){_8bc=false;}else{if(_8b5&&_8b5.draggable){_8bc=_8b5.draggable;}}}if(_8b4.gisdata.islbs==true&&_8b4.lbsdata&&_8b4.gisdata.lat!=null){var _8bd=this._addLBSAccuracyMarker(_8b4.lbsdata,_8b6);var _8be=this._addLBSAccuracyCircle(_8b4.lbsdata,_8b6);this._updateMboMarkerHash(_8b4,{lbsMarker:_8bd,lbsCircle:_8be},_8b7);}var _8bf=_8b5?_8b5.color:"#ffffff";var _8c0=this.getSymbologyManager().getLegendForObject(_8b4,_8bf);var icon=_8c0.url;var _8c1="";if(_8b5&&_8b5.tooltip){_8c1=_8b5.tooltip;}var _8c2={infoBubble:"FWMMAPTIPS",label:null,tooltip:_8c1,marker:4,icon:icon,iconSize:[_8c0.width,_8c0.height],iconAnchor:[_8c0.offsetx,_8c0.offsety],draggable:_8bc,hover:false};if(_8b5!=null){_8c2.label=_8b5.label;_8c2.hover=_8b5.hover;}this.getMapstraction().addMarkerWithData(_8b8,_8c2);this.getMapTipsManager().enableMarker(_8b8,_8b4.mxdata);this._updateMboMarkerHash(_8b4,{isOnMap:true,marker:_8b8,markerOptions:_8b5},_8b7);if(_8b5&&_8b5.markerReferenceCallback){try{_8b5.markerReferenceCallback(_8b8);}catch(e){console.error("cannot call reference ftc",e);}}},_updateMboMarkerHash:function(_8c3,opt,_8c4){return this.layersManager.setMboMarkerInfo(_8c3,opt,_8c4);},_getMboMarkerInfo:function(_8c5,_8c6){return this.layersManager.getMboMarkerInfo(_8c5,_8c6);},showAllMboRecords:function(_8c7,_8c8,zoom){if(!_8c7||_8c7.length==0){return;}for(var _8c9 in _8c7){this.addMboToLayerManager(_8c7[_8c9]);}if(zoom==true){this.zoomToMbos(_8c7);}},zoomToMbos:function(_8ca){if(!_8ca||_8ca.length==0){return;}if(_8ca&&_8ca.length==1){this.centerOnMbo(_8ca[0]);}else{this.map.autoCenterAndZoom();}},_addLBSAccuracyCircle:function(_8cb,_8cc){if("EXCEEDED_TOLERANCE"!==_8cb.max_accuracy_state){var _8cd=new mxn.Radius(_8cc,10);var _8ce=(_8cb.location_accuracy/1000);var _8cf=_8cd.getPolyline(_8ce,"#C6DBEB");this.getMapstraction().addPolylineWithData(_8cf,{centerPoint:_8cc,width:3,opacity:0.5,fillColor:"#D0E0EC",closed:true,radiusInKMs:_8ce});}else{}return _8cf;},_addLBSAccuracyMarker:function(_8d0,_8d1){var _8d2=new mxn.Marker(_8d1);var _8d3=ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager().getLBSMarkerImageInfo(_8d0);var _8d4={infoBubble:"",label:null,marker:4,icon:_8d3.getImageURL(),iconSize:_8d3.getImageSize(),iconAnchor:_8d3.getImageAnchor(),draggable:false,hover:false};this.getMapstraction().addMarkerWithData(_8d2,_8d4);return _8d2;},enableTraffic:function(){this.getMapstraction().toggleTraffic(true);},disableTraffic:function(){this.getMapstraction().toggleTraffic(false);},enableRoutes:function(){if(this.getMultipleRoutesManager()){this.getMultipleRoutesManager().showRoutesAndCalculatedMarkers();}},disableRoutes:function(){this.getMultipleRoutesManager().hideRoutesAndCalculatedMarkers();},disableActions:function(){this._actionsAreEnabled=false;},enableActions:function(){this._actionsAreEnabled=true;},isMapViewOnly:function(){var _8d5=this.mapConf.inputConfs;if(_8d5!=null&&_8d5.mapviewonly!=null){return _8d5.mapviewonly=="1"||_8d5.mapviewonly=="true";}return true;},allowsTrafficLayer:function(){return true;},getDefaultLengthUnit:function(){return this.mapConf.lengthunit;},_mapSectionExpanded:function(){this.enableActions();var _8d6=false;if(this.routeConf&&this.routeConf.showdirectionsonload==true){_8d6=true;}this._resize();var _8d7={zoom:true,disableMsgs:false,automatic:false};this.refreshMap(_8d7);if(this._sectionExpaded==false){this.centerAndZoomMap();this._sectionExpaded=true;}},getInitialLocationCustomInfo:function(){return {};},autoRefreshMap:function(){var _8d8={zoom:false,disableMsgs:true,automatic:true};this.refreshMap(_8d8);},_getMapOffsetLeft:function(){var _8d9=dojo.byId(this.divId);return _8d9.offsetLeft;}});});},"dijit/_base":function(){define("dijit/_base",[".","./a11y","./WidgetSet","./_base/focus","./_base/manager","./_base/place","./_base/popup","./_base/scroll","./_base/sniff","./_base/typematic","./_base/wai","./_base/window"],function(_8da){return _8da._base;});},"dijit/_base/typematic":function(){define("dijit/_base/typematic",["../typematic"],function(){});},"dojo/window":function(){define("dojo/window",["./_base/lang","./_base/sniff","./_base/window","./dom","./dom-geometry","./dom-style"],function(lang,has,_8db,dom,geom,_8dc){var _8dd=lang.getObject("dojo.window",true);_8dd.getBox=function(){var _8de=(_8db.doc.compatMode=="BackCompat")?_8db.body():_8db.doc.documentElement,_8df=geom.docScroll(),w,h;if(has("touch")){var _8e0=_8db.doc.parentWindow||_8db.doc.defaultView;w=_8e0.innerWidth||_8de.clientWidth;h=_8e0.innerHeight||_8de.clientHeight;}else{w=_8de.clientWidth;h=_8de.clientHeight;}return {l:_8df.x,t:_8df.y,w:w,h:h};};_8dd.get=function(doc){if(has("ie")&&_8dd!==document.parentWindow){doc.parentWindow.execScript("document._parentWindow = window;","Javascript");var win=doc._parentWindow;doc._parentWindow=null;return win;}return doc.parentWindow||doc.defaultView;};_8dd.scrollIntoView=function(node,pos){try{node=dom.byId(node);var doc=node.ownerDocument||_8db.doc,body=doc.body||_8db.body(),html=doc.documentElement||body.parentNode,isIE=has("ie"),isWK=has("webkit");if((!(has("mozilla")||isIE||isWK||has("opera"))||node==body||node==html)&&(typeof node.scrollIntoView!="undefined")){node.scrollIntoView(false);return;}var _8e1=doc.compatMode=="BackCompat",_8e2=(isIE>=9&&node.ownerDocument.parentWindow.frameElement)?((html.clientHeight>0&&html.clientWidth>0&&(body.clientHeight==0||body.clientWidth==0||body.clientHeight>html.clientHeight||body.clientWidth>html.clientWidth))?html:body):(_8e1?body:html),_8e3=isWK?body:_8e2,_8e4=_8e2.clientWidth,_8e5=_8e2.clientHeight,rtl=!geom.isBodyLtr(),_8e6=pos||geom.position(node),el=node.parentNode,_8e7=function(el){return ((isIE<=6||(isIE&&_8e1))?false:(_8dc.get(el,"position").toLowerCase()=="fixed"));};if(_8e7(node)){return;}while(el){if(el==body){el=_8e3;}var _8e8=geom.position(el),_8e9=_8e7(el);if(el==_8e3){_8e8.w=_8e4;_8e8.h=_8e5;if(_8e3==html&&isIE&&rtl){_8e8.x+=_8e3.offsetWidth-_8e8.w;}if(_8e8.x<0||!isIE){_8e8.x=0;}if(_8e8.y<0||!isIE){_8e8.y=0;}}else{var pb=geom.getPadBorderExtents(el);_8e8.w-=pb.w;_8e8.h-=pb.h;_8e8.x+=pb.l;_8e8.y+=pb.t;var _8ea=el.clientWidth,_8eb=_8e8.w-_8ea;if(_8ea>0&&_8eb>0){_8e8.w=_8ea;_8e8.x+=(rtl&&(isIE||el.clientLeft>pb.l))?_8eb:0;}_8ea=el.clientHeight;_8eb=_8e8.h-_8ea;if(_8ea>0&&_8eb>0){_8e8.h=_8ea;}}if(_8e9){if(_8e8.y<0){_8e8.h+=_8e8.y;_8e8.y=0;}if(_8e8.x<0){_8e8.w+=_8e8.x;_8e8.x=0;}if(_8e8.y+_8e8.h>_8e5){_8e8.h=_8e5-_8e8.y;}if(_8e8.x+_8e8.w>_8e4){_8e8.w=_8e4-_8e8.x;}}var l=_8e6.x-_8e8.x,t=_8e6.y-Math.max(_8e8.y,0),r=l+_8e6.w-_8e8.w,bot=t+_8e6.h-_8e8.h;if(r*l>0){var s=Math[l<0?"max":"min"](l,r);if(rtl&&((isIE==8&&!_8e1)||isIE>=9)){s=-s;}_8e6.x+=el.scrollLeft;el.scrollLeft+=s;_8e6.x-=el.scrollLeft;}if(bot*t>0){_8e6.y+=el.scrollTop;el.scrollTop+=Math[t<0?"max":"min"](t,bot);_8e6.y-=el.scrollTop;}el=(el!=_8e3)&&!_8e9&&el.parentNode;}}catch(error){console.error("scrollIntoView: "+error);node.scrollIntoView(false);}};return _8dd;});},"dijit/_FocusMixin":function(){define("dijit/_FocusMixin",["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(_8ec,_8ed,_8ee,lang){lang.extend(_8ed,{focused:false,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus();},_onBlur:function(){this.onBlur();}});return _8ee("dijit._FocusMixin",null,{_focusManager:_8ec});});},"dijit/_WidgetsInTemplateMixin":function(){define("dijit/_WidgetsInTemplateMixin",["dojo/_base/array","dojo/_base/declare","dojo/parser","dijit/registry"],function(_8ef,_8f0,_8f1,_8f2){return _8f0("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:false,widgetsInTemplate:true,_beforeFillContent:function(){if(this.widgetsInTemplate){var node=this.domNode;var cw=(this._startupWidgets=_8f1.parse(node,{noStart:!this._earlyTemplatedStartup,template:true,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,scope:"dojo"}));this._supportingWidgets=_8f2.findWidgets(node);this._attachTemplateNodes(cw,function(n,p){return n[p];});}},startup:function(){_8ef.forEach(this._startupWidgets,function(w){if(w&&!w._started&&w.startup){w.startup();}});this.inherited(arguments);}});});},"ibm/tivoli/fwm/mxmap/MarkerImageInfo":function(){define(["dijit","dojo","dojox"],function(_8f3,dojo,_8f4){dojo.provide("ibm.tivoli.fwm.mxmap.MarkerImageInfo");dojo.declare("ibm.tivoli.fwm.mxmap.MarkerImageInfo",null,{_imageSize:null,_imageAnchor:null,_imageURL:null,constructor:function(_8f5){dojo.mixin(this,_8f5);this._imageSize=_8f5.imageSize||[32,32];this._imageAnchor=_8f5.imageAnchor||[0,32];this._imageURL=_8f5.imageUrl||"";},getImageSize:function(){return this._imageSize;},getImageAnchor:function(){return this._imageAnchor;},getImageURL:function(){return this._imageURL;},getSymbolURL:function(){return this._imageURL;},setImageURL:function(_8f6){this._imageURL=_8f6;},generateMarkerData:function(_8f7,_8f8,_8f9){return {label:_8f7,draggable:true==_8f8,icon:this.getImageURL(),iconSize:this.getImageSize(),iconAnchor:this.getImageAnchor(),hover:true==_8f9};}});});},"ibm/tivoli/fwm/mxmap/toolbar/ToolbarManager":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/Toolbar,ibm/tivoli/fwm/mxmap/toolbar/ToolbarSeparator"],function(_8fa,dojo,_8fb){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ToolbarManager");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("dijit.Toolbar");dojo.require("ibm.tivoli.fwm.mxmap.toolbar.ToolbarSeparator");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ToolbarManager",[ibm.tivoli.fwm.mxmap._Base],{gisdata:null,mxdata:null,map:null,items:[],_defaultItems:[],toolbarItems:null,toolbarDivElement:null,_toolbarHeight:35,constructor:function(_8fc){dojo.mixin(this,_8fc);this.toolbarItems=[];this._defaultItems=["RefresherTool","FullScreen"];},postCreate:function(){this.addSubscription(dojo.subscribe("onCurrentRecordUpdate_"+this.map.getId(),dojo.hitch(this,this.serverUpdated)));},container:null,toolbar:null,startup:function(){var _8fd=dojo.isIE?"1px solid #AAA":"0px solid #AAA";this.container=dojo.create("div",{id:this.map.divId+"_toolbar",style:{width:this.map.getWidthInPixels(),whiteSpace:"normal","background-color":"#FFFFFF","border":"1px solid #AAA","border-bottom-color":"black","display":"block","borderBottom":_8fd}},dojo.byId(this.map.divId),"before");var div=dojo.create("div",{style:{width:this.map.getWidthInPixels()}},this.container);this.toolbar=new _8fa.Toolbar({style:{width:"100%","border":"0","background-position-y":"4%"},splitter:"true"},div);var me=this;var _8fe=this.map.getId();var _8ff=function(item){if(item=="sep"){var d=new ibm.tivoli.fwm.mxmap.toolbar.ToolbarSeparator();me.toolbar.addChild(d);}else{var _900="ibm.tivoli.fwm.mxmap.toolbar.ext."+item;var _901="dojo."+"require('"+_900+"')";try{eval(_901);}catch(e){console.error("cannot load tool",e);return;}this.map=me.map;var _902="this.itemDojo = new ibm.tivoli.fwm.mxmap.toolbar.ext."+item+"({map:this.map})";dojo.eval(_902);var _903=this.itemDojo;var _904=_903.createToolbarButton();var _905=function(){if(me.lastItemClicked){me.lastItemClicked.disable();}dojo.publish("mxnToolbarClicked_"+_8fe,[item]);me.lastItemClicked=_903;};me.addSubscription(dojo.connect(_904,"onClick",me,_905));me.toolbar.addChild(_904);me.toolbarItems.push(_903);}};if(this.items==null||this.items.length==0){dojo.forEach(this._defaultItems,_8ff);}else{dojo.forEach(this.items,_8ff);}this.toolbarDivElement=this.container;},lastItemClicked:null,serverUpdated:function(){this.mxdata=data.mxdata;this.gisdata=data.gisdata;},destroyRecursive:function(){this.inherited(arguments);dojo.forEach(this.toolbarItems,function(item){item.destroy();});this.toolbar.destroy();dojo.empty(this.container);},getToolbarDivElement:function(){return this.toolbarDivElement;},updateToolbarWidth:function(_906){dojo.style(this.toolbarDivElement,{width:_906});},getToolbarHeight:function(){return this._toolbarHeight;}});});},"dojo/data/util/sorter":function(){define("dojo/data/util/sorter",["dojo/_base/lang"],function(lang){var _907=lang.getObject("dojo.data.util.sorter",true);_907.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_907.createSortFunction=function(_908,_909){var _90a=[];function _90b(attr,dir,comp,s){return function(_90c,_90d){var a=s.getValue(_90c,attr);var b=s.getValue(_90d,attr);return dir*comp(a,b);};};var _90e;var map=_909.comparatorMap;var bc=_907.basicComparator;for(var i=0;i<_908.length;i++){_90e=_908[i];var attr=_90e.attribute;if(attr){var dir=(_90e.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_90a.push(_90b(attr,dir,comp,_909));}}return function(rowA,rowB){var i=0;while(i<_90a.length){var ret=_90a[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _907;});},"dijit/form/_ButtonMixin":function(){define("dijit/form/_ButtonMixin",["dojo/_base/declare","dojo/dom","dojo/_base/event","../registry"],function(_90f,dom,_910,_911){return _90f("dijit.form._ButtonMixin",null,{label:"",type:"button",_onClick:function(e){if(this.disabled){_910.stop(e);return false;}var _912=this.onClick(e)===false;if(!_912&&this.type=="submit"&&!(this.valueNode||this.focusNode).form){for(var node=this.domNode;node.parentNode;node=node.parentNode){var _913=_911.byNode(node);if(_913&&typeof _913._onSubmit=="function"){_913._onSubmit(e);_912=true;break;}}}if(_912){e.preventDefault();}return !_912;},postCreate:function(){this.inherited(arguments);dom.setSelectable(this.focusNode,false);},onClick:function(){return true;},_setLabelAttr:function(_914){this._set("label",_914);(this.containerNode||this.focusNode).innerHTML=_914;}});});},"ibm/tivoli/fwm/i18n":function(){define(["dijit","dojo","dojox"],function(_915,dojo,_916){dojo.provide("ibm.tivoli.fwm.i18n");ibm.tivoli.fwm.i18n.msgs={};ibm.tivoli.fwm.i18n.preLoadMsgGroup=function(_917){if(ibm.tivoli.fwm.i18n.msgs[_917]==null){var txt=dojohelper.getText(dojo.config.fwm.ctxRoot+"/rest/mbo/maxmessages?msggroup="+_917+"&_includecols=msgkey,value&_format=json&");var _918=dojo.fromJson(txt);if(_918.MAXMESSAGESMboSet.MAXMESSAGES.length>0){ibm.tivoli.fwm.i18n.msgs[_917]={};for(var i=0;i<_918.MAXMESSAGESMboSet.MAXMESSAGES.length;i++){var msg=_918.MAXMESSAGESMboSet.MAXMESSAGES[i];ibm.tivoli.fwm.i18n.msgs[_917][msg.Attributes.MSGKEY.content]=msg.Attributes.VALUE.content;}}}};ibm.tivoli.fwm.i18n.getMaxMsg=function(_919,_91a){if(ibm.tivoli.fwm.i18n.msgs[_919]==null){ibm.tivoli.fwm.i18n.msgs[_919]={};}if(ibm.tivoli.fwm.i18n.msgs[_919][_91a]==null){ibm.tivoli.fwm.i18n.msgs[_919][_91a]=ibm.tivoli.fwm.i18n._loadMsgThruRest(_919,_91a);}if(ibm.tivoli.fwm.i18n.msgs[_919][_91a]==null){return (_919+"#"+_91a);}return ibm.tivoli.fwm.i18n.msgs[_919][_91a];};ibm.tivoli.fwm.i18n._loadMsgThruRest=function(_91b,_91c){var txt=dojohelper.getText(dojo.config.fwm.ctxRoot+"/rest/mbo/maxmessages?msgkey="+_91c+"&msggroup="+_91b+"&_includecols=msgkey,value&_format=json&_maxItems=1");var _91d=dojo.fromJson(txt);if(_91d.MAXMESSAGESMboSet.MAXMESSAGES.length>0){return _91d.MAXMESSAGESMboSet.MAXMESSAGES[0].Attributes.VALUE.content;}return null;};});},"ibm/tivoli/fwm/mxmap/_Base":function(){define(["dijit","dojo","dojox"],function(_91e,dojo,_91f){dojo.provide("ibm.tivoli.fwm.mxmap._Base");dojo.declare("ibm.tivoli.fwm.mxmap._Base",null,{_handlers:null,constructor:function(_920){this._handlers=[];},addSubscription:function(_921){this._handlers.push(_921);},destroyRecursive:function(){var h;while((h=this._handlers.pop())){dojo.unsubscribe(h);}}});});},"dijit/registry":function(){define("dijit/registry",["dojo/_base/array","dojo/_base/sniff","dojo/_base/unload","dojo/_base/window","."],function(_922,has,_923,win,_924){var _925={},hash={};var _926={length:0,add:function(_927){if(hash[_927.id]){throw new Error("Tried to register widget with id=="+_927.id+" but that id is already registered");}hash[_927.id]=_927;this.length++;},remove:function(id){if(hash[id]){delete hash[id];this.length--;}},byId:function(id){return typeof id=="string"?hash[id]:id;},byNode:function(node){return hash[node.getAttribute("widgetId")];},toArray:function(){var ar=[];for(var id in hash){ar.push(hash[id]);}return ar;},getUniqueId:function(_928){var id;do{id=_928+"_"+(_928 in _925?++_925[_928]:_925[_928]=0);}while(hash[id]);return _924._scopeName=="dijit"?id:_924._scopeName+"_"+id;},findWidgets:function(root){var _929=[];function _92a(root){for(var node=root.firstChild;node;node=node.nextSibling){if(node.nodeType==1){var _92b=node.getAttribute("widgetId");if(_92b){var _92c=hash[_92b];if(_92c){_929.push(_92c);}}else{_92a(node);}}}};_92a(root);return _929;},_destroyAll:function(){_924._curFocus=null;_924._prevFocus=null;_924._activeStack=[];_922.forEach(_926.findWidgets(win.body()),function(_92d){if(!_92d._destroyed){if(_92d.destroyRecursive){_92d.destroyRecursive();}else{if(_92d.destroy){_92d.destroy();}}}});},getEnclosingWidget:function(node){while(node){var id=node.getAttribute&&node.getAttribute("widgetId");if(id){return hash[id];}node=node.parentNode;}return null;},_hash:hash};if(has("ie")){_923.addOnWindowUnload(function(){_926._destroyAll();});}_924.registry=_926;return _926;});},"dojo/io/script":function(){define("dojo/io/script",["../main"],function(dojo){dojo.getObject("io",true,dojo);var _92e=dojo.isIE?"onreadystatechange":"load",_92f=/complete|loaded/;dojo.io.script={get:function(args){var dfd=this._makeScriptDeferred(args);var _930=dfd.ioArgs;dojo._ioAddQueryToUrl(_930);dojo._ioNotifyStart(dfd);if(this._canAttach(_930)){var node=this.attach(_930.id,_930.url,args.frameDoc);if(!_930.jsonp&&!_930.args.checkString){var _931=dojo.connect(node,_92e,function(evt){if(evt.type=="load"||_92f.test(node.readyState)){dojo.disconnect(_931);_930.scriptLoaded=evt;}});}}dojo._ioWatch(dfd,this._validCheck,this._ioCheck,this._resHandle);return dfd;},attach:function(id,url,_932){var doc=(_932||dojo.doc);var _933=doc.createElement("script");_933.type="text/javascript";_933.src=url;_933.id=id;_933.async=true;_933.charset="utf-8";return doc.getElementsByTagName("head")[0].appendChild(_933);},remove:function(id,_934){dojo.destroy(dojo.byId(id,_934));if(this["jsonp_"+id]){delete this["jsonp_"+id];}},_makeScriptDeferred:function(args){var dfd=dojo._ioSetArgs(args,this._deferredCancel,this._deferredOk,this._deferredError);var _935=dfd.ioArgs;_935.id=dojo._scopeName+"IoScript"+(this._counter++);_935.canDelete=false;_935.jsonp=args.callbackParamName||args.jsonp;if(_935.jsonp){_935.query=_935.query||"";if(_935.query.length>0){_935.query+="&";}_935.query+=_935.jsonp+"="+(args.frameDoc?"parent.":"")+dojo._scopeName+".io.script.jsonp_"+_935.id+"._jsonpCallback";_935.frameDoc=args.frameDoc;_935.canDelete=true;dfd._jsonpCallback=this._jsonpCallback;this["jsonp_"+_935.id]=dfd;}return dfd;},_deferredCancel:function(dfd){dfd.canceled=true;if(dfd.ioArgs.canDelete){dojo.io.script._addDeadScript(dfd.ioArgs);}},_deferredOk:function(dfd){var _936=dfd.ioArgs;if(_936.canDelete){dojo.io.script._addDeadScript(_936);}return _936.json||_936.scriptLoaded||_936;},_deferredError:function(_937,dfd){if(dfd.ioArgs.canDelete){if(_937.dojoType=="timeout"){dojo.io.script.remove(dfd.ioArgs.id,dfd.ioArgs.frameDoc);}else{dojo.io.script._addDeadScript(dfd.ioArgs);}}return _937;},_deadScripts:[],_counter:1,_addDeadScript:function(_938){dojo.io.script._deadScripts.push({id:_938.id,frameDoc:_938.frameDoc});_938.frameDoc=null;},_validCheck:function(dfd){var _939=dojo.io.script;var _93a=_939._deadScripts;if(_93a&&_93a.length>0){for(var i=0;i<_93a.length;i++){_939.remove(_93a[i].id,_93a[i].frameDoc);_93a[i].frameDoc=null;}dojo.io.script._deadScripts=[];}return true;},_ioCheck:function(dfd){var _93b=dfd.ioArgs;if(_93b.json||(_93b.scriptLoaded&&!_93b.args.checkString)){return true;}var _93c=_93b.args.checkString;return _93c&&eval("typeof("+_93c+") != 'undefined'");},_resHandle:function(dfd){if(dojo.io.script._ioCheck(dfd)){dfd.callback(dfd);}else{dfd.errback(new Error("inconceivable dojo.io.script._resHandle error"));}},_canAttach:function(_93d){return true;},_jsonpCallback:function(json){this.ioArgs.json=json;}};return dojo.io.script;});},"ibm/tivoli/fwm/mxmap/ContextMenu":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,dijit/Menu"],function(_93e,dojo,_93f){dojo.provide("ibm.tivoli.fwm.mxmap.ContextMenu");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("dijit.Menu");dojo.declare("ibm.tivoli.fwm.mxmap.ContextMenu",ibm.tivoli.fwm.mxmap._Base,{divId:null,map:null,compId:null,_contextMenu:null,_emptyContextMenu:null,_currentCtxMenu:null,constructor:function(_940){dojo.mixin(this,_940);this.map.click.addHandler(this._onClick,this);this.map.rightclick.addHandler(this._onRightClick,this);dojo.create("div",{id:"popUpCtx"},dojo.byId(this.divId));dojo.create("div",{id:"popUpEmptyCtx"},dojo.byId(this.divId));this._contextMenu=new _93e.Menu({targetNodeIds:["popUpCtx"]});this._currentCtxMenu=this._contextMenu;this._emptyContextMenu=new _93e.Menu({targetNodeIds:["popUpEmptyCtx"]});var _941=new _93e.MenuItem({label:ibm.tivoli.fwm.i18n.getMaxMsg("map","no_actions_available_label"),onClick:dojo.hitch(this,function(){})});this._emptyContextMenu.addChild(_941);this.addSubscription(dojo.subscribe("onCurrentRecordUpdate_"+this.compId,dojo.hitch(this,this.serverUpdated)));},serverUpdated:function(data){if(data&&data.gisdata&&data.gisdata.flags&&data.gisdata.flags.readonly==true){this._currentCtxMenu=this._emptyContextMenu;}else{this._currentCtxMenu=this._contextMenu;}},_onClick:function(_942,evt,_943){_93e.popup.close(this._currentCtxMenu);},_contextArgs:{mapLocation:{}},_onRightClick:function(_944,evt,_945){_93e.popup.close(this._currentCtxMenu);var _946=_945.location;var _947=dojo.position(dojo.byId(this.divId),true);var x=_945.pixel.x+_947.x;var y=_945.pixel.y+_947.y;this._contextArgs={mapLocation:_946};_93e.popup.open({popup:this._currentCtxMenu,x:x,y:y,onExecute:dojo.hitch(this,function(ag){_93e.popup.close(this._currentCtxMenu);}),onCancel:function(ag){if(dojo.config.fwm.debug==true){}},orient:"L"});},_executeAction:function(_948){_948.execute(this._contextArgs);},addChild:function(_949){var _94a=new _93e.MenuItem({label:_949.label,onClick:dojo.hitch(this,function(){this._executeAction(_949);})});this._contextMenu.addChild(_94a);},destroyRecursive:function(){_93e.popup.close(this._contextMenu);_93e.popup.close(this._emptyContextMenu);this.map.click.removeHandler(this.onClick,this);this.map.rightclick.removeHandler(this.onRightClick,this);}});});},"ibm/tivoli/fwm/mxmap/toolbar/ext/LayersTool":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/layers/LayerPanelWidget,ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/toolbar/ext/_ToolTemplate,dijit/form/Button"],function(_94b,dojo,_94c){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ext.LayersTool");dojo.require("ibm.tivoli.fwm.mxmap.layers.LayerPanelWidget");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.toolbar.ext._ToolTemplate");dojo.require("dijit.form.Button");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ext.LayersTool",ibm.tivoli.fwm.mxmap.toolbar.ext._ToolTemplate,{label:"Layers",iconClass:"basicMapToolbarBtn layersMapToolbarBtn",map:null,constructor:function(_94d){dojo.mixin(this,_94d);var _94e=ibm.tivoli.fwm.i18n.getMaxMsg("map","layers");this.label=_94e||this.label;},execute:function(){var _94f=new ibm.tivoli.fwm.mxmap.layers.LayerPanelWidget({map:this.map});_94f.updateLayers(this.map.getLayersManager().getLayers());},disable:function(){},destroy:function(){this.destroyRecursive();}});});},"dijit/_base/wai":function(){define("dijit/_base/wai",["dojo/dom-attr","dojo/_base/lang","..","../hccss"],function(_950,lang,_951){lang.mixin(_951,{hasWaiRole:function(elem,role){var _952=this.getWaiRole(elem);return role?(_952.indexOf(role)>-1):(_952.length>0);},getWaiRole:function(elem){return lang.trim((_950.get(elem,"role")||"").replace("wairole:",""));},setWaiRole:function(elem,role){_950.set(elem,"role",role);},removeWaiRole:function(elem,role){var _953=_950.get(elem,"role");if(!_953){return;}if(role){var t=lang.trim((" "+_953+" ").replace(" "+role+" "," "));_950.set(elem,"role",t);}else{elem.removeAttribute("role");}},hasWaiState:function(elem,_954){return elem.hasAttribute?elem.hasAttribute("aria-"+_954):!!elem.getAttribute("aria-"+_954);},getWaiState:function(elem,_955){return elem.getAttribute("aria-"+_955)||"";},setWaiState:function(elem,_956,_957){elem.setAttribute("aria-"+_956,_957);},removeWaiState:function(elem,_958){elem.removeAttribute("aria-"+_958);}});return _951;});},"dijit/form/_FormSelectWidget":function(){define("dijit/form/_FormSelectWidget",["dojo/_base/array","dojo/aspect","dojo/data/util/sorter","dojo/_base/declare","dojo/dom","dojo/dom-class","dojo/_base/kernel","dojo/_base/lang","dojo/query","./_FormValueWidget"],function(_959,_95a,_95b,_95c,dom,_95d,_95e,lang,_95f,_960){return _95c("dijit.form._FormSelectWidget",_960,{multiple:false,options:null,store:null,query:null,queryOptions:null,onFetch:null,sortByLabel:true,loadChildrenOnOpen:false,getOptions:function(_961){var _962=_961,opts=this.options||[],l=opts.length;if(_962===undefined){return opts;}if(lang.isArray(_962)){return _959.map(_962,"return this.getOptions(item);",this);}if(lang.isObject(_961)){if(!_959.some(this.options,function(o,idx){if(o===_962||(o.value&&o.value===_962.value)){_962=idx;return true;}return false;})){_962=-1;}}if(typeof _962=="string"){for(var i=0;i<l;i++){if(opts[i].value===_962){_962=i;break;}}}if(typeof _962=="number"&&_962>=0&&_962<l){return this.options[_962];}return null;},addOption:function(_963){if(!lang.isArray(_963)){_963=[_963];}_959.forEach(_963,function(i){if(i&&lang.isObject(i)){this.options.push(i);}},this);this._loadChildren();},removeOption:function(_964){if(!lang.isArray(_964)){_964=[_964];}var _965=this.getOptions(_964);_959.forEach(_965,function(i){if(i){this.options=_959.filter(this.options,function(node){return (node.value!==i.value||node.label!==i.label);});this._removeOptionItem(i);}},this);this._loadChildren();},updateOption:function(_966){if(!lang.isArray(_966)){_966=[_966];}_959.forEach(_966,function(i){var _967=this.getOptions(i),k;if(_967){for(k in i){_967[k]=i[k];}}},this);this._loadChildren();},setStore:function(_968,_969,_96a){var _96b=this.store;_96a=_96a||{};if(_96b!==_968){var h;while(h=this._notifyConnections.pop()){h.remove();}if(_968&&_968.getFeatures()["dojo.data.api.Notification"]){this._notifyConnections=[_95a.after(_968,"onNew",lang.hitch(this,"_onNewItem"),true),_95a.after(_968,"onDelete",lang.hitch(this,"_onDeleteItem"),true),_95a.after(_968,"onSet",lang.hitch(this,"_onSetItem"),true)];}this._set("store",_968);}this._onChangeActive=false;if(this.options&&this.options.length){this.removeOption(this.options);}if(_968){this._loadingStore=true;_968.fetch(lang.delegate(_96a,{onComplete:function(_96c,opts){if(this.sortByLabel&&!_96a.sort&&_96c.length){_96c.sort(_95b.createSortFunction([{attribute:_968.getLabelAttributes(_96c[0])[0]}],_968));}if(_96a.onFetch){_96c=_96a.onFetch.call(this,_96c,opts);}_959.forEach(_96c,function(i){this._addOptionForItem(i);},this);this._loadingStore=false;this.set("value","_pendingValue" in this?this._pendingValue:_969);delete this._pendingValue;if(!this.loadChildrenOnOpen){this._loadChildren();}else{this._pseudoLoadChildren(_96c);}this._fetchedWith=opts;this._lastValueReported=this.multiple?[]:null;this._onChangeActive=true;this.onSetStore();this._handleOnChange(this.value);},scope:this}));}else{delete this._fetchedWith;}return _96b;},_setValueAttr:function(_96d,_96e){if(this._loadingStore){this._pendingValue=_96d;return;}var opts=this.getOptions()||[];if(!lang.isArray(_96d)){_96d=[_96d];}_959.forEach(_96d,function(i,idx){if(!lang.isObject(i)){i=i+"";}if(typeof i==="string"){_96d[idx]=_959.filter(opts,function(node){return node.value===i;})[0]||{value:"",label:""};}},this);_96d=_959.filter(_96d,function(i){return i&&i.value;});if(!this.multiple&&(!_96d[0]||!_96d[0].value)&&opts.length){_96d[0]=opts[0];}_959.forEach(opts,function(i){i.selected=_959.some(_96d,function(v){return v.value===i.value;});});var val=_959.map(_96d,function(i){return i.value;}),disp=_959.map(_96d,function(i){return i.label;});this._set("value",this.multiple?val:val[0]);this._setDisplay(this.multiple?disp:disp[0]);this._updateSelection();this._handleOnChange(this.value,_96e);},_getDisplayedValueAttr:function(){var val=this.get("value");if(!lang.isArray(val)){val=[val];}var ret=_959.map(this.getOptions(val),function(v){if(v&&"label" in v){return v.label;}else{if(v){return v.value;}}return null;},this);return this.multiple?ret:ret[0];},_loadChildren:function(){if(this._loadingStore){return;}_959.forEach(this._getChildren(),function(_96f){_96f.destroyRecursive();});_959.forEach(this.options,this._addOptionItem,this);this._updateSelection();},_updateSelection:function(){this._set("value",this._getValueFromOpts());var val=this.value;if(!lang.isArray(val)){val=[val];}if(val&&val[0]){_959.forEach(this._getChildren(),function(_970){var _971=_959.some(val,function(v){return _970.option&&(v===_970.option.value);});_95d.toggle(_970.domNode,this.baseClass+"SelectedOption",_971);_970.domNode.setAttribute("aria-selected",_971);},this);}},_getValueFromOpts:function(){var opts=this.getOptions()||[];if(!this.multiple&&opts.length){var opt=_959.filter(opts,function(i){return i.selected;})[0];if(opt&&opt.value){return opt.value;}else{opts[0].selected=true;return opts[0].value;}}else{if(this.multiple){return _959.map(_959.filter(opts,function(i){return i.selected;}),function(i){return i.value;})||[];}}return "";},_onNewItem:function(item,_972){if(!_972||!_972.parent){this._addOptionForItem(item);}},_onDeleteItem:function(item){var _973=this.store;this.removeOption(_973.getIdentity(item));},_onSetItem:function(item){this.updateOption(this._getOptionObjForItem(item));},_getOptionObjForItem:function(item){var _974=this.store,_975=_974.getLabel(item),_976=(_975?_974.getIdentity(item):null);return {value:_976,label:_975,item:item};},_addOptionForItem:function(item){var _977=this.store;if(!_977.isItemLoaded(item)){_977.loadItem({item:item,onItem:function(i){this._addOptionForItem(i);},scope:this});return;}var _978=this._getOptionObjForItem(item);this.addOption(_978);},constructor:function(_979){this._oValue=(_979||{}).value||null;this._notifyConnections=[];},buildRendering:function(){this.inherited(arguments);dom.setSelectable(this.focusNode,false);},_fillContent:function(){var opts=this.options;if(!opts){opts=this.options=this.srcNodeRef?_95f("> *",this.srcNodeRef).map(function(node){if(node.getAttribute("type")==="separator"){return {value:"",label:"",selected:false,disabled:false};}return {value:(node.getAttribute("data-"+_95e._scopeName+"-value")||node.getAttribute("value")),label:String(node.innerHTML),selected:node.getAttribute("selected")||false,disabled:node.getAttribute("disabled")||false};},this):[];}if(!this.value){this._set("value",this._getValueFromOpts());}else{if(this.multiple&&typeof this.value=="string"){this._set("value",this.value.split(","));}}},postCreate:function(){this.inherited(arguments);this.connect(this,"onChange","_updateSelection");this.connect(this,"startup","_loadChildren");this._setValueAttr(this.value,null);},startup:function(){this.inherited(arguments);var _97a=this.store,_97b={};_959.forEach(["query","queryOptions","onFetch"],function(i){if(this[i]){_97b[i]=this[i];}delete this[i];},this);if(_97a&&_97a.getFeatures()["dojo.data.api.Identity"]){this.store=null;this.setStore(_97a,this._oValue,_97b);}},destroy:function(){var h;while(h=this._notifyConnections.pop()){h.remove();}this.inherited(arguments);},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return [];},_getSelectedOptionsAttr:function(){return this.getOptions(this.get("value"));},_pseudoLoadChildren:function(){},onSetStore:function(){}});});},"dijit/form/Select":function(){require({cache:{"url:dijit/form/templates/Select.html":"<table class=\"dijit dijitReset dijitInline dijitLeft\"\n\tdata-dojo-attach-point=\"_buttonNode,tableNode,focusNode\" cellspacing='0' cellpadding='0'\n\trole=\"combobox\" aria-haspopup=\"true\"\n\t><tbody role=\"presentation\"><tr role=\"presentation\"\n\t\t><td class=\"dijitReset dijitStretch dijitButtonContents dijitButtonNode\" role=\"presentation\"\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"  data-dojo-attach-point=\"containerNode,_popupStateNode\"></span\n\t\t\t><input type=\"hidden\" ${!nameAttrSetting} data-dojo-attach-point=\"valueNode\" value=\"${value}\" aria-hidden=\"true\"\n\t\t/></td><td class=\"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\t\tdata-dojo-attach-point=\"titleNode\" role=\"presentation\"\n\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" role=\"presentation\">&#9660;</div\n\t\t></td\n\t></tr></tbody\n></table>\n"}});define("dijit/form/Select",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/_base/event","dojo/i18n","dojo/_base/lang","./_FormSelectWidget","../_HasDropDown","../Menu","../MenuItem","../MenuSeparator","../Tooltip","dojo/text!./templates/Select.html","dojo/i18n!./nls/validate"],function(_97c,_97d,_97e,_97f,_980,_981,_982,i18n,lang,_983,_984,Menu,_985,_986,_987,_988){var _989=_97d("dijit.form._SelectMenu",Menu,{buildRendering:function(){this.inherited(arguments);var o=(this.menuTableNode=this.domNode);var n=(this.domNode=_980.create("div",{style:{overflowX:"hidden",overflowY:"scroll"}}));if(o.parentNode){o.parentNode.replaceChild(n,o);}_97f.remove(o,"dijitMenuTable");n.className=o.className+" dijitSelectMenu";o.className="dijitReset dijitMenuTable";o.setAttribute("role","listbox");n.setAttribute("role","presentation");n.appendChild(o);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onmousemove",_982.stop);},resize:function(mb){if(mb){_981.setMarginBox(this.domNode,mb);if("w" in mb){this.menuTableNode.style.width="100%";}}}});var _98a=_97d("dijit.form.Select",[_983,_984],{baseClass:"dijitSelect",templateString:_988,required:false,state:"",message:"",tooltipPosition:[],emptyLabel:"&#160;",_isLoaded:false,_childrenLoaded:false,_fillContent:function(){this.inherited(arguments);if(this.options.length&&!this.value&&this.srcNodeRef){var si=this.srcNodeRef.selectedIndex||0;this.value=this.options[si>=0?si:0].value;}this.dropDown=new _989({id:this.id+"_menu"});_97f.add(this.dropDown.domNode,this.baseClass+"Menu");},_getMenuItemForOption:function(_98b){if(!_98b.value&&!_98b.label){return new _986();}else{var _98c=lang.hitch(this,"_setValueAttr",_98b);var item=new _985({option:_98b,label:_98b.label||this.emptyLabel,onClick:_98c,disabled:_98b.disabled||false});item.focusNode.setAttribute("role","listitem");return item;}},_addOptionItem:function(_98d){if(this.dropDown){this.dropDown.addChild(this._getMenuItemForOption(_98d));}},_getChildren:function(){if(!this.dropDown){return [];}return this.dropDown.getChildren();},_loadChildren:function(_98e){if(_98e===true){if(this.dropDown){delete this.dropDown.focusedChild;}if(this.options.length){this.inherited(arguments);}else{_97c.forEach(this._getChildren(),function(_98f){_98f.destroyRecursive();});var item=new _985({label:"&#160;"});this.dropDown.addChild(item);}}else{this._updateSelection();}this._isLoaded=false;this._childrenLoaded=true;if(!this._loadingStore){this._setValueAttr(this.value);}},_setValueAttr:function(_990){this.inherited(arguments);_97e.set(this.valueNode,"value",this.get("value"));this.validate(this.focused);},_setDisabledAttr:function(_991){this.inherited(arguments);this.validate(this.focused);},_setRequiredAttr:function(_992){this._set("required",_992);this.focusNode.setAttribute("aria-required",_992);this.validate(this.focused);},_setDisplay:function(_993){var lbl=_993||this.emptyLabel;this.containerNode.innerHTML="<span class=\"dijitReset dijitInline "+this.baseClass+"Label\">"+lbl+"</span>";this.focusNode.setAttribute("aria-valuetext",lbl);},validate:function(_994){var _995=this.disabled||this.isValid(_994);this._set("state",_995?"":"Incomplete");this.focusNode.setAttribute("aria-invalid",_995?"false":"true");var _996=_995?"":this._missingMsg;if(_996&&this.focused&&this._hasBeenBlurred){_987.show(_996,this.domNode,this.tooltipPosition,!this.isLeftToRight());}else{_987.hide(this.domNode);}this._set("message",_996);return _995;},isValid:function(){return (!this.required||this.value===0||!(/^\s*$/.test(this.value||"")));},reset:function(){this.inherited(arguments);_987.hide(this.domNode);this.validate(this.focused);},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=i18n.getLocalization("dijit.form","validate",this.lang).missingMessage;},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onmousemove",_982.stop);},_setStyleAttr:function(_997){this.inherited(arguments);_97f.toggle(this.domNode,this.baseClass+"FixedWidth",!!this.domNode.style.width);},isLoaded:function(){return this._isLoaded;},loadDropDown:function(_998){this._loadChildren(true);this._isLoaded=true;_998();},closeDropDown:function(){this.inherited(arguments);if(this.dropDown&&this.dropDown.menuTableNode){this.dropDown.menuTableNode.style.width="";}},uninitialize:function(_999){if(this.dropDown&&!this.dropDown._destroyed){this.dropDown.destroyRecursive(_999);delete this.dropDown;}this.inherited(arguments);},_onFocus:function(){this.validate(true);this.inherited(arguments);},_onBlur:function(){_987.hide(this.domNode);this.inherited(arguments);}});_98a._Menu=_989;return _98a;});},"ibm/tivoli/fwm/mxmap/toolbar/ext/QueryNearResources":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/toolbar/ext/_ToggleTool,dijit/form/Button"],function(_99a,dojo,_99b){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ext.QueryNearResources");dojo.require("ibm.tivoli.fwm.mxmap.toolbar.ext._ToggleTool");dojo.require("dijit.form.Button");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ext.QueryNearResources",ibm.tivoli.fwm.mxmap.toolbar.ext._ToggleTool,{label:"Nearby resources",iconClass:"basicMapToolbarBtn nearbyResourcesMapToolbarBtn",map:null,nearbyCrewsLabel:"",nearbyLaborsLabel:"",constructor:function(_99c){dojo.mixin(this,_99c);var _99d=ibm.tivoli.fwm.i18n.getMaxMsg("map","nearresourcestool");this.label=_99d||this.label;this.nearbyCrewsLabel=ibm.tivoli.fwm.i18n.getMaxMsg("map","nearbycrews");this.nearbyLaborsLabel=ibm.tivoli.fwm.i18n.getMaxMsg("map","nearbylabors");this.addSubscription(dojo.subscribe("onMapRefresh_"+this.map.getId(),dojo.hitch(this,this._onMapRefresh)));},updateLayers:function(_99e,_99f,_9a0){var _9a1=_9a0&&_9a0.automatic;var _9a2=false;if(_9a0){_9a2=true;}if(_99e&&_99e.length>0){this._sendEventToLayer(this.nearbyCrewsLabel,_99e,_9a2);}else{this._sendEventToRemoveLayer(this.nearbyCrewsLabel);}if(_99f&&_99f.length>0){this._sendEventToLayer(this.nearbyLaborsLabel,_99f,_9a2);}else{this._sendEventToRemoveLayer(this.nearbyLaborsLabel);}if(_9a1!=true&&_99f.length==0&&_99e.length==0){this.setActive(false);this.map.getMaximo().showMessage("mapserver","noresourcesinarea");}},disable:function(){},destroy:function(){this.destroyRecursive();},_getGISData:function(_9a3){var _9a4=[];if(_9a3){for(var _9a5 in _9a3){if(_9a3[_9a5].gisdata){_9a4.push(_9a3[_9a5].gisdata);}else{console.warn("[QueryNearResouces] Records has a record without gisdata.",_9a3);return null;}}}else{console.warn("[QueryNearResouces] Records has a record without gisdata.",_9a3);return null;}return _9a4;},_sendEventToLayer:function(_9a6,_9a7,_9a8){dojo.publish("addRecordsToLayer_"+this.map.getId(),[_9a6,_9a7,true,null,null,_9a8]);},_sendEventToRemoveLayer:function(_9a9){dojo.publish("removeLayer_"+this.map.getId(),[_9a9]);},executeOn:function(_9aa){var fct=function(data){if(data.status=="TOOMANYRECORDS"){this.map.getMaximo().showMessage(data.error.group,data.error.key,[data.error.params]);return;}var _9ab=data.crews;var _9ac=data.labors;var _9ad=this._getGISData(_9ab);_9ad.join(this._getGISData(_9ac));if(_9ad.length>0){this.map.getMapstraction().getAllPointsFromWGS84(_9ad,dojo.hitch(this,function(){this.updateLayers(_9ab,_9ac,_9aa);}),dojo.hitch(this,function(_9ae){if(_9ae&&_9ae.msgkey){this.map.getMaximo().showMessage(_9ae.msggroup,_9ae.msgkey);}}));}else{this.updateLayers(_9ab,_9ac,_9aa);}};var _9af=function(data){console.warn("[QueryNearResources] Error querying nearby resources",data);};var _9b0=this.map.getMapstraction().getBounds();var _9b1=function(ps){var _9b2=new mxn.BoundingBox(ps[0].lat,ps[0].lon,ps[1].lat,ps[1].lon);this.map.getMaximo().getCrewLaborByCoords(dojo.hitch(this,fct),dojo.hitch(this,_9af),_9b2);};this.map.getMapstraction().getAllPointsInWGS84([_9b0.sw,_9b0.ne],dojo.hitch(this,_9b1));},executeOff:function(){this._sendEventToRemoveLayer(this.nearbyLaborsLabel);this._sendEventToRemoveLayer(this.nearbyCrewsLabel);},_onMapRefresh:function(_9b3){if(this.isActive()==true){this.executeOff();this.executeOn(_9b3);}}});});},"ibm/tivoli/fwm/mxmap/toolbar/ToolbarSeparator":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated"],function(_9b4,dojo,_9b5){dojo.provide("ibm.tivoli.fwm.mxmap.toolbar.ToolbarSeparator");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.declare("ibm.tivoli.fwm.mxmap.toolbar.ToolbarSeparator",[_9b4._Widget,_9b4._Templated],{templateString:"<div class=\"mapTbSep dijitInline\" waiRole=\"presentation\"></div>",postCreate:function(){dojo.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});});},"dijit/form/_FormWidget":function(){define("dijit/form/_FormWidget",["dojo/_base/declare","dojo/_base/kernel","dojo/ready","../_Widget","../_CssStateMixin","../_TemplatedMixin","./_FormWidgetMixin"],function(_9b6,_9b7,_9b8,_9b9,_9ba,_9bb,_9bc){if(!_9b7.isAsync){_9b8(0,function(){var _9bd=["dijit/form/_FormValueWidget"];require(_9bd);});}return _9b6("dijit.form._FormWidget",[_9b9,_9bb,_9ba,_9bc],{setDisabled:function(_9be){_9b7.deprecated("setDisabled("+_9be+") is deprecated. Use set('disabled',"+_9be+") instead.","","2.0");this.set("disabled",_9be);},setValue:function(_9bf){_9b7.deprecated("dijit.form._FormWidget:setValue("+_9bf+") is deprecated.  Use set('value',"+_9bf+") instead.","","2.0");this.set("value",_9bf);},getValue:function(){_9b7.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value");},postMixInProperties:function(){this.nameAttrSetting=this.name?("name=\""+this.name.replace(/'/g,"&quot;")+"\""):"";this.inherited(arguments);},_setTypeAttr:null});});},"ibm/tivoli/fwm/mxmap/layers/LayersManager":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/layers/Layer,ibm/tivoli/fwm/mxmap/layers/SymbologyLayer,ibm/tivoli/fwm/mxmap/layers/LegendLayer,ibm/tivoli/fwm/mxmap/layers/TrafficLayer,ibm/tivoli/fwm/mxmap/layers/RouteLayer,ibm/tivoli/fwm/mxmap/ImageLibraryManager,ibm/tivoli/fwm/mxmap/layers/VirtualLayer"],function(_9c0,dojo,_9c1){dojo.provide("ibm.tivoli.fwm.mxmap.layers.LayersManager");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.layers.Layer");dojo.require("ibm.tivoli.fwm.mxmap.layers.SymbologyLayer");dojo.require("ibm.tivoli.fwm.mxmap.layers.LegendLayer");dojo.require("ibm.tivoli.fwm.mxmap.layers.TrafficLayer");dojo.require("ibm.tivoli.fwm.mxmap.layers.RouteLayer");dojo.require("ibm.tivoli.fwm.mxmap.ImageLibraryManager");dojo.require("ibm.tivoli.fwm.mxmap.layers.VirtualLayer");dojo.declare("ibm.tivoli.fwm.mxmap.layers.LayersManager",[ibm.tivoli.fwm.mxmap._Base],{_layers:null,_layersById:null,symbManager:null,_map:null,constructor:function(_9c2){dojo.mixin(this,_9c2);this._layers=[];this._layersById=[];this._map=_9c2.map;this.addSubscription(dojo.subscribe("addRecordsToLayer_"+this._map.getId(),dojo.hitch(this,this.addRecordCustomLayer)));this.addSubscription(dojo.subscribe("removeRecordsFromLayer_"+this._map.getId(),dojo.hitch(this,this.removeRecordsFromLayer)));this.addSubscription(dojo.subscribe("removeLayer_"+this._map.getId(),dojo.hitch(this,this.removeLayerByName)));},addRecord:function(_9c3,_9c4){var _9c5=this._getLayerForMbo(_9c3);_9c5.addRecord(_9c3,_9c4);},removeRecord:function(_9c6){var _9c7=this._getLayerForMbo(_9c6);_9c7.removeRecord(_9c6);},_getLayerForMbo:function(_9c8){var _9c9=_9c8.mxdata.mboName;return this.getLayerForObjectName(_9c9);},getLayerForObjectName:function(_9ca){var _9cb=this.getLayerById(_9ca);if(_9cb==null){_9cb=new ibm.tivoli.fwm.mxmap.layers.Layer({layerId:_9ca.toLowerCase(),layerType:ibm.tivoli.fwm.mxmap.layers.LayerType.LAYER,symbManager:this.symbManager,map:this.map});this.addLayer(_9cb,false);_9cb.enable();}return _9cb;},getLayerIdForMbo:function(_9cc){var _9cd=_9cc.mxdata.mboName;return this.getLayerForObjectName(_9cd).getLayerId();},removeRecord:function(_9ce){var _9cf=_9ce.mxdata.mboName;var _9d0=this.getLayerById(_9cf);if(_9d0!=null){_9d0.removeRecord(_9ce);}},addRecordCustomLayer:function(_9d1,data,_9d2,_9d3,_9d4,_9d5){if(data.length>0){var _9d6=this.getLayerById(_9d1);if(_9d6==null){_9d6=new ibm.tivoli.fwm.mxmap.layers.VirtualLayer({layerId:_9d1,layerType:ibm.tivoli.fwm.mxmap.layers.LayerType.VIRTUAL_LAYER,symbManager:this.symbManager,map:this.map,objectType:data[0].mxdata.mboName});}this.resetLayer(_9d6,_9d5);for(var i in data){_9d6.addRecord(data[i]);}}},removeLayerByName:function(_9d7,_9d8,_9d9){var _9da=this.getLayer(_9d7);if(_9da){_9da.removeMXRecordSetData();if(_9d8!=true){this._layers[_9d7]=null;delete this._layers[_9d7];}}if(_9d9&&this._layersById[_9d9]){this._layersById[_9d9]=null;}},removeLayer:function(_9db){delete this._layersById[_9db.getLayerId()];delete this._layers[_9db.getLayerName()];},addLayer:function(_9dc,_9dd){var _9de=_9dc.getLayerName();var _9df=_9dc.getLayerId();if(dojo.config.fwm.debug==true){}var _9e0=this.getLayer(_9de);if(_9e0){if(_9dd){this.removeLayerByName(_9de,false,_9df);}_9e0.addMXRecordSet(_9dc.getMXRecordSet());}else{this._layers[_9de]=_9dc;if(_9df){this._layersById[_9df]=_9dc;}}},resetLayer:function(_9e1,_9e2){var _9e3=_9e1.getLayerName();var _9e4=_9e1.getLayerId();var _9e5=this.getLayer(_9e3);if(_9e5){this.removeLayerByName(_9e3,false,_9e4);}if(_9e3){this._layers[_9e3]=_9e1;}if(_9e4){this._layersById[_9e4]=_9e1;}if(_9e1.isDisabled()&&_9e2!=true){_9e1.enable();}},showLayer:function(_9e6){var _9e7=this.getLayer(_9e6);if(_9e7){_9e7.show();}else{console.warn("[LayersManager] Cannot show layer "+_9e6+" because it was not found.");}},hideLayer:function(_9e8){var _9e9=this.getLayer(_9e8);if(_9e9){_9e9.hide();}else{console.warn("[LayersManager] Cannot hide layer "+_9e8+" because it was not found.");}},getLayer:function(_9ea){if(this._layers.hasOwnProperty(_9ea)==true){return this._layers[_9ea];}return null;},redrawMarkers:function(){for(var _9eb in this._layers){this._layers[_9eb].redrawMarkers();}},getLayerById:function(_9ec){_9ec=_9ec.toLowerCase();for(id in this._layersById){var _9ed=id.toLowerCase();if(_9ed==_9ec){return this._layersById[id];}}return null;},getLayers:function(){var _9ee=[];for(var _9ef in this._layers){_9ee.push(this._layers[_9ef]);}return _9ee;},removeRecordsFromLayer:function(_9f0,data){var _9f1=this.getLayer(_9f0);if(_9f1){for(var _9f2 in data){_9f1.removeRecord(data[_9f2]);}}else{}this._map.refreshMap();},_getLayerByIdOrDefaultForMbo:function(_9f3,_9f4){if(_9f3){return this.getLayerById(_9f3);}else{return this._getLayerForMbo(_9f4);}},setMboMarkerInfo:function(_9f5,opt,_9f6){var _9f7=this._getLayerByIdOrDefaultForMbo(_9f6,_9f5);return _9f7.setMboMarkerInfo(_9f5,opt);},getMboMarkerInfo:function(_9f8,_9f9){var _9fa=this._getLayerByIdOrDefaultForMbo(_9f9,_9f8);return _9fa.getMboMarkerInfo(_9f8);}});});},"ibm/tivoli/fwm/mxmap/layers/Layer":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/ImageLibraryManager"],function(_9fb,dojo,_9fc){dojo.provide("ibm.tivoli.fwm.mxmap.layers.Layer");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.ImageLibraryManager");ibm.tivoli.fwm.mxmap.layers.LayerType={LAYER:0,SYMBOLOGY:1,LEGEND:2,VIRTUAL_LAYER:4};dojo.declare("ibm.tivoli.fwm.mxmap.layers.Layer",[ibm.tivoli.fwm.mxmap._Base],{_layerName:null,_layerId:null,_records:null,_map:null,_disabled:null,_childLayers:null,_parentLayer:null,_leftIconURL:null,_rightIconURL:null,_rightIconSet:false,_childrenTitle:null,layerRecords:null,_mboMarkerOptions:null,constructor:function(_9fd){dojo.mixin(this,_9fd);this._childLayers=[];this._layerId=_9fd.layerId;this._mboMarkerOptions=new _9fe();this._map=_9fd.map;this.layerRecords=[];this._disabled=true;this._layerName=this.layerName;this._childrenTitle=_9fd.childrenTitle;this._parentLayer=_9fd.parentLayer;var _9ff=ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager();this._rightIconURL=_9ff.getLayerDetailsOffImageInfo().getImageURL();if(this.layerType==ibm.tivoli.fwm.mxmap.layers.LayerType.LAYER){this.layerConf=this.symbManager.getLayerConfigById(this._layerId);if(!this.layerConf){console.warn("[Layer] No conf for ",this._layerId);this.layerConf=this.symbManager.getDefaultLayerConfigFor(this._layerId);}this._layerName=this.layerConf.label;this._childrenTitle=this.layerConf.symbologyTitle;var _a00=this.symbManager.getSymbologyConfigArrayByLayer(this.layerConf);var _a01=true;for(var _a02 in _a00){var _a03=_a00[_a02];var _a04=_a03.type;var _a05=_a03.label;var _a06=_a03.legendTitle;var _a07=this.createNewChildLayer({layerName:_a05,layerId:_a02.toLowerCase(),layerConf:_a03,map:this._map,layerType:ibm.tivoli.fwm.mxmap.layers.LayerType.SYMBOLOGY,symbologyType:_a04,childrenTitle:_a06});if(_a01==true){_a07.enable();this.symbManager.setActiveSymbology(this.layerConf.id,_a03);_a01=false;}var _a08=this.symbManager.getLegendConfigArrayBySymbology(_a03);for(var _a09 in _a08){var _a0a=_a08[_a09];var _a0b=_a0a.label;var _a0c=_a0a.symbol;var _a0d=_a07.createNewChildLayer({layerConf:_a0a,layerName:_a0b,layerId:_a09.toLowerCase(),map:this._map,layerType:ibm.tivoli.fwm.mxmap.layers.LayerType.LEGEND,symbol:_a0c});}}var _a0e=this.symbManager.getDefaultSymbologyForLayer(this.layerConf.id);if(_a0e!=null){var _a07=null;_a07=dojo.filter(this.getChildren(),function(_a0f){return (_a0f.layerId==_a0e);});if(_a07.length>0){_a07[0].toggleState();this.symbManager.setActiveSymbology(this.layerConf.id,_a00[_a0e]);}}}this.init();},init:function(){this._setLeftIconURL();},_setLeftIconURL:function(){var _a10=ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager();if(this.isDisabled()){this._leftIconURL=_a10.getLayerOffImageInfo().getImageURL();}else{this._leftIconURL=_a10.getLayerOnImageInfo().getImageURL();}},_setRightIconURL:function(){var _a11=ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager();this._rightIconURL=_a11.getLayerDetailsImageInfo().getImageURL();this._rightIconSet=true;},getLeftIconURL:function(){return this._leftIconURL;},getRightIconURL:function(){return this._rightIconURL;},getLayerName:function(){return this._layerName;},getLayerId:function(){return this._layerId;},getMXRecordSet:function(){return this._records;},toggleState:function(){if(this.isDisabled()){this.enable();}else{this.disable();}},show:function(){this._disabled=false;if(this._records!=null){this._records.showMXRecordsOnMap();}},addRecord:function(_a12,_a13){var _a14=this._getRecord(_a12);if(_a14!=null){_a12.counter=this.layerRecords[_a14].counter;this.map.removeMboMarkerFromMap(this.layerRecords[_a14],this._layerId);_a12.counter++;this.layerRecords[_a14]=_a12;}else{_a12.counter=1;this.layerRecords.push(_a12);}if(!this.isDisabled()){this.map.addMboMarker(_a12,_a13,this._layerId);}},removeRecord:function(_a15){for(var i=0;i<this.layerRecords.length;++i){if(this._mboInfosEqual(this.layerRecords[i],_a15)){var _a16=--this.layerRecords[i].counter;if(_a16==0){this.layerRecords.splice(i,1);this.map.removeMboMarkerFromMap(_a15,this._layerId);}return _a16;}}},_getRecord:function(_a17){for(var i=0;i<this.layerRecords.length;++i){if(this._mboInfosEqual(this.layerRecords[i],_a17)){return i;}}return null;},hasRecord:function(_a18){for(var i=0;i<this.layerRecords.length;++i){if(this._mboInfosEqual(this.layerRecords[i],_a18)){return true;}}return false;},_mboInfosEqual:function(_a19,_a1a){return (_a19.mxdata.mboName==_a1a.mxdata.mboName&&_a19.mxdata.uid.value==_a1a.mxdata.uid.value);},hasRecords:function(){return this.layerRecords.length>0;},isVisibleInUI:function(){if(this.layerType==ibm.tivoli.fwm.mxmap.layers.LayerType.LAYER){return this.hasRecords();}else{return true;}},addMXRecordSet:function(_a1b){if(this._records!=null){this._records.addMXRecordSet(_a1b);}},removeMXRecordSetData:function(){if(this._records!=null){this._records.removeMXRecordsFromMap();}else{if(dojo.config.fwm.debug==true){}}if(this.layerRecords!=null){for(rec in this.layerRecords){var _a1c=this.layerRecords[rec];this._map.removeMboMarker(_a1c,this._layerId);}this.layerRecords=[];}},isDisabled:function(){return (this._disabled==true);},removeMXRecordByUid:function(_a1d){if(this._records!=null){this._records.removeRecordFromMap(_a1d);}else{if(dojo.config.fwm.debug==true){}}},createNewChildLayer:function(_a1e){var _a1f=null;_a1e.parentLayer=this;switch(_a1e.layerType){case ibm.tivoli.fwm.mxmap.layers.LayerType.SYMBOLOGY:_a1f=new ibm.tivoli.fwm.mxmap.layers.SymbologyLayer(_a1e);break;case ibm.tivoli.fwm.mxmap.layers.LayerType.LEGEND:_a1f=new ibm.tivoli.fwm.mxmap.layers.LegendLayer(_a1e);break;default:_a1f=new ibm.tivoli.fwm.mxmap.layers.Layer(_a1e);break;}if(_a1f!=null){this.addChildLayer(_a1f);}return _a1f;},addChildLayer:function(_a20,_a21){var _a22=_a20.getLayerName();var _a23=this.getChildLayer(_a22);if(_a23==null){this._childLayers[_a22]=_a20;}if(this._rightIconSet==false){this._setRightIconURL();}},getChildLayer:function(_a24){if(this._childLayers.hasOwnProperty(_a24)==true){return this._childLayers[_a24];}return null;},getChildren:function(){var _a25=[];for(var _a26 in this._childLayers){_a25.push(this._childLayers[_a26]);}return _a25;},getParentLayer:function(){return this._parentLayer;},getSiblings:function(){return this.isRoot()?null:this._parentLayer.getChildren();},hasChildren:function(){var _a27=false;for(var _a28 in this._childLayers){_a27=true;break;}return _a27;},isRoot:function(){return (this._parentLayer==null);},enable:function(){this._disabled=false;if(this.layerRecords!=null){for(rec in this.layerRecords){var _a29=this.layerRecords[rec];this._map.showMboMarker(_a29,this._layerId);}}this._setLeftIconURL();},disable:function(){this._disabled=true;if(this.layerRecords!=null){for(rec in this.layerRecords){var _a2a=this.layerRecords[rec];this._map.removeMboMarkerFromMap(_a2a,this._layerId);}}this._setLeftIconURL();},redrawMarkers:function(){if(this.layerRecords!=null&&!this.isDisabled()){for(rec in this.layerRecords){var _a2b=this.layerRecords[rec];this._map.removeMboMarkerFromMap(_a2b,this._layerId);this._map.showMboMarker(_a2b,this._layerId);}}},getChildrenTitle:function(){return this._childrenTitle;},setMboMarkerInfo:function(_a2c,opt){return this._mboMarkerOptions.setMboMarkerInfo(_a2c,opt);},getMboMarkerInfo:function(_a2d){return this._mboMarkerOptions.getMboMarkerInfo(_a2d);}});function _9fe(){this.mbosOnMap={};this.setMboMarkerInfo=function(_a2e,opt){this._createMboMarkerHashRecord(_a2e);for(var _a2f in opt){this.mbosOnMap[_a2e.mxdata.mboName][_a2e.mxdata.uid.value][_a2f]=opt[_a2f];}};this._createMboMarkerHashRecord=function(_a30){if(!this.mbosOnMap[_a30.mxdata.mboName]){this.mbosOnMap[_a30.mxdata.mboName]={};}if(!this.mbosOnMap[_a30.mxdata.mboName][_a30.mxdata.uid.value]){this.mbosOnMap[_a30.mxdata.mboName][_a30.mxdata.uid.value]={};this.mbosOnMap[_a30.mxdata.mboName][_a30.mxdata.uid.value]["layerCount"]=0;}};this.getMboMarkerInfo=function(_a31){if(!_a31.mxdata){return null;}if(!this.mbosOnMap[_a31.mxdata.mboName]){return null;}if(!this.mbosOnMap[_a31.mxdata.mboName][_a31.mxdata.uid.value]){return null;}return this.mbosOnMap[_a31.mxdata.mboName][_a31.mxdata.uid.value];};};});},"dojo/dnd/common":function(){define("dojo/dnd/common",["../main"],function(dojo){dojo.getObject("dnd",true,dojo);dojo.dnd.getCopyKeyState=dojo.isCopyKey;dojo.dnd._uniqueId=0;dojo.dnd.getUniqueId=function(){var id;do{id=dojo._scopeName+"Unique"+(++dojo.dnd._uniqueId);}while(dojo.byId(id));return id;};dojo.dnd._empty={};dojo.dnd.isFormElement=function(e){var t=e.target;if(t.nodeType==3){t=t.parentNode;}return " button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;};return dojo.dnd;});},"dijit/CheckedMenuItem":function(){require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\"\n\t\tdata-dojo-attach-event=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n"}});define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_a32,_a33,_a34,_a35){return _a32("dijit.CheckedMenuItem",_a34,{templateString:_a35,checked:false,_setCheckedAttr:function(_a36){_a33.toggle(this.domNode,"dijitCheckedMenuItemChecked",_a36);this.domNode.setAttribute("aria-checked",_a36);this._set("checked",_a36);},iconClass:"",onChange:function(){},_onClick:function(e){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.inherited(arguments);}});});},"ibm/tivoli/fwm/mxmap/actions/SetRecordLocation":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/actions/Actions,ibm/tivoli/fwm/mxmap/_Base,ibm/tivoli/fwm/mxmap/ImageLibraryManager"],function(_a37,dojo,_a38){dojo.provide("ibm.tivoli.fwm.mxmap.actions.SetRecordLocation");dojo.require("ibm.tivoli.fwm.mxmap.actions.Actions");dojo.require("ibm.tivoli.fwm.mxmap._Base");dojo.require("ibm.tivoli.fwm.mxmap.ImageLibraryManager");dojo.declare("ibm.tivoli.fwm.mxmap.actions.SetRecordLocation",[ibm.tivoli.fwm.mxmap.actions.Actions,ibm.tivoli.fwm.mxmap._Base],{constructor:function(_a39){dojo.mixin(this,_a39);this.label=ibm.tivoli.fwm.i18n.getMaxMsg("map","set_recloc_label");this.mapstraction=this.map.getMapstraction();this.addSubscription(dojo.subscribe("onCurrentLocationUpdated_"+this.map.getId(),dojo.hitch(this,this._clearMarker)));this.addSubscription(dojo.subscribe("onServerException_"+this.map.getId(),dojo.hitch(this,this._clearMarker)));},marker:null,mapstraction:null,_clearMarker:function(){if(this.marker!=null){if(dojo.config.fwm.debug==true){}this.mapstraction.removeMarker(this.marker);}},_getPushPinImagePath:function(){var _a3a=ibm.tivoli.fwm.mxmap.ImageLibraryManager.getImageLibraryManager().getDefaultReadOnlyMarkerImageInfo().getImageURL();var _a3b=this.map.mapConf.markerimgurl;if(_a3b!=null&&_a3b.trim().length>0){return _a3b;}return _a3a;},execute:function(args){if(this.marker!=null){this.mapstraction.removeMarker(this.marker);}this.marker=new mxn.Marker(args.mapLocation);var _a3c=this._getPushPinImagePath();var _a3d={draggable:true,icon:_a3c,iconSize:[32,32],iconAnchor:[11,32],hover:true};this.mapstraction.addMarkerWithData(this.marker,_a3d);this.map.currentRecordMgr.reverseGeocodeCurrentRecord(args.mapLocation);}});});},"dijit/_base/place":function(){define("dijit/_base/place",["dojo/_base/array","dojo/_base/lang","dojo/window","../place",".."],function(_a3e,lang,_a3f,_a40,_a41){_a41.getViewport=function(){return _a3f.getBox();};_a41.placeOnScreen=_a40.at;_a41.placeOnScreenAroundElement=function(node,_a42,_a43,_a44){var _a45;if(lang.isArray(_a43)){_a45=_a43;}else{_a45=[];for(var key in _a43){_a45.push({aroundCorner:key,corner:_a43[key]});}}return _a40.around(node,_a42,_a45,true,_a44);};_a41.placeOnScreenAroundNode=_a41.placeOnScreenAroundElement;_a41.placeOnScreenAroundRectangle=_a41.placeOnScreenAroundElement;_a41.getPopupAroundAlignment=function(_a46,_a47){var _a48={};_a3e.forEach(_a46,function(pos){var ltr=_a47;switch(pos){case "after":_a48[_a47?"BR":"BL"]=_a47?"BL":"BR";break;case "before":_a48[_a47?"BL":"BR"]=_a47?"BR":"BL";break;case "below-alt":ltr=!ltr;case "below":_a48[ltr?"BL":"BR"]=ltr?"TL":"TR";_a48[ltr?"BR":"BL"]=ltr?"TR":"TL";break;case "above-alt":ltr=!ltr;case "above":default:_a48[ltr?"TL":"TR"]=ltr?"BL":"BR";_a48[ltr?"TR":"TL"]=ltr?"BR":"BL";break;}});return _a48;};return _a41;});},"ibm/tivoli/fwm/mxmap/impl/BingMaps":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/Map"],function(_a49,dojo,_a4a){dojo.provide("ibm.tivoli.fwm.mxmap.impl.BingMaps");dojo.require("ibm.tivoli.fwm.mxmap.Map");dojo.declare("ibm.tivoli.fwm.mxmap.impl.BingMaps",ibm.tivoli.fwm.mxmap.Map,{constructor:function(_a4b){this.providerName="microsoftv7";},_getInitOptions:function(){var _a4c={};_a4c.fixedMapPosition=false;_a4c.useInertia=true;_a4c.showScalebar=true;_a4c.disableTouchInput=false;_a4c.enableClickableLogo=false;_a4c.enableSearchLogo=false;_a4c.showCopyright=true;_a4c.mapTypeId=Microsoft.Maps.MapTypeId.road;_a4c.isIE=dojo.isIE;if(this.isMobile==true){_a4c.showScalebar=false;}_a4c.initialLocation=this._getInitialLocation();return _a4c;},_getCustomInitOptions:function(){if(this.customInitialMapOptions){return this.customInitialMapOptions.bingmaps;}log.info("no custom configuration");return {};},destroyMap:function(){try{var map=this.getMapstraction();if(typeof (map)!="undefined"&&map!=null){map.destroyMap();}if(dojo.config.fwm.debug==true){}}catch(e){console.error("cannot destroy bing maps ",e.message);}}});});},"dijit/MenuSeparator":function(){require({cache:{"url:dijit/templates/MenuSeparator.html":"<tr class=\"dijitMenuSeparator\">\n\t<td class=\"dijitMenuSeparatorIconCell\">\n\t\t<div class=\"dijitMenuSeparatorTop\"></div>\n\t\t<div class=\"dijitMenuSeparatorBottom\"></div>\n\t</td>\n\t<td colspan=\"3\" class=\"dijitMenuSeparatorLabelCell\">\n\t\t<div class=\"dijitMenuSeparatorTop dijitMenuSeparatorLabel\"></div>\n\t\t<div class=\"dijitMenuSeparatorBottom\"></div>\n\t</td>\n</tr>"}});define("dijit/MenuSeparator",["dojo/_base/declare","dojo/dom","./_WidgetBase","./_TemplatedMixin","./_Contained","dojo/text!./templates/MenuSeparator.html"],function(_a4d,dom,_a4e,_a4f,_a50,_a51){return _a4d("dijit.MenuSeparator",[_a4e,_a4f,_a50],{templateString:_a51,buildRendering:function(){this.inherited(arguments);dom.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});});},"ibm/tivoli/fwm/mxmap/impl/GMaps":function(){define(["dijit","dojo","dojox","dojo/require!ibm/tivoli/fwm/mxmap/Map"],function(_a52,dojo,_a53){dojo.provide("ibm.tivoli.fwm.mxmap.impl.GMaps");dojo.require("ibm.tivoli.fwm.mxmap.Map");dojo.declare("ibm.tivoli.fwm.mxmap.impl.GMaps",ibm.tivoli.fwm.mxmap.Map,{constructor:function(_a54){this.providerName="googlev3";},_getCustomInitOptions:function(){if(this.customInitialMapOptions){return this.customInitialMapOptions.gmaps;}log.info("no custom configuration");return {};},_getInitOptions:function(){var _a55={panControl:true,mapTypeControl:true,scaleControl:true,overviewMapControl:true,streetViewControl:true,scaleControlOptions:{style:google.maps.ScaleControlStyle.DEFAULT},mapTypeId:google.maps.MapTypeId.ROADMAP};if(this.isMobile==true){_a55.panControl=false;_a55.overviewMapControl=false;_a55.scaleControl=false;}return _a55;},destroyMap:function(){}});});},"dijit/Dialog":function(){require({cache:{"url:dijit/templates/Dialog.html":"<div class=\"dijitDialog\" role=\"dialog\" aria-labelledby=\"${id}_title\">\n\t<div data-dojo-attach-point=\"titleBar\" class=\"dijitDialogTitleBar\">\n\t<span data-dojo-attach-point=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\"></span>\n\t<span data-dojo-attach-point=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" data-dojo-attach-event=\"ondijitclick: onCancel\" title=\"${buttonCancel}\" role=\"button\" tabIndex=\"-1\">\n\t\t<span data-dojo-attach-point=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\n\t</span>\n\t</div>\n\t\t<div data-dojo-attach-point=\"containerNode\" class=\"dijitDialogPaneContent\"></div>\n</div>\n"}});define("dijit/Dialog",["require","dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/_base/fx","dojo/i18n","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/ready","dojo/_base/sniff","dojo/_base/window","dojo/window","dojo/dnd/Moveable","dojo/dnd/TimedMoveable","./focus","./_base/manager","./_Widget","./_TemplatedMixin","./_CssStateMixin","./form/_FormMixin","./_DialogMixin","./DialogUnderlay","./layout/ContentPane","dojo/text!./templates/Dialog.html",".","dojo/i18n!./nls/common"],function(_a56,_a57,_a58,_a59,_a5a,dom,_a5b,_a5c,_a5d,_a5e,fx,i18n,_a5f,keys,lang,on,_a60,has,win,_a61,_a62,_a63,_a64,_a65,_a66,_a67,_a68,_a69,_a6a,_a6b,_a6c,_a6d,_a6e){var _a6f=_a59("dijit._DialogBase",[_a67,_a69,_a6a,_a68],{templateString:_a6d,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:[{node:"titleNode",type:"innerHTML"},{node:"titleBar",type:"attribute"}],open:false,duration:_a65.defaultDuration,refocus:true,autofocus:true,_firstFocusItem:null,_lastFocusItem:null,doLayout:false,draggable:true,"aria-describedby":"",postMixInProperties:function(){var _a70=i18n.getLocalization("dijit","common");lang.mixin(this,_a70);this.inherited(arguments);},postCreate:function(){_a5d.set(this.domNode,{display:"none",position:"absolute"});win.body().appendChild(this.domNode);this.inherited(arguments);this.connect(this,"onExecute","hide");this.connect(this,"onCancel","hide");this._modalconnects=[];},onLoad:function(){this._position();if(this.autofocus&&_a71.isTop(this)){this._getFocusItems(this.domNode);_a64.focus(this._firstFocusItem);}this.inherited(arguments);},_endDrag:function(){var _a72=_a5c.position(this.domNode),_a73=_a61.getBox();_a72.y=Math.min(Math.max(_a72.y,0),(_a73.h-_a72.h));_a72.x=Math.min(Math.max(_a72.x,0),(_a73.w-_a72.w));this._relativePosition=_a72;this._position();},_setup:function(){var node=this.domNode;if(this.titleBar&&this.draggable){this._moveable=new ((has("ie")==6)?_a63:_a62)(node,{handle:this.titleBar});this.connect(this._moveable,"onMoveStop","_endDrag");}else{_a5b.add(node,"dijitDialogFixed");}this.underlayAttrs={dialogId:this.id,"class":_a57.map(this["class"].split(/\s/),function(s){return s+"_underlay";}).join(" ")};},_size:function(){this._checkIfSingleChild();if(this._singleChild){if(this._singleChildOriginalStyle){this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle;}delete this._singleChildOriginalStyle;}else{_a5d.set(this.containerNode,{width:"auto",height:"auto"});}var bb=_a5c.position(this.domNode);var _a74=_a61.getBox();if(bb.w>=_a74.w||bb.h>=_a74.h){var w=Math.min(bb.w,Math.floor(_a74.w*0.75)),h=Math.min(bb.h,Math.floor(_a74.h*0.75));if(this._singleChild&&this._singleChild.resize){this._singleChildOriginalStyle=this._singleChild.domNode.style.cssText;this._singleChild.resize({w:w,h:h});}else{_a5d.set(this.containerNode,{width:w+"px",height:h+"px",overflow:"auto",position:"relative"});}}else{if(this._singleChild&&this._singleChild.resize){this._singleChild.resize();}}},_position:function(){if(!_a5b.contains(win.body(),"dojoMove")){var node=this.domNode,_a75=_a61.getBox(),p=this._relativePosition,bb=p?null:_a5c.position(node),l=Math.floor(_a75.l+(p?p.x:(_a75.w-bb.w)/2)),t=Math.floor(_a75.t+(p?p.y:(_a75.h-bb.h)/2));_a5d.set(node,{left:l+"px",top:t+"px"});}},_onKey:function(evt){if(evt.charOrCode){var node=evt.target;if(evt.charOrCode===keys.TAB){this._getFocusItems(this.domNode);}var _a76=(this._firstFocusItem==this._lastFocusItem);if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===keys.TAB){if(!_a76){_a64.focus(this._lastFocusItem);}_a5e.stop(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===keys.TAB&&!evt.shiftKey){if(!_a76){_a64.focus(this._firstFocusItem);}_a5e.stop(evt);}else{while(node){if(node==this.domNode||_a5b.contains(node,"dijitPopup")){if(evt.charOrCode==keys.ESCAPE){this.onCancel();}else{return;}}node=node.parentNode;}if(evt.charOrCode!==keys.TAB){_a5e.stop(evt);}else{if(!has("opera")){try{this._firstFocusItem.focus();}catch(e){}}}}}}},show:function(){if(this.open){return;}if(!this._started){this.startup();}if(!this._alreadyInitialized){this._setup();this._alreadyInitialized=true;}if(this._fadeOutDeferred){this._fadeOutDeferred.cancel();}this._modalconnects.push(on(window,"scroll",lang.hitch(this,"layout")));this._modalconnects.push(on(window,"resize",lang.hitch(this,function(){var _a77=_a61.getBox();if(!this._oldViewport||_a77.h!=this._oldViewport.h||_a77.w!=this._oldViewport.w){this.layout();this._oldViewport=_a77;}})));this._modalconnects.push(on(this.domNode,_a58._keypress,lang.hitch(this,"_onKey")));_a5d.set(this.domNode,{opacity:0,display:""});this._set("open",true);this._onShow();this._size();this._position();var _a78;this._fadeInDeferred=new _a5a(lang.hitch(this,function(){_a78.stop();delete this._fadeInDeferred;}));_a78=fx.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:lang.hitch(this,function(){_a71.show(this,this.underlayAttrs);}),onEnd:lang.hitch(this,function(){if(this.autofocus&&_a71.isTop(this)){this._getFocusItems(this.domNode);_a64.focus(this._firstFocusItem);}this._fadeInDeferred.callback(true);delete this._fadeInDeferred;})}).play();return this._fadeInDeferred;},hide:function(){if(!this._alreadyInitialized){return;}if(this._fadeInDeferred){this._fadeInDeferred.cancel();}var _a79;this._fadeOutDeferred=new _a5a(lang.hitch(this,function(){_a79.stop();delete this._fadeOutDeferred;}));this._fadeOutDeferred.then(lang.hitch(this,"onHide"));_a79=fx.fadeOut({node:this.domNode,duration:this.duration,onEnd:lang.hitch(this,function(){this.domNode.style.display="none";_a71.hide(this);this._fadeOutDeferred.callback(true);delete this._fadeOutDeferred;})}).play();if(this._scrollConnected){this._scrollConnected=false;}var h;while(h=this._modalconnects.pop()){h.remove();}if(this._relativePosition){delete this._relativePosition;}this._set("open",false);return this._fadeOutDeferred;},layout:function(){if(this.domNode.style.display!="none"){if(_a6e._underlay){_a6e._underlay.layout();}this._position();}},destroy:function(){if(this._fadeInDeferred){this._fadeInDeferred.cancel();}if(this._fadeOutDeferred){this._fadeOutDeferred.cancel();}if(this._moveable){this._moveable.destroy();}var h;while(h=this._modalconnects.pop()){h.remove();}_a71.hide(this);this.inherited(arguments);}});var _a7a=_a59("dijit.Dialog",[_a6c,_a6f],{});_a7a._DialogBase=_a6f;var _a71=_a7a._DialogLevelManager={_beginZIndex:950,show:function(_a7b,_a7c){ds[ds.length-1].focus=_a64.curNode;var _a7d=_a6e._underlay;if(!_a7d||_a7d._destroyed){_a7d=_a6e._underlay=new _a6b(_a7c);}else{_a7d.set(_a7b.underlayAttrs);}var _a7e=ds[ds.length-1].dialog?ds[ds.length-1].zIndex+2:_a7a._DialogLevelManager._beginZIndex;if(ds.length==1){_a7d.show();}_a5d.set(_a6e._underlay.domNode,"zIndex",_a7e-1);_a5d.set(_a7b.domNode,"zIndex",_a7e);ds.push({dialog:_a7b,underlayAttrs:_a7c,zIndex:_a7e});},hide:function(_a7f){if(ds[ds.length-1].dialog==_a7f){ds.pop();var pd=ds[ds.length-1];if(ds.length==1){if(!_a6e._underlay._destroyed){_a6e._underlay.hide();}}else{_a5d.set(_a6e._underlay.domNode,"zIndex",pd.zIndex-1);_a6e._underlay.set(pd.underlayAttrs);}if(_a7f.refocus){var _a80=pd.focus;if(pd.dialog&&(!_a80||!dom.isDescendant(_a80,pd.dialog.domNode))){pd.dialog._getFocusItems(pd.dialog.domNode);_a80=pd.dialog._firstFocusItem;}if(_a80){_a80.focus();}}}else{var idx=_a57.indexOf(_a57.map(ds,function(elem){return elem.dialog;}),_a7f);if(idx!=-1){ds.splice(idx,1);}}},isTop:function(_a81){return ds[ds.length-1].dialog==_a81;}};var ds=_a7a._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];if(!_a5f.isAsync){_a60(0,function(){var _a82=["dijit/TooltipDialog"];_a56(_a82);});}return _a7a;});},"dijit/_base/focus":function(){define("dijit/_base/focus",["dojo/_base/array","dojo/dom","dojo/_base/lang","dojo/topic","dojo/_base/window","../focus",".."],function(_a83,dom,lang,_a84,win,_a85,_a86){lang.mixin(_a86,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return _a86.getBookmark().isCollapsed;},getBookmark:function(){var bm,rg,tg,sel=win.doc.selection,cf=_a85.curNode;if(win.global.getSelection){sel=win.global.getSelection();if(sel){if(sel.isCollapsed){tg=cf?cf.tagName:"";if(tg){tg=tg.toLowerCase();if(tg=="textarea"||(tg=="input"&&(!cf.type||cf.type.toLowerCase()=="text"))){sel={start:cf.selectionStart,end:cf.selectionEnd,node:cf,pRange:true};return {isCollapsed:(sel.end<=sel.start),mark:sel};}}bm={isCollapsed:true};if(sel.rangeCount){bm.mark=sel.getRangeAt(0).cloneRange();}}else{rg=sel.getRangeAt(0);bm={isCollapsed:false,mark:rg.cloneRange()};}}}else{if(sel){tg=cf?cf.tagName:"";tg=tg.toLowerCase();if(cf&&tg&&(tg=="button"||tg=="textarea"||tg=="input")){if(sel.type&&sel.type.toLowerCase()=="none"){return {isCollapsed:true,mark:null};}else{rg=sel.createRange();return {isCollapsed:rg.text&&rg.text.length?false:true,mark:{range:rg,pRange:true}};}}bm={};try{rg=sel.createRange();bm.isCollapsed=!(sel.type=="Text"?rg.htmlText.length:rg.length);}catch(e){bm.isCollapsed=true;return bm;}if(sel.type.toUpperCase()=="CONTROL"){if(rg.length){bm.mark=[];var i=0,len=rg.length;while(i<len){bm.mark.push(rg.item(i++));}}else{bm.isCollapsed=true;bm.mark=null;}}else{bm.mark=rg.getBookmark();}}else{console.warn("No idea how to store the current selection for this browser!");}}return bm;},moveToBookmark:function(_a87){var _a88=win.doc,mark=_a87.mark;if(mark){if(win.global.getSelection){var sel=win.global.getSelection();if(sel&&sel.removeAllRanges){if(mark.pRange){var n=mark.node;n.selectionStart=mark.start;n.selectionEnd=mark.end;}else{sel.removeAllRanges();sel.addRange(mark);}}else{console.warn("No idea how to restore selection for this browser!");}}else{if(_a88.selection&&mark){var rg;if(mark.pRange){rg=mark.range;}else{if(lang.isArray(mark)){rg=_a88.body.createControlRange();_a83.forEach(mark,function(n){rg.addElement(n);});}else{rg=_a88.body.createTextRange();rg.moveToBookmark(mark);}}rg.select();}}}},getFocus:function(menu,_a89){var node=!_a85.curNode||(menu&&dom.isDescendant(_a85.curNode,menu.domNode))?_a86._prevFocus:_a85.curNode;return {node:node,bookmark:node&&(node==_a85.curNode)&&win.withGlobal(_a89||win.global,_a86.getBookmark),openedForWindow:_a89};},_activeStack:[],registerIframe:function(_a8a){return _a85.registerIframe(_a8a);},unregisterIframe:function(_a8b){_a8b&&_a8b.remove();},registerWin:function(_a8c,_a8d){return _a85.registerWin(_a8c,_a8d);},unregisterWin:function(_a8e){_a8e&&_a8e.remove();}});_a85.focus=function(_a8f){if(!_a8f){return;}var node="node" in _a8f?_a8f.node:_a8f,_a90=_a8f.bookmark,_a91=_a8f.openedForWindow,_a92=_a90?_a90.isCollapsed:false;if(node){var _a93=(node.tagName.toLowerCase()=="iframe")?node.contentWindow:node;if(_a93&&_a93.focus){try{_a93.focus();}catch(e){}}_a85._onFocusNode(node);}if(_a90&&win.withGlobal(_a91||win.global,_a86.isCollapsed)&&!_a92){if(_a91){_a91.focus();}try{win.withGlobal(_a91||win.global,_a86.moveToBookmark,null,[_a90]);}catch(e2){}}};_a85.watch("curNode",function(name,_a94,_a95){_a86._curFocus=_a95;_a86._prevFocus=_a94;if(_a95){_a84.publish("focusNode",_a95);}});_a85.watch("activeStack",function(name,_a96,_a97){_a86._activeStack=_a97;});_a85.on("widget-blur",function(_a98,by){_a84.publish("widgetBlur",_a98,by);});_a85.on("widget-focus",function(_a99,by){_a84.publish("widgetFocus",_a99,by);});return _a86;});},"dijit/a11y":function(){define("dijit/a11y",["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-style","dojo/_base/sniff","./_base/manager","."],function(_a9a,_a9b,_a9c,dom,_a9d,_a9e,has,_a9f,_aa0){var _aa1=(_aa0._isElementShown=function(elem){var s=_a9e.get(elem);return (s.visibility!="hidden")&&(s.visibility!="collapsed")&&(s.display!="none")&&(_a9d.get(elem,"type")!="hidden");});_aa0.hasDefaultTabStop=function(elem){switch(elem.nodeName.toLowerCase()){case "a":return _a9d.has(elem,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return true;case "iframe":var body;try{var _aa2=elem.contentDocument;if("designMode" in _aa2&&_aa2.designMode=="on"){return true;}body=_aa2.body;}catch(e1){try{body=elem.contentWindow.document.body;}catch(e2){return false;}}return body&&(body.contentEditable=="true"||(body.firstChild&&body.firstChild.contentEditable=="true"));default:return elem.contentEditable=="true";}};var _aa3=(_aa0.isTabNavigable=function(elem){if(_a9d.get(elem,"disabled")){return false;}else{if(_a9d.has(elem,"tabIndex")){return _a9d.get(elem,"tabIndex")>=0;}else{return _aa0.hasDefaultTabStop(elem);}}});_aa0._getTabNavigable=function(root){var _aa4,last,_aa5,_aa6,_aa7,_aa8,_aa9={};function _aaa(node){return node&&node.tagName.toLowerCase()=="input"&&node.type&&node.type.toLowerCase()=="radio"&&node.name&&node.name.toLowerCase();};var _aab=function(_aac){for(var _aad=_aac.firstChild;_aad;_aad=_aad.nextSibling){if(_aad.nodeType!=1||(has("ie")&&_aad.scopeName!=="HTML")||!_aa1(_aad)){continue;}if(_aa3(_aad)){var _aae=_a9d.get(_aad,"tabIndex");if(!_a9d.has(_aad,"tabIndex")||_aae==0){if(!_aa4){_aa4=_aad;}last=_aad;}else{if(_aae>0){if(!_aa5||_aae<_aa6){_aa6=_aae;_aa5=_aad;}if(!_aa7||_aae>=_aa8){_aa8=_aae;_aa7=_aad;}}}var rn=_aaa(_aad);if(_a9d.get(_aad,"checked")&&rn){_aa9[rn]=_aad;}}if(_aad.nodeName.toUpperCase()!="SELECT"){_aab(_aad);}}};if(_aa1(root)){_aab(root);}function rs(node){return _aa9[_aaa(node)]||node;};return {first:rs(_aa4),last:rs(last),lowest:rs(_aa5),highest:rs(_aa7)};};_aa0.getFirstInTabbingOrder=function(root){var _aaf=_aa0._getTabNavigable(dom.byId(root));return _aaf.lowest?_aaf.lowest:_aaf.first;};_aa0.getLastInTabbingOrder=function(root){var _ab0=_aa0._getTabNavigable(dom.byId(root));return _ab0.last?_ab0.last:_ab0.highest;};return {hasDefaultTabStop:_aa0.hasDefaultTabStop,isTabNavigable:_aa0.isTabNavigable,_getTabNavigable:_aa0._getTabNavigable,getFirstInTabbingOrder:_aa0.getFirstInTabbingOrder,getLastInTabbingOrder:_aa0.getLastInTabbingOrder};});},"dijit/form/_ToggleButtonMixin":function(){define("dijit/form/_ToggleButtonMixin",["dojo/_base/declare","dojo/dom-attr"],function(_ab1,_ab2){return _ab1("dijit.form._ToggleButtonMixin",null,{checked:false,_aria_attr:"aria-pressed",_onClick:function(evt){var _ab3=this.checked;this._set("checked",!_ab3);var ret=this.inherited(arguments);this.set("checked",ret?this.checked:_ab3);return ret;},_setCheckedAttr:function(_ab4,_ab5){this._set("checked",_ab4);_ab2.set(this.focusNode||this.domNode,"checked",_ab4);(this.focusNode||this.domNode).setAttribute(this._aria_attr,_ab4?"true":"false");this._handleOnChange(_ab4,_ab5);},reset:function(){this._hasBeenBlurred=false;this.set("checked",this.params.checked||false);}});});},"dijit/_Widget":function(){define("dijit/_Widget",["dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/query","dojo/ready","./registry","./_WidgetBase","./_OnDijitClickMixin","./_FocusMixin","dojo/uacss","./hccss"],function(_ab6,_ab7,_ab8,_ab9,_aba,lang,_abb,_abc,_abd,_abe,_abf,_ac0){function _ac1(){};function _ac2(_ac3){return function(obj,_ac4,_ac5,_ac6){if(obj&&typeof _ac4=="string"&&obj[_ac4]==_ac1){return obj.on(_ac4.substring(2).toLowerCase(),lang.hitch(_ac5,_ac6));}return _ac3.apply(_ab8,arguments);};};_ab6.around(_ab8,"connect",_ac2);if(_aba.connect){_ab6.around(_aba,"connect",_ac2);}var _ac7=_ab9("dijit._Widget",[_abe,_abf,_ac0],{onClick:_ac1,onDblClick:_ac1,onKeyDown:_ac1,onKeyPress:_ac1,onKeyUp:_ac1,onMouseDown:_ac1,onMouseMove:_ac1,onMouseOut:_ac1,onMouseOver:_ac1,onMouseLeave:_ac1,onMouseEnter:_ac1,onMouseUp:_ac1,constructor:function(_ac8){this._toConnect={};for(var name in _ac8){if(this[name]===_ac1){this._toConnect[name.replace(/^on/,"").toLowerCase()]=_ac8[name];delete _ac8[name];}}},postCreate:function(){this.inherited(arguments);for(var name in this._toConnect){this.on(name,this._toConnect[name]);}delete this._toConnect;},on:function(type,func){if(this[this._onMap(type)]===_ac1){return _ab8.connect(this.domNode,type.toLowerCase(),this,func);}return this.inherited(arguments);},_setFocusedAttr:function(val){this._focused=val;this._set("focused",val);},setAttribute:function(attr,_ac9){_aba.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(attr,_ac9);},attr:function(name,_aca){if(_ab7.isDebug){var _acb=arguments.callee._ach||(arguments.callee._ach={}),_acc=(arguments.callee.caller||"unknown caller").toString();if(!_acb[_acc]){_aba.deprecated(this.declaredClass+"::attr() is deprecated. Use get() or set() instead, called from "+_acc,"","2.0");_acb[_acc]=true;}}var args=arguments.length;if(args>=2||typeof name==="object"){return this.set.apply(this,arguments);}else{return this.get(name);}},getDescendants:function(){_aba.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?_abb("[widgetId]",this.containerNode).map(_abd.byNode):[];},_onShow:function(){this.onShow();},onShow:function(){},onHide:function(){},onClose:function(){return true;}});if(!_aba.isAsync){_abc(0,function(){var _acd=["dijit/_base"];require(_acd);});}return _ac7;});},"url:dijit/form/templates/Select.html":"<table class=\"dijit dijitReset dijitInline dijitLeft\"\n\tdata-dojo-attach-point=\"_buttonNode,tableNode,focusNode\" cellspacing='0' cellpadding='0'\n\trole=\"combobox\" aria-haspopup=\"true\"\n\t><tbody role=\"presentation\"><tr role=\"presentation\"\n\t\t><td class=\"dijitReset dijitStretch dijitButtonContents dijitButtonNode\" role=\"presentation\"\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"  data-dojo-attach-point=\"containerNode,_popupStateNode\"></span\n\t\t\t><input type=\"hidden\" ${!nameAttrSetting} data-dojo-attach-point=\"valueNode\" value=\"${value}\" aria-hidden=\"true\"\n\t\t/></td><td class=\"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\t\tdata-dojo-attach-point=\"titleNode\" role=\"presentation\"\n\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" role=\"presentation\">&#9660;</div\n\t\t></td\n\t></tr></tbody\n></table>\n","dojo/touch":function(){define("dojo/touch",["./_base/kernel","./on","./has","./mouse"],function(dojo,on,has,_ace){function _acf(type){return function(node,_ad0){return on(node,type,_ad0);};};var _ad1=has("touch");dojo.touch={press:_acf(_ad1?"touchstart":"mousedown"),move:_acf(_ad1?"touchmove":"mousemove"),release:_acf(_ad1?"touchend":"mouseup"),cancel:_ad1?_acf("touchcancel"):_ace.leave};return dojo.touch;});},"dijit/_DialogMixin":function(){define("dijit/_DialogMixin",["dojo/_base/declare","./a11y"],function(_ad2,a11y){return _ad2("dijit._DialogMixin",null,{execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"));},_getFocusItems:function(){var _ad3=a11y._getTabNavigable(this.containerNode);this._firstFocusItem=_ad3.lowest||_ad3.first||this.closeButtonNode||this.domNode;this._lastFocusItem=_ad3.last||_ad3.highest||this._firstFocusItem;}});});},"dijit/nls/common":function(){define({root:({buttonOk:"OK",buttonCancel:"Cancel",buttonSave:"Save",itemClose:"Close"}),"zh":true,"zh-tw":true,"tr":true,"th":true,"sv":true,"sl":true,"sk":true,"ru":true,"ro":true,"pt":true,"pt-pt":true,"pl":true,"nl":true,"nb":true,"ko":true,"kk":true,"ja":true,"it":true,"hu":true,"hr":true,"he":true,"fr":true,"fi":true,"es":true,"el":true,"de":true,"da":true,"cs":true,"ca":true,"az":true,"ar":true});},"dijit/form/_FormValueWidget":function(){define("dijit/form/_FormValueWidget",["dojo/_base/declare","dojo/_base/sniff","./_FormWidget","./_FormValueMixin"],function(_ad4,has,_ad5,_ad6){return _ad4("dijit.form._FormValueWidget",[_ad5,_ad6],{_layoutHackIE7:function(){if(has("ie")==7){var _ad7=this.domNode;var _ad8=_ad7.parentNode;var _ad9=_ad7.firstChild||_ad7;var _ada=_ad9.style.filter;var _adb=this;while(_ad8&&_ad8.clientHeight==0){(function ping(){var _adc=_adb.connect(_ad8,"onscroll",function(){_adb.disconnect(_adc);_ad9.style.filter=(new Date()).getMilliseconds();setTimeout(function(){_ad9.style.filter=_ada;},0);});})();_ad8=_ad8.parentNode;}}}});});}}});define("layers/map/mxmap",[],1);